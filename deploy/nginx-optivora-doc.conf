##
# Nginx config for Next.js static export (next.config.js: output: 'export')
#
# Deploy directory should contain `index.html` and folders like `_next/`, `documents/`, etc.
# Our GitHub Actions deploys the contents of `out/` into: /var/www/optivora-doc/
#
# Key point: SPA fallback for dynamic routes (e.g. /tasks/view/123/) so refresh works:
#   try_files $uri $uri/ /index.html;
##

server {
  listen 80;
  server_name _;

  root /var/www/optivora-doc;
  index index.html;

  # Optional: gzip static assets (usually enabled globally)
  gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;

  location / {
    # Serve file/folder if exists; otherwise serve index.html so Next router can handle the route.
    try_files $uri $uri/ /index.html;
  }
}
