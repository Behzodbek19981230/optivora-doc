"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1504],{82071:function(e,t,a){a.d(t,{x:function(){return r}});let r=e=>({noRowsLabel:String(e("common.datagrid.noRows",{defaultValue:"No rows"})),MuiTablePagination:{labelRowsPerPage:String(e("common.datagrid.rowsPerPage",{defaultValue:"Rows per page:"})),labelDisplayedRows:t=>{let{from:a,to:r,count:n}=t;return"".concat(a,"â€“").concat(r," ").concat(String(e("common.datagrid.of",{defaultValue:"of"}))," ").concat(-1!==n?n:">".concat(r))}}})},33251:function(e,t,a){a.d(t,{z:function(){return l}});var r=a(30202),n=a(33934),i=a(52293);let l=function(e){var t,a;let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=(0,r.NL)(),s=["list",e,l],d=Object.fromEntries(Object.entries(l).filter(e=>{let[,t]=e;return void 0!==t})),{data:c,isLoading:u,error:m}=(0,n.a)({queryKey:s,queryFn:async()=>{var t,a,r;let n=(await i.Do.get(e,d)).data,l=Array.isArray(n)?n:null!==(a=null==n?void 0:n.results)&&void 0!==a?a:[],o=Array.isArray(n)?l.length:null!==(r=null==n?void 0:null===(t=n.pagination)||void 0===t?void 0:t.total)&&void 0!==r?r:l.length;return{items:l,total:o}},staleTime:3e4});return{data:null!==(t=null==c?void 0:c.items)&&void 0!==t?t:[],total:null!==(a=null==c?void 0:c.total)&&void 0!==a?a:0,loading:u,error:m,mutate:()=>{o.invalidateQueries({queryKey:s})}}}},31504:function(e,t,a){var r=a(85893),n=a(67294),i=a(81873),l=a(84166),o=a(21038),s=a(52857),d=a(60762),c=a(71919),u=a(51015),m=a(33453),h=a(92365),g=a(40110),x=a(96788),p=a(68573),v=a(81359),b=a(90642),f=a(96727),y=a(28634),Z=a(11163),j=a(75673),S=a(33251),w=a(74538),k=a(41664),C=a.n(k),_=a(22120),N=a(52293),P=a(58898),z=a(34273),M=a(82071),R=a(30381),D=a.n(R);let H=e=>{switch(e){case"new":return"info";case"in_progress":return"primary";case"on_review":case"returned":return"warning";case"done":return"success";case"cancelled":return"error";case"archive":return"secondary";default:return"default"}};t.Z=e=>{var t;let{status:a}=e,k=(0,Z.useRouter)(),{t:R}=(0,_.$G)(),[W,Y]=(0,n.useState)({page:0,pageSize:10}),E=(0,P.Z)(),{user:V}=(0,z.a)(),[A,O]=(0,n.useState)(!1),[I,L]=(0,n.useState)("task"),[T,F]=(0,n.useState)(!1),{data:q=[],total:G,loading:Q}=(0,S.z)(w.Z.task,{page:W.page+1,limit:W.pageSize,status:a}),$=async e=>{if(confirm(String(R("documents.table.archiveConfirm"))))try{await N.Do.delete("".concat(w.Z.task,"/").concat(e)),E.success(String(R("documents.table.archiveSuccess"))),k.replace(k.asPath)}catch(e){E.error((null==e?void 0:e.message)||String(R("documents.table.archiveError")))}},B=[{field:"id",headerName:String(R("common.id")),width:90},{field:"name",headerName:String(R("documents.table.name")),flex:.3,minWidth:180},{field:"status",headerName:String(R("documents.table.status")),flex:.2,minWidth:140,renderCell:e=>{let t=e.row.status;return(0,r.jsx)(i.Z,{label:R("documents.status.".concat(t)),color:H(t),size:"small",variant:"outlined"})}},{field:"type",headerName:String(R("documents.table.type")),flex:.15,minWidth:120,renderCell:e=>{let t=e.row.type;return R("tasks.type.".concat(t))}},{field:"priority",headerName:String(R("documents.table.priority")),flex:.15,minWidth:120,renderCell:e=>{let t=e.row.priority;return t?(0,r.jsx)(i.Z,{label:R("tasks.priority.".concat(t)),color:"ordinary"===t?"primary":"warning",size:"small"}):""}},{field:"start_date",headerName:String(R("documents.table.start")),flex:.15,minWidth:130,renderCell:e=>{let t=e.row.start_date;return D()(t).isValid()?D()(t).format("DD.MM.YYYY HH:mm"):""}},{field:"end_date",headerName:String(R("documents.table.end")),flex:.15,minWidth:130,renderCell:e=>{let t=e.row.end_date;return D()(t).isValid()?D()(t).format("DD.MM.YYYY HH:mm"):""}},{field:"actions",headerName:String(R("common.actions")),width:120,sortable:!1,renderCell:e=>{var t,n;let i=e.row.id;return(0,r.jsxs)(l.Z,{direction:"row",spacing:1,children:[(0,r.jsx)(o.Z,{title:String(R("common.view")),children:(0,r.jsx)(s.Z,{size:"small",component:C(),href:"/tasks/view/".concat(i),children:(0,r.jsx)(j.Z,{icon:"tabler:eye"})})}),["new"].includes(a)&&(null==V?void 0:null===(t=V.role_detail)||void 0===t?void 0:t.some(e=>"Manager"===e.name))&&(0,r.jsx)(o.Z,{title:String(R("common.edit")),children:(0,r.jsx)(s.Z,{size:"small",component:C(),href:"/tasks/update/".concat(i),children:(0,r.jsx)(j.Z,{icon:"tabler:pencil"})})}),(null==V?void 0:null===(n=V.role_detail)||void 0===n?void 0:n.some(e=>"Manager"===e.name))&&(0,r.jsx)(o.Z,{title:String(R("documents.table.archive")),children:(0,r.jsx)(s.Z,{size:"small",onClick:()=>$(i),children:(0,r.jsx)(j.Z,{icon:"tabler:archive"})})})]})}}];return(0,r.jsx)(d.Z,{variant:"outlined",children:(0,r.jsxs)(c.Z,{sx:{pb:0},children:["archive"!==a&&(0,r.jsx)(l.Z,{direction:"row",justifyContent:"flex-end",sx:{mb:2},children:(null==V?void 0:null===(t=V.role_detail)||void 0===t?void 0:t.some(e=>"Performer"!==e.name))&&(0,r.jsx)(u.Z,{variant:"contained",onClick:()=>O(!0),children:String(R("tasks.create.title"))})}),(0,r.jsxs)(m.Z,{open:A,onClose:T?void 0:()=>O(!1),fullWidth:!0,maxWidth:"sm",children:[(0,r.jsx)(h.Z,{children:String(R("tasks.create.modal.title"))}),(0,r.jsxs)(g.Z,{children:[(0,r.jsx)(x.Z,{variant:"body2",sx:{color:"text.secondary",mb:4},children:String(R("tasks.create.modal.subtitle"))}),(0,r.jsxs)(p.ZP,{container:!0,spacing:3,children:[(0,r.jsx)(p.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(d.Z,{variant:"outlined",sx:{borderColor:"task"===I?"primary.main":"divider",bgcolor:"task"===I?"primary.lighter":"background.paper"},children:(0,r.jsx)(v.Z,{onClick:()=>L("task"),children:(0,r.jsxs)(c.Z,{sx:{height:100},children:[(0,r.jsxs)(b.Z,{sx:{display:"flex",alignItems:"center",gap:2,mb:1},children:[(0,r.jsx)(j.Z,{icon:"tabler:clipboard-list"}),(0,r.jsx)(x.Z,{variant:"h6",children:String(R("tasks.type.task"))})]}),(0,r.jsx)(x.Z,{variant:"body2",sx:{color:"text.secondary"},children:String(R("tasks.create.modal.taskHint"))})]})})})}),(0,r.jsx)(p.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(d.Z,{variant:"outlined",sx:{borderColor:"application"===I?"primary.main":"divider",bgcolor:"application"===I?"primary.lighter":"background.paper"},children:(0,r.jsx)(v.Z,{onClick:()=>L("application"),children:(0,r.jsxs)(c.Z,{sx:{height:100},children:[(0,r.jsxs)(b.Z,{sx:{display:"flex",alignItems:"center",gap:2,mb:1},children:[(0,r.jsx)(j.Z,{icon:"tabler:file-text"}),(0,r.jsx)(x.Z,{variant:"h6",children:String(R("tasks.type.application"))})]}),(0,r.jsx)(x.Z,{variant:"body2",sx:{color:"text.secondary"},children:String(R("tasks.create.modal.applicationHint"))})]})})})})]})]}),(0,r.jsxs)(f.Z,{children:[(0,r.jsx)(u.Z,{variant:"tonal",color:"secondary",onClick:()=>O(!1),disabled:T,children:String(R("common.cancel"))}),(0,r.jsx)(u.Z,{variant:"contained",onClick:async()=>{try{var e;F(!0);let t=await N.Do.post(w.Z.task,{type:I,status:"new",company:null==V?void 0:V.company_id}),a=null===(e=t.data)||void 0===e?void 0:e.id;E.success(String(R("tasks.toast.created"))),O(!1),a&&k.push("/tasks/update/".concat(a))}catch(e){E.error((null==e?void 0:e.message)||String(R("tasks.toast.createError")))}finally{F(!1)}},disabled:T,children:T?String(R("common.creating")):String(R("common.create"))})]})]}),(0,r.jsx)(y._,{autoHeight:!0,rowHeight:56,rows:q,columns:B,loading:Q,rowCount:G,paginationMode:"server",disableRowSelectionOnClick:!0,pageSizeOptions:[10,25,50],paginationModel:W,onPaginationModelChange:Y,getRowId:e=>e.id,localeText:{...(0,M.x)(R),noRowsLabel:String(R("documents.table.emptyForStatus",{status:a}))}})]})})}}}]);