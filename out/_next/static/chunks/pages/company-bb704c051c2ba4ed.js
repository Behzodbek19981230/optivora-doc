(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7639],{49144:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/company",function(){return r(80325)}])},34375:function(e,n,r){"use strict";r.d(n,{Z:function(){return S}});var t=r(63366),i=r(87462),o=r(67294),a=r(86010),l=r(94780),d=r(96788),s=r(29567),c=r(77527),m=r(1588),u=r(34867);function h(e){return(0,u.Z)("MuiCardHeader",e)}let x=(0,m.Z)("MuiCardHeader",["root","avatar","action","content","title","subheader"]);var p=r(85893);let g=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],v=e=>{let{classes:n}=e;return(0,l.Z)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},h,n)},y=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,n)=>(0,i.Z)({["& .".concat(x.title)]:n.title,["& .".concat(x.subheader)]:n.subheader},n.root)})({display:"flex",alignItems:"center",padding:16}),Z=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,n)=>n.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),j=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,n)=>n.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),f=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,n)=>n.content})({flex:"1 1 auto"});var S=o.forwardRef(function(e,n){let r=(0,s.Z)({props:e,name:"MuiCardHeader"}),{action:o,avatar:l,className:c,component:m="div",disableTypography:u=!1,subheader:h,subheaderTypographyProps:x,title:S,titleTypographyProps:b}=r,w=(0,t.Z)(r,g),C=(0,i.Z)({},r,{component:m,disableTypography:u}),P=v(C),_=S;null==_||_.type===d.Z||u||(_=(0,p.jsx)(d.Z,(0,i.Z)({variant:l?"body2":"h5",className:P.title,component:"span",display:"block"},b,{children:_})));let N=h;return null==N||N.type===d.Z||u||(N=(0,p.jsx)(d.Z,(0,i.Z)({variant:l?"body2":"body1",className:P.subheader,color:"text.secondary",component:"span",display:"block"},x,{children:N}))),(0,p.jsxs)(y,(0,i.Z)({className:(0,a.Z)(P.root,c),as:m,ref:n,ownerState:C},w,{children:[l&&(0,p.jsx)(Z,{className:P.avatar,ownerState:C,children:l}),(0,p.jsxs)(f,{className:P.content,ownerState:C,children:[_,N]}),o&&(0,p.jsx)(j,{className:P.action,ownerState:C,children:o})]}))})},82071:function(e,n,r){"use strict";r.d(n,{x:function(){return t}});let t=e=>({noRowsLabel:String(e("common.datagrid.noRows",{defaultValue:"No rows"})),MuiTablePagination:{labelRowsPerPage:String(e("common.datagrid.rowsPerPage",{defaultValue:"Rows per page:"})),labelDisplayedRows:n=>{let{from:r,to:t,count:i}=n;return"".concat(r,"â€“").concat(t," ").concat(String(e("common.datagrid.of",{defaultValue:"of"}))," ").concat(-1!==i?i:">".concat(t))}}})},33251:function(e,n,r){"use strict";r.d(n,{z:function(){return a}});var t=r(30202),i=r(33934),o=r(52293);let a=function(e){var n,r;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=!(arguments.length>2)||void 0===arguments[2]||arguments[2],d=(0,t.NL)(),s=["list",e,a],c=Object.fromEntries(Object.entries(a).filter(e=>{let[,n]=e;return void 0!==n})),{data:m,isLoading:u,error:h}=(0,i.a)({queryKey:s,queryFn:async()=>{var n,r,t;let i=(await o.Do.get(e,c)).data,a=Array.isArray(i)?i:null!==(r=null==i?void 0:i.results)&&void 0!==r?r:[],l=Array.isArray(i)?a.length:null!==(t=null==i?void 0:null===(n=i.pagination)||void 0===n?void 0:n.total)&&void 0!==t?t:a.length;return{items:a,total:l}},enabled:l,staleTime:3e4});return{data:null!==(n=null==m?void 0:m.items)&&void 0!==n?n:[],total:null!==(r=null==m?void 0:m.total)&&void 0!==r?r:0,loading:u,error:h,mutate:()=>{d.invalidateQueries({queryKey:s})}}}},80325:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return F}});var t=r(85893),i=r(67294),o=r(11163),a=r(33251),l=r(52293),d=r(74538),s=r(52857),c=r(60762),m=r(34375),u=r(73907),h=r(33453),x=r(92365),p=r(40110),g=r(96788),v=r(96727),y=r(16127),Z=r(75673),j=r(87536),f=r(68573),S=r(13539),b=r(65806),w=r(90642),C=r(7879),P=r(46070),_=r(86501),N=r(22120),R=r(90142),W=r(34273),k=e=>{let{open:n,onClose:r,onSaved:o,mode:s,item:c}=e,{t:m}=(0,N.$G)(),{user:y}=(0,W.a)(),k={code:"",name:"",is_active:!0,phone:"",country:0,region:0,district:0,address:"",created_by:(null==y?void 0:y.id)||0,logo:void 0},{control:T,handleSubmit:q,reset:D,watch:O,formState:{isSubmitting:E,errors:I}}=(0,j.cI)({defaultValues:k}),[z,F]=(0,i.useState)(null),[M,H]=(0,i.useState)(null),Q=(0,i.useRef)(null),{data:L=[]}=(0,a.z)(d.Z.country,{limit:100}),{data:A=[]}=(0,a.z)(d.Z.region,{limit:100}),G=O("region"),V=G?"".concat(d.Z.district,"?region=").concat(G):d.Z.district,{data:B=[]}=(0,a.z)(V,{limit:200});(0,i.useEffect)(()=>{"edit"===s&&c?(D(c),H(c.logo||null)):(D(k),H(null)),F(null)},[s,c,D]),(0,i.useEffect)(()=>{if(z){let e=URL.createObjectURL(z);return H(e),()=>URL.revokeObjectURL(e)}},[z]);let U=async e=>{try{if("create"===s){if(z){let n=new FormData;n.append("logo",z),n.append("code",e.code),n.append("name",e.name),n.append("phone",e.phone),n.append("country",e.country.toString()),n.append("region",e.region.toString()),n.append("district",e.district.toString()),n.append("address",e.address),await l.Do.postForm(d.Z.company,n)}else await l.Do.post(d.Z.company,e)}else if("edit"===s&&(null==c?void 0:c.id)){if(z){let n=new FormData;n.append("logo",z),n.append("code",e.code),n.append("name",e.name),n.append("phone",e.phone),n.append("country",e.country.toString()),n.append("region",e.region.toString()),n.append("district",e.district.toString()),n.append("address",e.address),n.append("is_active",e.is_active.toString()),await l.Do.putForm(d.Z.companyById(c.id),n)}else delete e.logo,await l.Do.put(d.Z.companyById(c.id),e);window.location.reload()}_.ZP.success(String(m("company.toast.saved"))),o(),r()}catch(e){console.error("Failed to save company:",e),_.ZP.error(String(m("company.toast.saveError")))}};return(0,t.jsxs)(h.Z,{open:n,onClose:E?void 0:r,fullWidth:!0,maxWidth:"md",children:[(0,t.jsx)(x.Z,{children:"create"===s?String(m("company.create.title")):String(m("company.edit.title"))}),(0,t.jsxs)("form",{onSubmit:q(U),children:[(0,t.jsx)(p.Z,{children:(0,t.jsxs)(f.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(f.ZP,{item:!0,xs:12,children:(0,t.jsxs)(w.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,t.jsx)(g.Z,{variant:"body2",sx:{mb:1},children:String(m("company.table.logo"))}),(0,t.jsx)(R.Z,{src:M||void 0,variant:"circular",sx:{width:100,height:100,cursor:"pointer",borderColor:"primary.main","& img":{width:"100%",height:"100%",objectFit:"contain"}},onClick:()=>{var e;return null===(e=Q.current)||void 0===e?void 0:e.click()},children:!M&&(0,t.jsx)(Z.Z,{icon:"tabler:camera-plus"})}),(0,t.jsx)("input",{type:"file",ref:Q,style:{display:"none"},accept:"image/*",onChange:e=>{var n;return F((null===(n=e.target.files)||void 0===n?void 0:n[0])||null)}})]})}),(0,t.jsx)(f.ZP,{item:!0,xs:12,md:6,children:(0,t.jsx)(j.Qr,{name:"code",control:T,rules:{required:String(m("errors.required"))},render:e=>{var n;let{field:r}=e;return(0,t.jsx)(C.Z,{fullWidth:!0,label:String(m("company.form.code")),...r,error:!!I.code,helperText:null===(n=I.code)||void 0===n?void 0:n.message})}})}),(0,t.jsx)(f.ZP,{item:!0,xs:12,md:6,children:(0,t.jsx)(j.Qr,{name:"name",control:T,rules:{required:String(m("errors.required"))},render:e=>{var n;let{field:r}=e;return(0,t.jsx)(C.Z,{fullWidth:!0,label:String(m("company.form.name")),...r,error:!!I.name,helperText:null===(n=I.name)||void 0===n?void 0:n.message})}})}),(0,t.jsx)(f.ZP,{item:!0,xs:12,md:6,children:(0,t.jsx)(j.Qr,{name:"phone",control:T,render:e=>{let{field:n}=e;return(0,t.jsx)(C.Z,{fullWidth:!0,label:String(m("company.form.phone")),...n})}})}),(0,t.jsx)(f.ZP,{item:!0,xs:12,md:6,children:(0,t.jsx)(j.Qr,{name:"address",control:T,render:e=>{let{field:n}=e;return(0,t.jsx)(C.Z,{fullWidth:!0,label:String(m("company.form.address")),...n})}})}),(0,t.jsx)(f.ZP,{item:!0,xs:12,md:6,children:(0,t.jsx)(j.Qr,{name:"country",control:T,rules:{required:String(m("errors.required"))},render:e=>{let{field:n,fieldState:r}=e;return(0,t.jsx)(P.Z,{options:L,value:L.find(e=>e.id===n.value)||null,onChange:(e,r)=>{var t;return n.onChange(null!==(t=null==r?void 0:r.id)&&void 0!==t?t:0)},isOptionEqualToValue:(e,n)=>e.id===n.id,getOptionLabel:e=>(null==e?void 0:e.name)||"",renderInput:e=>{var n;return(0,t.jsx)(C.Z,{...e,fullWidth:!0,label:String(m("company.form.country")),error:!!r.error,helperText:null===(n=r.error)||void 0===n?void 0:n.message})}})}})}),(0,t.jsx)(f.ZP,{item:!0,xs:12,md:6,children:(0,t.jsx)(j.Qr,{name:"region",control:T,rules:{required:String(m("errors.required"))},render:e=>{let{field:n,fieldState:r}=e;return(0,t.jsx)(P.Z,{options:A,value:A.find(e=>e.id===n.value)||null,onChange:(e,r)=>{var t;return n.onChange(null!==(t=null==r?void 0:r.id)&&void 0!==t?t:0)},isOptionEqualToValue:(e,n)=>e.id===n.id,getOptionLabel:e=>(null==e?void 0:e.name)||"",renderInput:e=>{var n;return(0,t.jsx)(C.Z,{...e,fullWidth:!0,label:String(m("company.form.region")),error:!!r.error,helperText:null===(n=r.error)||void 0===n?void 0:n.message})}})}})}),(0,t.jsx)(f.ZP,{item:!0,xs:12,md:6,children:(0,t.jsx)(j.Qr,{name:"district",control:T,rules:{required:String(m("errors.required"))},render:e=>{let{field:n,fieldState:r}=e;return(0,t.jsx)(P.Z,{options:B,value:B.find(e=>e.id===n.value)||null,onChange:(e,r)=>{var t;return n.onChange(null!==(t=null==r?void 0:r.id)&&void 0!==t?t:0)},isOptionEqualToValue:(e,n)=>e.id===n.id,getOptionLabel:e=>(null==e?void 0:e.name)||"",renderInput:e=>{var n;return(0,t.jsx)(C.Z,{...e,fullWidth:!0,label:String(m("company.form.district")),error:!!r.error,helperText:null===(n=r.error)||void 0===n?void 0:n.message})}})}})}),(0,t.jsx)(f.ZP,{item:!0,xs:6,children:(0,t.jsx)(j.Qr,{name:"is_active",control:T,render:e=>{let{field:n}=e;return(0,t.jsx)(b.Z,{control:(0,t.jsx)(S.Z,{checked:!!n.value,onChange:(e,r)=>n.onChange(r)}),label:String(m("company.form.active"))})}})})]})}),(0,t.jsxs)(v.Z,{children:[(0,t.jsx)(u.Z,{type:"button",variant:"tonal",color:"secondary",onClick:r,disabled:E,children:String(m("common.cancel"))}),(0,t.jsx)(u.Z,{type:"submit",disabled:E,children:E?String(m("common.saving")):String(m("common.save"))})]})]})]})},T=r(97182),q=r(30381),D=r.n(q),O=e=>{var n,r,o;let{open:a,onClose:s,id:c}=e,{t:m}=(0,N.$G)(),[y,Z]=(0,i.useState)(null),[j,S]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{(async()=>{if(c&&a){S(!0);try{let e=await l.Do.get(d.Z.companyById(c));Z(e.data)}finally{S(!1)}}})()},[c,a]),(0,t.jsxs)(h.Z,{open:a,onClose:s,maxWidth:"md",fullWidth:!0,children:[(0,t.jsx)(x.Z,{children:String(m("company.view.title"))}),(0,t.jsx)(p.Z,{children:j?(0,t.jsx)(w.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",py:8},children:(0,t.jsx)(T.Z,{})}):y?(0,t.jsxs)(f.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(f.ZP,{item:!0,xs:12,md:4,children:(0,t.jsxs)(w.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,t.jsx)(R.Z,{src:"".concat("https://api-doc.optivora-group.com").concat(y.logo),variant:"rounded",sx:{width:200,height:200,"& img":{width:"100%",height:"100%",objectFit:"contain"}}}),(0,t.jsx)(g.Z,{variant:"h6",sx:{mt:2},children:y.name})]})}),(0,t.jsx)(f.ZP,{item:!0,xs:12,md:8,children:(0,t.jsxs)(f.ZP,{container:!0,spacing:2,children:[(0,t.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,t.jsx)(g.Z,{variant:"body2",color:"text.secondary",children:String(m("company.form.code"))}),(0,t.jsx)(g.Z,{variant:"body1",children:y.code})]}),(0,t.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,t.jsx)(g.Z,{variant:"body2",color:"text.secondary",children:String(m("company.form.name"))}),(0,t.jsx)(g.Z,{variant:"body1",children:y.name})]}),(0,t.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,t.jsx)(g.Z,{variant:"body2",color:"text.secondary",children:String(m("company.form.active"))}),(0,t.jsx)(g.Z,{variant:"body1",children:y.is_active?String(m("common.yes")):String(m("common.no"))})]}),(0,t.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,t.jsx)(g.Z,{variant:"body2",color:"text.secondary",children:String(m("company.form.phone"))}),(0,t.jsx)(g.Z,{variant:"body1",children:y.phone})]}),(0,t.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,t.jsx)(g.Z,{variant:"body2",color:"text.secondary",children:String(m("company.form.country"))}),(0,t.jsx)(g.Z,{variant:"body1",children:null===(n=y.country_detail)||void 0===n?void 0:n.name})]}),(0,t.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,t.jsx)(g.Z,{variant:"body2",color:"text.secondary",children:String(m("company.form.region"))}),(0,t.jsx)(g.Z,{variant:"body1",children:null===(r=y.region_detail)||void 0===r?void 0:r.name_uz})]}),(0,t.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,t.jsx)(g.Z,{variant:"body2",color:"text.secondary",children:String(m("company.form.district"))}),(0,t.jsx)(g.Z,{variant:"body1",children:null===(o=y.district_detail)||void 0===o?void 0:o.name_uz})]}),(0,t.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,t.jsx)(g.Z,{variant:"body2",color:"text.secondary",children:String(m("company.form.address"))}),(0,t.jsx)(g.Z,{variant:"body1",children:y.address})]}),(0,t.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,t.jsx)(g.Z,{variant:"body2",color:"text.secondary",children:String(m("common.createdAt"))}),(0,t.jsx)(g.Z,{variant:"body1",children:D()(y.created_time).format("DD.MM.YYYY HH:mm")})]})]})})]}):(0,t.jsx)(g.Z,{color:"text.secondary",children:String(m("common.notFound"))})}),(0,t.jsx)(v.Z,{children:(0,t.jsx)(u.Z,{onClick:s,children:String(m("common.close"))})})]})},E=r(55421),I=r(82071),z=()=>{(0,o.useRouter)();let{t:e}=(0,N.$G)(),[n,r]=(0,i.useState)({page:0,pageSize:10}),{data:j=[],loading:f,mutate:S,total:b}=(0,a.z)(d.Z.company,{limit:n.pageSize,page:n.page+1}),[w,C]=(0,i.useState)(!1),[P,_]=(0,i.useState)(null),[W,T]=(0,i.useState)(!1),[q,D]=(0,i.useState)(null),[z,F]=(0,i.useState)(!1),[M,H]=(0,i.useState)(null),Q=e=>{_(e),C(!0)},L=e=>{H(e),F(!0)},A=async()=>{M&&(await l.Do.delete(d.Z.companyById(M.id)),S(),F(!1),H(null))},G=[{field:"code",headerName:String(e("company.table.code")),flex:.15,minWidth:120},{field:"name",headerName:String(e("company.table.name")),flex:.25,minWidth:180},{field:"is_active",headerName:String(e("company.table.active")),flex:.1,minWidth:100,valueGetter:n=>n.row.is_active?String(e("common.yes")):String(e("common.no"))},{field:"phone",headerName:String(e("company.table.phone")),flex:.2,minWidth:160},{field:"country",headerName:String(e("company.form.country")),flex:.12,minWidth:120,valueGetter:e=>{var n;return(null===(n=e.row.country_detail)||void 0===n?void 0:n.name)||e.row.country}},{field:"region",headerName:String(e("company.table.region")),flex:.12,minWidth:120,valueGetter:e=>{var n;return(null===(n=e.row.region_detail)||void 0===n?void 0:n.name_uz)||e.row.region}},{field:"district",headerName:String(e("company.table.district")),flex:.12,minWidth:120,valueGetter:e=>{var n;return(null===(n=e.row.district_detail)||void 0===n?void 0:n.name_uz)||e.row.district}},{field:"address",headerName:String(e("company.table.address")),flex:.3,minWidth:220},{field:"logo",headerName:String(e("company.table.logo")),flex:.15,minWidth:140,renderCell:e=>{let n=e.row;return(0,t.jsx)(R.Z,{src:n.logo,variant:"circular",sx:{width:38,height:38,borderRadius:"50%","& img":{width:"100%",height:"100%",objectFit:"cover"}},children:(0,E.Q)(n.name)})}},{field:"actions",headerName:String(e("common.actions")),sortable:!1,flex:.15,minWidth:140,renderCell:e=>{let n=e.row;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Z,{"aria-label":"view",onClick:()=>{D(n.id),T(!0)},children:(0,t.jsx)(Z.Z,{icon:"tabler:eye"})}),(0,t.jsx)(s.Z,{"aria-label":"edit",onClick:()=>Q(n),children:(0,t.jsx)(Z.Z,{icon:"tabler:edit"})}),(0,t.jsx)(s.Z,{"aria-label":"delete",color:"error",onClick:()=>L(n),children:(0,t.jsx)(Z.Z,{icon:"tabler:trash"})})]})}}];return(0,t.jsxs)(c.Z,{children:[(0,t.jsx)(m.Z,{title:String(e("company.title")),action:(0,t.jsx)(u.Z,{variant:"contained",onClick:()=>{_(null),C(!0)},children:String(e("common.create"))})}),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(y._,{autoHeight:!0,rowHeight:56,rows:j,columns:G,loading:f,disableRowSelectionOnClick:!0,pageSizeOptions:[10,25,50],paginationModel:n,onPaginationModelChange:r,getRowId:e=>e.id,localeText:(0,I.x)(e),rowCount:b})}),w&&(0,t.jsx)(k,{open:w,onClose:()=>C(!1),onSaved:S,mode:P?"edit":"create",item:P||void 0}),W&&(0,t.jsx)(O,{open:W,onClose:()=>T(!1),id:q}),(0,t.jsxs)(h.Z,{open:z,onClose:()=>F(!1),children:[(0,t.jsx)(x.Z,{children:String(e("common.deleteConfirm.title"))}),(0,t.jsx)(p.Z,{children:(0,t.jsxs)(g.Z,{children:[String(e("common.deleteConfirm.description")),' "',null==M?void 0:M.name,'"?']})}),(0,t.jsxs)(v.Z,{children:[(0,t.jsx)(u.Z,{onClick:()=>F(!1),children:String(e("common.cancel"))}),(0,t.jsx)(u.Z,{onClick:A,color:"error",variant:"contained",children:String(e("common.delete"))})]})]})]})},F=()=>(0,t.jsx)(z,{})}},function(e){e.O(0,[4885,2785,6127,7536,2888,9774,179],function(){return e(e.s=49144)}),_N_E=e.O()}]);