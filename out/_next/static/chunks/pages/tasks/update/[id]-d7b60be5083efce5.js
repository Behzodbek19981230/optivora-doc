(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7478],{31865:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tasks/update/[id]",function(){return t(15493)}])},84166:function(e,r,t){"use strict";t.d(r,{Z:function(){return b}});var n=t(63366),a=t(87462),s=t(67294),i=t(86010),l=t(59766),o=t(94780),d=t(34867),u=t(13264),c=t(29628),m=t(39707),g=t(66500),p=t(95408),h=t(98700),x=t(85893);let Z=["component","direction","spacing","divider","children","className","useFlexGap"],v=(0,g.Z)(),f=(0,u.Z)("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,r)=>r.root});function j(e){return(0,c.Z)({props:e,name:"MuiStack",defaultTheme:v})}let S=e=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[e],y=({ownerState:e,theme:r})=>{let t=(0,a.Z)({display:"flex",flexDirection:"column"},(0,p.k9)({theme:r},(0,p.P$)({values:e.direction,breakpoints:r.breakpoints.values}),e=>({flexDirection:e})));if(e.spacing){let n=(0,h.hB)(r),a=Object.keys(r.breakpoints.values).reduce((r,t)=>(("object"==typeof e.spacing&&null!=e.spacing[t]||"object"==typeof e.direction&&null!=e.direction[t])&&(r[t]=!0),r),{}),s=(0,p.P$)({values:e.direction,base:a}),i=(0,p.P$)({values:e.spacing,base:a});"object"==typeof s&&Object.keys(s).forEach((e,r,t)=>{if(!s[e]){let n=r>0?s[t[r-1]]:"column";s[e]=n}}),t=(0,l.Z)(t,(0,p.k9)({theme:r},i,(r,t)=>e.useFlexGap?{gap:(0,h.NA)(n,r)}:{"& > :not(style) + :not(style)":{margin:0,[`margin${S(t?s[t]:e.direction)}`]:(0,h.NA)(n,r)}}))}return(0,p.dt)(r.breakpoints,t)};var _=t(77527),k=t(29567),b=function(e={}){let{createStyledComponent:r=f,useThemeProps:t=j,componentName:l="MuiStack"}=e,u=()=>(0,o.Z)({root:["root"]},e=>(0,d.Z)(l,e),{}),c=r(y);return s.forwardRef(function(e,r){let l=t(e),o=(0,m.Z)(l),{component:d="div",direction:g="column",spacing:p=0,divider:h,children:v,className:f,useFlexGap:j=!1}=o,S=(0,n.Z)(o,Z),y=u();return(0,x.jsx)(c,(0,a.Z)({as:d,ownerState:{direction:g,spacing:p,useFlexGap:j},ref:r,className:(0,i.Z)(y.root,f)},S,{children:h?function(e,r){let t=s.Children.toArray(e).filter(Boolean);return t.reduce((e,n,a)=>(e.push(n),a<t.length-1&&e.push(s.cloneElement(r,{key:`separator-${a}`})),e),[])}(v,h):v}))})}({createStyledComponent:(0,_.ZP)("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,r)=>r.root}),useThemeProps:e=>(0,k.Z)({props:e,name:"MuiStack"})})},25026:function(e,r,t){"use strict";t.d(r,{Z:function(){return Z}});var n=t(87462),a=t(63366),s=t(67294),i=t(86010),l=t(94780),o=t(29567),d=t(77527),u=t(1588),c=t(34867);function m(e){return(0,c.Z)("MuiTableContainer",e)}(0,u.Z)("MuiTableContainer",["root"]);var g=t(85893);let p=["className","component"],h=e=>{let{classes:r}=e;return(0,l.Z)({root:["root"]},m,r)},x=(0,d.ZP)("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(e,r)=>r.root})({width:"100%",overflowX:"auto"});var Z=s.forwardRef(function(e,r){let t=(0,o.Z)({props:e,name:"MuiTableContainer"}),{className:s,component:l="div"}=t,d=(0,a.Z)(t,p),u=(0,n.Z)({},t,{component:l}),c=h(u);return(0,g.jsx)(x,(0,n.Z)({ref:r,as:l,className:(0,i.Z)(c.root,s),ownerState:u},d))})},58898:function(e,r,t){"use strict";var n=t(18745),a=t(86501);r.Z=()=>{let e=(0,n.Z)();return{success:(r,t)=>a.ZP.success(r,{style:{paddingInline:"10px",paddingBlock:"6px",color:e.palette.success.main,border:"1px solid ".concat(e.palette.success.main)},iconTheme:{primary:e.palette.success.main,secondary:e.palette.success.contrastText},...t}),error:(r,t)=>a.ZP.error(r,{style:{paddingInline:"10px",paddingBlock:"6px",color:e.palette.error.main,border:"1px solid ".concat(e.palette.error.main)},iconTheme:{primary:e.palette.error.main,secondary:e.palette.getContrastText(e.palette.error.main)},...t}),info:(r,t)=>(0,a.ZP)(r,{style:{padding:"16px",color:e.palette.info.main,border:"1px solid ".concat(e.palette.info.main)},iconTheme:{primary:e.palette.info.main,secondary:e.palette.getContrastText(e.palette.info.main)},...t})}}},15493:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return X}});var n=t(85893),a=t(67294),s=t(84166),i=t(68573),l=t(60762),o=t(71919),d=t(14823),u=t(6897),c=t(85533),m=t(15903),g=t(65806),p=t(12467),h=t(96788),x=t(51015),Z=t(81873),v=t(25026),f=t(93454),j=t(76592),S=t(70360),y=t(46577),_=t(8863),k=t(19827),b=t(52857),P=t(33453),q=t(92365),w=t(40110),C=t(96727),T=t(87536),D=t(47533),W=t(16310),I=t(7879),O=t(74538),E=t(52293),A=t(58898),z=t(11163);t(5843);var M=t(81342),N=t(33251),R=t(9198),F=t.n(R),Q=t(34273),L=t(75673),B=t(22120);let V={status:"new",type:"task",name:"",task_form:0,sending_org:0,input_doc_number:"",output_doc_number:"",start_date:"",end_date:"",priority:"ordinary",department:0,signed_by:0,note:"",list_of_magazine:0},$=e=>W.Ry({type:W.Z_().oneOf(["task","application"]).required(String(e("errors.required"))),name:W.Z_().min(2,String(e("errors.minChars",{count:2}))).required(String(e("errors.required"))),task_form:W.Rx().typeError(String(e("errors.select"))).moreThan(0,String(e("errors.select"))).required(String(e("errors.required"))),sending_org:W.Rx().typeError(String(e("errors.select"))).moreThan(0,String(e("errors.select"))).required(String(e("errors.required"))),input_doc_number:W.Z_().required(String(e("errors.required"))),output_doc_number:W.Z_().required(String(e("errors.required"))),start_date:W.Z_().required(String(e("errors.required"))),end_date:W.Z_().optional().default("").test("end-after-start",String(e("errors.endAfterStart")),function(e){let{start_date:r}=this.parent;return!r||!e||new Date(e)>=new Date(r)}),priority:W.Z_().oneOf(["ordinary","orgently"]).required(String(e("errors.required"))),department:W.Rx().typeError(String(e("errors.select"))).moreThan(0,String(e("errors.select"))).required(String(e("errors.required"))),note:W.Z_().required(String(e("errors.required"))),list_of_magazine:W.Rx().typeError(String(e("errors.select"))).moreThan(0,String(e("errors.select"))).required(String(e("errors.required"))),signed_by:W.Rx().typeError(String(e("errors.select"))).moreThan(0,String(e("errors.select"))).required(String(e("errors.required")))});var G=()=>{let{t:e}=(0,B.$G)(),r=$(e),{control:t,handleSubmit:W,reset:R}=(0,T.cI)({defaultValues:V,resolver:(0,D.X)(r)}),G=(0,A.Z)(),X=(0,z.useRouter)(),{id:H}=X.query,{user:J}=(0,Q.a)(),[K,U]=(0,a.useState)("simple"),[Y,ee]=(0,a.useState)(0),[er,et]=(0,a.useState)([]),[en,ea]=(0,a.useState)(!1),[es,ei]=(0,a.useState)({title:"",department:0,assignee:0,start_date:"",end_date:"",note:""}),[el,eo]=(0,a.useState)({}),[ed,eu]=(0,a.useState)(null),{data:ec}=(0,N.z)(O.Z.department,{page:1,perPage:100}),{data:em}=(0,N.z)(O.Z.users,{page:1,perPage:100}),{data:eg}=(0,N.z)(O.Z.documentForm,{page:1,perPage:100}),ep=eg||[],{data:eh}=(0,N.z)(O.Z.listOfMagazine,{page:1,perPage:100}),ex=e=>"string"==typeof e?e:void 0,[eZ,ev]=(0,a.useState)([]),[ef,ej]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(async()=>{if(!H||Array.isArray(H))return;let e=(await E.Do.get(O.Z.taskById(H))).data;R({...V,...e,priority:e.priority||"ordinary",task_form:"number"==typeof e.task_form?e.task_form:0,sending_org:e.sending_org||0,department:"number"==typeof e.department?e.department:0,signed_by:"number"==typeof e.signed_by?e.signed_by:0,list_of_magazine:"number"==typeof e.list_of_magazine?e.list_of_magazine:0,start_date:e.start_date?new Date(e.start_date).toISOString().slice(0,10):"",end_date:e.end_date?new Date(e.end_date).toISOString().slice(0,10):""})})()},[H,R]),(0,a.useEffect)(()=>{(async()=>{if(!(!H||Array.isArray(H)))try{var e;let r=await E.Do.get(O.Z.taskPart,{task:H,perPage:50});et((null===(e=r.data)||void 0===e?void 0:e.results)||[])}catch(e){console.error("Error fetching task parts:",e)}})()},[H]);let eS=async()=>{if(!(!H||Array.isArray(H))&&Y)try{var r;await E.Do.post(O.Z.taskPart,{task:Number(H),title:String(e("tasks.parts.simpleTitle")),department:0,assignee:Y,start_date:"",end_date:"",status:"new",note:"",created_by:(null==J?void 0:J.id)||1,updated_by:(null==J?void 0:J.id)||1}),G.success(String(e("tasks.toast.assigneeAssigned")));let t=await E.Do.get(O.Z.taskPart,{task:H,perPage:50});et((null===(r=t.data)||void 0===r?void 0:r.results)||[])}catch(r){G.error((null==r?void 0:r.message)||String(e("errors.somethingWentWrong")))}},ey=e=>{if(e){let r=er.find(r=>r.id===e);r&&(ei({title:r.title,department:r.department,assignee:r.assignee,start_date:r.start_date,end_date:r.end_date,note:r.note}),eu(e))}else ei({title:"",department:0,assignee:0,start_date:"",end_date:"",note:""}),eu(null);eo({}),ea(!0)},e_=()=>{ea(!1),eu(null)},ek=async()=>{if(!H||Array.isArray(H))return;let r={};if(es.title&&es.title.trim()||(r.title=String(e("errors.required"))),(!es.department||0>=Number(es.department))&&(r.department=String(e("errors.required"))),(!es.assignee||0>=Number(es.assignee))&&(r.assignee=String(e("errors.required"))),es.start_date||(r.start_date=String(e("errors.required"))),es.end_date||(r.end_date=String(e("errors.required"))),es.start_date&&es.end_date){let t=new Date(es.start_date);new Date(es.end_date)<t&&(r.end_date=String(e("errors.endAfterStart")))}if(es.note&&String(es.note).trim()||(r.note=String(e("errors.required"))),eo(r),Object.keys(r).length>0){G.error(String(e("tasks.toast.partFormRequired")));return}try{var t;ed?(await E.Do.put(O.Z.taskPartById(ed),{title:es.title||"",department:es.department||0,assignee:es.assignee||0,start_date:es.start_date||"",end_date:es.end_date||"",note:es.note||"",updated_by:(null==J?void 0:J.id)||1,task:Number(H)}),G.success(String(e("common.saved")))):(await E.Do.post(O.Z.taskPart,{task:Number(H),title:es.title||String(e("tasks.parts.newTitleFallback")),department:es.department||0,assignee:es.assignee||0,start_date:es.start_date||"",end_date:es.end_date||"",status:"new",note:es.note||"",created_by:(null==J?void 0:J.id)||1,updated_by:(null==J?void 0:J.id)||1}),G.success(String(e("tasks.toast.partCreated")))),ea(!1),eu(null);let r=await E.Do.get(O.Z.taskPart,{task:H,perPage:50});et((null===(t=r.data)||void 0===t?void 0:t.results)||[])}catch(r){G.error((null==r?void 0:r.message)||String(e("errors.somethingWentWrong")))}},eb=async r=>{try{await E.Do.delete(O.Z.taskPartById(r)),G.success(String(e("tasks.toast.partDeleted"))),et(er.filter(e=>e.id!==r))}catch(r){G.error((null==r?void 0:r.message)||String(e("errors.somethingWentWrong")))}},eP=async r=>{try{if(!H||Array.isArray(H))return;eZ.length&&await eq(),await E.Do.put(O.Z.taskById(H),{...r,company:null==J?void 0:J.company_id}),G.success(String(e("tasks.toast.updated"))),X.push("/tasks/view/".concat(H))}catch(r){G.error((null==r?void 0:r.message)||String(e("tasks.toast.updateError")))}},eq=async()=>{if(H){if(!eZ.length){G.error(String(e("tasks.attachments.fileRequired")));return}try{for(let e of(ej(!0),eZ)){let r=new FormData;r.append("file",e),r.append("title",e.name),r.append("task",H.toString()),await E.Do.postForm(O.Z.taskAttachment,r)}G.success(String(e("tasks.attachments.attached"))),ev([])}catch(r){console.error("Failed to create attachment",r),G.error(String(e("tasks.attachments.attachError")));return}finally{ej(!1)}}};return(0,n.jsxs)(s.Z,{spacing:4,children:[(0,n.jsx)(M.Z,{children:(0,n.jsx)("form",{onSubmit:W(eP),children:(0,n.jsxs)(i.ZP,{container:!0,spacing:4,children:[(0,n.jsx)(i.ZP,{item:!0,xs:12,md:6,children:(0,n.jsx)(l.Z,{variant:"outlined",children:(0,n.jsx)(o.Z,{children:(0,n.jsxs)(i.ZP,{container:!0,spacing:4,children:[(0,n.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(T.Qr,{name:"type",control:t,render:r=>{let{field:t,fieldState:a}=r,s=[{value:"task",label:String(e("tasks.type.task"))},{value:"application",label:String(e("tasks.type.application"))}];return(0,n.jsx)(d.Z,{options:s,value:s.find(e=>e.value===t.value)||null,onChange:(e,r)=>t.onChange((null==r?void 0:r.value)||""),isOptionEqualToValue:(e,r)=>e.value===r.value,getOptionLabel:e=>e.label,renderInput:r=>{var t;return(0,n.jsx)(I.Z,{...r,fullWidth:!0,label:String(e("tasks.form.type")),error:!!a.error,helperText:ex(null===(t=a.error)||void 0===t?void 0:t.message)})}})}})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(T.Qr,{name:"priority",control:t,render:r=>{var t;let{field:a,fieldState:s}=r;return(0,n.jsxs)(u.Z,{error:!!s.error,children:[(0,n.jsx)(c.Z,{children:String(e("tasks.form.priority"))}),(0,n.jsxs)(m.Z,{row:!0,...a,value:a.value||"ordinary",children:[(0,n.jsx)(g.Z,{value:"ordinary",control:(0,n.jsx)(p.Z,{}),label:String(e("tasks.priority.ordinary"))}),(0,n.jsx)(g.Z,{value:"orgently",control:(0,n.jsx)(p.Z,{}),label:String(e("tasks.priority.orgently"))})]}),!!s.error&&(0,n.jsx)(h.Z,{variant:"caption",color:"error",children:ex(null===(t=s.error)||void 0===t?void 0:t.message)})]})}})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,children:(0,n.jsx)(T.Qr,{name:"name",control:t,rules:{required:String(e("errors.required"))},render:r=>{var t;let{field:a,fieldState:s}=r;return(0,n.jsx)(I.Z,{fullWidth:!0,label:String(e("tasks.form.name")),...a,error:!!s.error,helperText:ex(null===(t=s.error)||void 0===t?void 0:t.message)})}})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(T.Qr,{name:"task_form",control:t,rules:{required:String(e("errors.required"))},render:r=>{let{field:t,fieldState:a}=r;return(0,n.jsx)(d.Z,{options:ep||[],value:(ep||[]).find(e=>e.id===t.value)||null,onChange:(e,r)=>{var n;return t.onChange(null!==(n=null==r?void 0:r.id)&&void 0!==n?n:0)},isOptionEqualToValue:(e,r)=>e.id===r.id,getOptionLabel:e=>(null==e?void 0:e.name)||"",renderInput:r=>{var t;return(0,n.jsx)(I.Z,{...r,fullWidth:!0,label:String(e("tasks.form.taskForm")),error:!!a.error,helperText:ex(null===(t=a.error)||void 0===t?void 0:t.message)})}})}})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(T.Qr,{name:"sending_org",control:t,rules:{required:!0},render:r=>{var t;let{field:a,fieldState:s}=r;return(0,n.jsx)(I.Z,{fullWidth:!0,label:String(e("tasks.form.sendingOrg")),...a,error:!!s.error,helperText:ex(null===(t=s.error)||void 0===t?void 0:t.message)})}})}),(0,n.jsxs)(i.ZP,{item:!0,xs:12,sm:6,children:[(0,n.jsxs)(x.Z,{component:"label",variant:"outlined",disabled:ef,startIcon:(0,n.jsx)(L.Z,{icon:"mdi:file-upload"}),children:[String(e("tasks.attachments.chooseFiles")),(0,n.jsx)("input",{hidden:!0,type:"file",multiple:!0,onChange:e=>{let r=Array.from(e.target.files||[]);r.length&&(ev(e=>{let t=new Map;for(let r of e)t.set("".concat(r.name,"-").concat(r.size,"-").concat(r.lastModified),r);for(let e of r)t.set("".concat(e.name,"-").concat(e.size,"-").concat(e.lastModified),e);return Array.from(t.values())}),e.target.value="")}})]}),eZ.length?(0,n.jsx)(s.Z,{direction:"row",spacing:1,alignItems:"center",flexWrap:"wrap",useFlexGap:!0,marginTop:5,children:eZ.map(e=>{let r="".concat(e.name,"-").concat(e.size,"-").concat(e.lastModified);return(0,n.jsx)(Z.Z,{icon:(0,n.jsx)(L.Z,{icon:"mdi:file"}),label:e.name,variant:"outlined",onDelete:ef?void 0:()=>ev(e=>e.filter(e=>"".concat(e.name,"-").concat(e.size,"-").concat(e.lastModified)!==r))},r)})}):null]}),(0,n.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(T.Qr,{name:"list_of_magazine",control:t,rules:{required:String(e("errors.required"))},render:r=>{let{field:t,fieldState:a}=r;return(0,n.jsx)(d.Z,{options:eh||[],value:(eh||[]).find(e=>e.id===t.value)||null,onChange:(e,r)=>{var n;return t.onChange(null!==(n=null==r?void 0:r.id)&&void 0!==n?n:0)},isOptionEqualToValue:(e,r)=>e.id===r.id,getOptionLabel:e=>(null==e?void 0:e.name)||"",renderInput:r=>{var t;return(0,n.jsx)(I.Z,{...r,fullWidth:!0,label:String(e("tasks.form.magazine")),error:!!a.error,helperText:ex(null===(t=a.error)||void 0===t?void 0:t.message)})}})}})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(T.Qr,{name:"output_doc_number",control:t,rules:{required:String(e("errors.required"))},render:r=>{var t;let{field:a,fieldState:s}=r;return(0,n.jsx)(I.Z,{fullWidth:!0,label:String(e("tasks.form.outputDocNumber")),...a,error:!!s.error,helperText:ex(null===(t=s.error)||void 0===t?void 0:t.message)})}})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(T.Qr,{name:"input_doc_number",control:t,rules:{required:String(e("errors.required"))},render:r=>{var t;let{field:a,fieldState:s}=r;return(0,n.jsx)(I.Z,{fullWidth:!0,label:String(e("tasks.form.inputDocNumber")),...a,error:!!s.error,helperText:ex(null===(t=s.error)||void 0===t?void 0:t.message)})}})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(T.Qr,{name:"start_date",control:t,rules:{required:String(e("errors.required"))},render:r=>{var t;let{field:a,fieldState:s}=r,i=a.value?new Date(a.value):null;return(0,n.jsx)("div",{children:(0,n.jsx)(F(),{selected:i,onChange:e=>a.onChange(e?e.toISOString().slice(0,10):""),dateFormat:"yyyy-MM-dd",customInput:(0,n.jsx)(I.Z,{label:String(e("tasks.form.startDate")),fullWidth:!0,error:!!s.error,helperText:ex(null===(t=s.error)||void 0===t?void 0:t.message)}),showPopperArrow:!0,isClearable:!0})})}})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(T.Qr,{name:"end_date",control:t,rules:{required:String(e("errors.required"))},render:r=>{var t;let{field:a,fieldState:s}=r,i=a.value?new Date(a.value):null;return(0,n.jsx)("div",{children:(0,n.jsx)(F(),{selected:i,onChange:e=>a.onChange(e?e.toISOString().slice(0,10):""),dateFormat:"yyyy-MM-dd",customInput:(0,n.jsx)(I.Z,{label:String(e("tasks.form.endDate")),fullWidth:!0,error:!!s.error,helperText:ex(null===(t=s.error)||void 0===t?void 0:t.message)}),showPopperArrow:!0,isClearable:!0})})}})})]})})})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,md:6,children:(0,n.jsx)(l.Z,{variant:"outlined",children:(0,n.jsx)(o.Z,{children:(0,n.jsxs)(i.ZP,{container:!0,spacing:4,children:[(0,n.jsx)(i.ZP,{item:!0,xs:12,children:(0,n.jsx)(T.Qr,{name:"department",control:t,rules:{required:!0},render:r=>{let{field:t,fieldState:a}=r;return(0,n.jsx)(d.Z,{options:ec||[],value:(ec||[]).find(e=>e.id===t.value)||null,onChange:(e,r)=>{var n;return t.onChange(null!==(n=null==r?void 0:r.id)&&void 0!==n?n:0)},isOptionEqualToValue:(e,r)=>e.id===r.id,getOptionLabel:e=>(null==e?void 0:e.name)||"",renderInput:r=>{var t;return(0,n.jsx)(I.Z,{...r,fullWidth:!0,label:String(e("tasks.form.department")),error:!!a.error,helperText:ex(null===(t=a.error)||void 0===t?void 0:t.message)})}})}})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,children:(0,n.jsx)(T.Qr,{name:"signed_by",control:t,rules:{required:!0},render:r=>{let{field:t,fieldState:a}=r;return(0,n.jsx)(d.Z,{fullWidth:!0,options:em||[],getOptionLabel:e=>e.fullname,value:(null==em?void 0:em.find(e=>e.id===t.value))||null,onChange:(e,r)=>t.onChange((null==r?void 0:r.id)||0),renderInput:r=>{var t;return(0,n.jsx)(I.Z,{...r,label:String(e("tasks.form.signedBy")),error:!!a.error,helperText:ex(null===(t=a.error)||void 0===t?void 0:t.message),placeholder:String(e("common.selectPlaceholder"))})}})}})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,sm:12,children:(0,n.jsx)(T.Qr,{name:"note",control:t,render:r=>{var t;let{field:a,fieldState:s}=r;return(0,n.jsx)(I.Z,{fullWidth:!0,multiline:!0,rows:3,label:String(e("tasks.form.note")),...a,error:!!s.error,helperText:ex(null===(t=s.error)||void 0===t?void 0:t.message)})}})})]})})})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,children:(0,n.jsxs)(s.Z,{direction:"row",spacing:2,justifyContent:"flex-end",children:[(0,n.jsx)(x.Z,{type:"button",variant:"outlined",onClick:()=>X.back(),children:String(e("common.cancel"))}),(0,n.jsx)(x.Z,{type:"submit",variant:"contained",children:String(e("common.save"))})]})})]})})}),(0,n.jsxs)(l.Z,{children:[(0,n.jsxs)(o.Z,{children:[(0,n.jsxs)(u.Z,{component:"fieldset",children:[(0,n.jsx)(c.Z,{component:"legend",children:String(e("tasks.assignment.method"))}),(0,n.jsxs)(m.Z,{row:!0,value:K,onChange:e=>U(e.target.value),children:[(0,n.jsx)(g.Z,{value:"simple",control:(0,n.jsx)(p.Z,{}),label:String(e("tasks.assignment.simple"))}),(0,n.jsx)(g.Z,{value:"split",control:(0,n.jsx)(p.Z,{}),label:String(e("tasks.assignment.split"))})]})]}),"simple"===K?(0,n.jsxs)(s.Z,{spacing:2,sx:{mt:3},children:[(0,n.jsx)(h.Z,{variant:"subtitle2",children:String(e("tasks.assignment.chooseAssignee"))}),(0,n.jsxs)(i.ZP,{container:!0,spacing:2,alignItems:"end",children:[(0,n.jsx)(i.ZP,{item:!0,xs:12,sm:8,children:(0,n.jsx)(d.Z,{options:em||[],value:(em||[]).find(e=>e.id===Y)||null,onChange:(e,r)=>ee((null==r?void 0:r.id)||0),isOptionEqualToValue:(e,r)=>e.id===r.id,getOptionLabel:e=>(null==e?void 0:e.fullname)||"",renderInput:r=>(0,n.jsx)(I.Z,{...r,fullWidth:!0,label:String(e("tasks.assignment.assignee")),placeholder:String(e("common.selectPlaceholder"))})})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,sm:4,children:(0,n.jsx)(x.Z,{variant:"contained",fullWidth:!0,onClick:eS,disabled:!Y,children:String(e("tasks.assignment.attach"))})})]})]}):(0,n.jsxs)(s.Z,{spacing:2,sx:{mt:3},children:[(0,n.jsxs)(s.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,n.jsx)(h.Z,{variant:"subtitle2",children:String(e("tasks.parts.title"))}),(0,n.jsx)(x.Z,{variant:"contained",size:"small",startIcon:(0,n.jsx)(L.Z,{icon:"mdi:plus"}),onClick:()=>ey(),children:String(e("common.add"))})]}),er.length>0?(0,n.jsx)(v.Z,{component:f.Z,children:(0,n.jsxs)(j.Z,{size:"small",children:[(0,n.jsx)(S.Z,{children:(0,n.jsxs)(y.Z,{children:[(0,n.jsx)(_.Z,{children:String(e("tasks.parts.table.title"))}),(0,n.jsx)(_.Z,{children:String(e("tasks.parts.table.department"))}),(0,n.jsx)(_.Z,{children:String(e("tasks.parts.table.assignee"))}),(0,n.jsx)(_.Z,{children:String(e("tasks.parts.table.start"))}),(0,n.jsx)(_.Z,{children:String(e("tasks.parts.table.end"))}),(0,n.jsx)(_.Z,{children:String(e("tasks.parts.table.note"))}),(0,n.jsx)(_.Z,{align:"right",children:String(e("common.actions"))})]})}),(0,n.jsx)(k.Z,{children:er.map(e=>{var r,t;return(0,n.jsxs)(y.Z,{children:[(0,n.jsx)(_.Z,{children:e.title}),(0,n.jsx)(_.Z,{children:(null==ec?void 0:null===(r=ec.find(r=>r.id===e.department))||void 0===r?void 0:r.name)||e.department}),(0,n.jsx)(_.Z,{children:(null==em?void 0:null===(t=em.find(r=>r.id===e.assignee))||void 0===t?void 0:t.fullname)||e.assignee}),(0,n.jsx)(_.Z,{children:e.start_date}),(0,n.jsx)(_.Z,{children:e.end_date}),(0,n.jsx)(_.Z,{children:e.note}),(0,n.jsx)(_.Z,{align:"right",children:(0,n.jsxs)(s.Z,{direction:"row",spacing:1,children:[(0,n.jsx)(b.Z,{size:"small",onClick:()=>ey(e.id),children:(0,n.jsx)(L.Z,{icon:"mdi:pencil"})}),(0,n.jsx)(b.Z,{size:"small",color:"error",onClick:()=>eb(e.id),children:(0,n.jsx)(L.Z,{icon:"mdi:delete"})})]})})]},e.id)})})]})}):(0,n.jsx)(h.Z,{variant:"body2",color:"text.secondary",children:String(e("tasks.parts.empty"))})]})]}),(0,n.jsxs)(P.Z,{open:en,onClose:e_,maxWidth:"sm",fullWidth:!0,children:[(0,n.jsx)(q.Z,{children:ed?"Edit Task Part":String(e("tasks.parts.dialog.title"))}),(0,n.jsx)(w.Z,{children:(0,n.jsxs)(i.ZP,{container:!0,spacing:3,sx:{mt:1},children:[(0,n.jsx)(i.ZP,{item:!0,xs:12,children:(0,n.jsx)(I.Z,{fullWidth:!0,label:String(e("tasks.parts.form.title")),value:es.title,onChange:e=>ei({...es,title:e.target.value}),error:!!el.title,helperText:el.title})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,children:(0,n.jsx)(d.Z,{fullWidth:!0,options:ec||[],getOptionLabel:e=>e.name,value:(null==ec?void 0:ec.find(e=>e.id===es.department))||null,onChange:(e,r)=>ei({...es,department:(null==r?void 0:r.id)||0}),renderInput:r=>(0,n.jsx)(I.Z,{...r,label:String(e("tasks.parts.form.department")),error:!!el.department,helperText:el.department,placeholder:String(e("common.selectPlaceholder"))})})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,children:(0,n.jsx)(d.Z,{fullWidth:!0,options:em||[],getOptionLabel:e=>e.fullname,value:(null==em?void 0:em.find(e=>e.id===es.assignee))||null,onChange:(e,r)=>ei({...es,assignee:(null==r?void 0:r.id)||0}),renderInput:r=>(0,n.jsx)(I.Z,{...r,label:String(e("tasks.parts.form.assignee")),error:!!el.assignee,helperText:el.assignee,placeholder:String(e("common.selectPlaceholder"))})})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(I.Z,{fullWidth:!0,type:"date",label:String(e("tasks.parts.form.startDate")),value:es.start_date,onChange:e=>ei({...es,start_date:e.target.value}),InputLabelProps:{shrink:!0},error:!!el.start_date,helperText:el.start_date})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(I.Z,{fullWidth:!0,type:"date",label:String(e("tasks.parts.form.endDate")),value:es.end_date,onChange:e=>ei({...es,end_date:e.target.value}),InputLabelProps:{shrink:!0},error:!!el.end_date,helperText:el.end_date})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,children:(0,n.jsx)(I.Z,{fullWidth:!0,multiline:!0,rows:3,label:String(e("tasks.parts.form.note")),value:es.note,onChange:e=>ei({...es,note:e.target.value}),error:!!el.note,helperText:el.note})})]})}),(0,n.jsxs)(C.Z,{children:[(0,n.jsx)(x.Z,{onClick:e_,children:String(e("common.cancel"))}),(0,n.jsx)(x.Z,{variant:"contained",onClick:ek,children:String(e("common.save"))})]})]})]})]})};function X(){return(0,n.jsx)(G,{})}}},function(e){e.O(0,[2785,7536,9084,6437,4021,2216,1863,2888,9774,179],function(){return e(e.s=31865)}),_N_E=e.O()}]);