(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7749],{94487:function(t,e,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tasks/view/[id]",function(){return a(51548)}])},74538:function(t,e){"use strict";let a=t=>Array.isArray(t)?t[0]:null==t?"":String(t);e.Z={login:"/auth/token",logout:"/auth/logout",me:"/user-view",companyProfile:"/company-profile",companyProfileById:t=>"/company-profile/".concat(a(t)),companyProfileFields:"/company-profile/fields",country:"/country/",district:"/district",districtById:t=>"/district/".concat(a(t)),region:"/region/",regionById:t=>"/region/".concat(a(t)),countryById:t=>"/country/".concat(a(t)),countryFields:"/country/fields/",command:"/command/",commandById:t=>"/command/".concat(a(t)),industries:"/industry",industryById:t=>"/industry/".concat(a(t)),industryFields:"/industry/fields",users:"/user",userById:t=>"/user/".concat(a(t)),equipmentCategories:"/equipment-category",equipmentCategoryById:t=>"/equipment-category/".concat(a(t)),services:"/service",serviceById:t=>"/service/".concat(a(t)),partners:"/partner",partnerById:t=>"/partner/".concat(a(t)),company:"/company/",companyById:t=>"/company/".concat(a(t)),replyLetter:"/reply-letter/",replyLetterById:t=>"/reply-letter/".concat(a(t)),replyLetterFile:"/reply-letter-file/",replyLetterFileById:t=>"/reply-letter-file/".concat(a(t)),documents:"/documents/",documentById:t=>"/documents/".concat(a(t)),documentForm:"/document-form/",documentFormById:t=>"/document-form/".concat(a(t)),listOfMagazine:"/list-of-magazine/",listOfMagazineById:t=>"/list-of-magazine/".concat(a(t)),task:"/task/",taskById:t=>"/task/".concat(a(t)),taskPart:"/task-part/",taskPartById:t=>"/task-part/".concat(a(t)),taskEvent:"/task-event/",taskEventById:t=>"/task-event/".concat(a(t)),taskComment:"/task-comment/",taskCommentById:t=>"/task-comment/".concat(a(t)),taskAttachment:"/task-attachment/",taskAttachmentById:t=>"/task-attachment/".concat(a(t)),department:"/department/",departmentById:t=>"/department/".concat(a(t)),position:"/position/",positionById:t=>"/position/".concat(a(t)),projects:"/project",projectById:t=>"/project/".concat(a(t)),projectDeliverables:"/project-deliverable",projectDeliverableById:t=>"/project-deliverable/".concat(a(t)),projectImages:"/project-image",projectImageById:t=>"/project-image/".concat(a(t)),stats:"/stats",statById:t=>"/stats/".concat(a(t)),faqs:"/faq",faqById:t=>"/faq/".concat(a(t)),inquiries:"/inquiry",inquiryById:t=>"/inquiry/".concat(a(t)),downloads:"/command-file/",downloadById:t=>"/command-file/".concat(a(t)),news:"/news-post",newsById:t=>"/news-post/".concat(a(t)),testimonials:"/testimonial",testimonialById:t=>"/testimonial/".concat(a(t)),ourWork:"/our-work",ourWorkById:t=>"/our-work/".concat(a(t)),applicationApprovedByID:t=>"/application-approved/".concat(a(t)),limitData:"/limit-data"}},51548:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return k}});var n=a(85893),s=a(11163),i=a(60762),r=a(34375),d=a(71919),o=a(67294),l=a(68573),c=a(90642),u=a(84166),m=a(96788),p=a(81873),x=a(43374),j=a(28907),y=a(56912),h=a(52293),v=a(74538),g=a(73907),Z=a(87536),b=t=>{let{taskId:e}=t,[a,s]=(0,o.useState)([]),[i,r]=(0,o.useState)(null),{control:d,handleSubmit:x,reset:j}=(0,Z.cI)({defaultValues:{id:0,title:"",status:"new",department:0,assignee:0,start_date:"",end_date:"",note:""}});(0,o.useEffect)(()=>{let t=async()=>{var t,a;let n=await h.Do.get(v.Z.taskPart,{task:e,perPage:50});s((null===(t=n.data)||void 0===t?void 0:t.results)||[]);let i=((null===(a=n.data)||void 0===a?void 0:a.results)||[])[0]||null;r(i),i&&j(i)};e&&t()},[e,j]),(0,o.useEffect)(()=>{i&&j(i)},[i,j]);let b=async()=>{var t;let a=(null===(t=(await h.Do.get(v.Z.taskPart,{task:e,perPage:50})).data)||void 0===t?void 0:t.results)||[];s(a);let n=i&&a.find(t=>t.id===i.id)||null;r(n||a[0]||null),(n||a[0])&&j(n||a[0])},f=async t=>{i&&(await h.Do.put(v.Z.taskPartById(i.id),{title:t.title,status:t.status,department:t.department,assignee:t.assignee,start_date:t.start_date,end_date:t.end_date,note:t.note,updated_by:1}),await b())};return(0,n.jsxs)(l.ZP,{container:!0,spacing:4,children:[(0,n.jsxs)(l.ZP,{item:!0,xs:12,children:[(0,n.jsx)(m.Z,{variant:"subtitle1",children:"Qismlar roʻyxati"}),(0,n.jsx)(u.Z,{spacing:2,sx:{mt:2},children:a.map(t=>(0,n.jsx)(c.Z,{sx:{p:2,border:t=>"1px solid rgba(".concat(t.palette.customColors.main,", 0.2)"),borderRadius:2,cursor:"pointer"},onClick:()=>r(t),children:(0,n.jsxs)(u.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,n.jsx)(m.Z,{variant:"body2",children:t.title}),(0,n.jsx)(p.Z,{label:t.status,size:"small"}),(0,n.jsxs)(m.Z,{variant:"caption",children:[t.start_date," → ",t.end_date]})]})},t.id))})]}),(0,n.jsxs)(l.ZP,{item:!0,xs:12,children:[(0,n.jsx)(y.Z,{sx:{my:3}}),(0,n.jsx)(m.Z,{variant:"subtitle1",children:"Tanlangan qism amallari"}),i?(0,n.jsx)("form",{onSubmit:x(f),children:(0,n.jsxs)(l.ZP,{container:!0,spacing:3,sx:{mt:1},children:[(0,n.jsxs)(l.ZP,{item:!0,xs:12,children:[(0,n.jsx)(m.Z,{variant:"caption",children:"Qism nomi"}),(0,n.jsx)(Z.Qr,{name:"title",control:d,render:t=>{let{field:e}=t;return(0,n.jsx)("input",{...e,style:{width:"100%",padding:10,borderRadius:8,border:"1px solid #ddd"}})}})]}),(0,n.jsxs)(l.ZP,{item:!0,xs:12,sm:6,children:[(0,n.jsx)(m.Z,{variant:"caption",children:"Status"}),(0,n.jsx)(Z.Qr,{name:"status",control:d,render:t=>{let{field:e}=t;return(0,n.jsxs)("select",{...e,style:{width:"100%",padding:10,borderRadius:8,border:"1px solid #ddd"},children:[(0,n.jsx)("option",{value:"new",children:"New"}),(0,n.jsx)("option",{value:"in_progress",children:"In progress"}),(0,n.jsx)("option",{value:"on_review",children:"On review"}),(0,n.jsx)("option",{value:"returned",children:"Returned"}),(0,n.jsx)("option",{value:"done",children:"Done"}),(0,n.jsx)("option",{value:"cancelled",children:"Cancelled"})]})}})]}),(0,n.jsxs)(l.ZP,{item:!0,xs:12,sm:6,children:[(0,n.jsx)(m.Z,{variant:"caption",children:"Ijrochi (assignee)"}),(0,n.jsx)(Z.Qr,{name:"assignee",control:d,render:t=>{let{field:e}=t;return(0,n.jsx)("input",{type:"number",...e,style:{width:"100%",padding:10,borderRadius:8,border:"1px solid #ddd"}})}})]}),(0,n.jsxs)(l.ZP,{item:!0,xs:12,sm:6,children:[(0,n.jsx)(m.Z,{variant:"caption",children:"Boʻlim (department)"}),(0,n.jsx)(Z.Qr,{name:"department",control:d,render:t=>{let{field:e}=t;return(0,n.jsx)("input",{type:"number",...e,style:{width:"100%",padding:10,borderRadius:8,border:"1px solid #ddd"}})}})]}),(0,n.jsxs)(l.ZP,{item:!0,xs:12,sm:6,children:[(0,n.jsx)(m.Z,{variant:"caption",children:"Boshlash (start_date)"}),(0,n.jsx)(Z.Qr,{name:"start_date",control:d,render:t=>{let{field:e}=t;return(0,n.jsx)("input",{type:"date",...e,style:{width:"100%",padding:10,borderRadius:8,border:"1px solid #ddd"}})}})]}),(0,n.jsxs)(l.ZP,{item:!0,xs:12,sm:6,children:[(0,n.jsx)(m.Z,{variant:"caption",children:"Tugash (end_date)"}),(0,n.jsx)(Z.Qr,{name:"end_date",control:d,render:t=>{let{field:e}=t;return(0,n.jsx)("input",{type:"date",...e,style:{width:"100%",padding:10,borderRadius:8,border:"1px solid #ddd"}})}})]}),(0,n.jsxs)(l.ZP,{item:!0,xs:12,children:[(0,n.jsx)(m.Z,{variant:"caption",children:"Izoh (note)"}),(0,n.jsx)(Z.Qr,{name:"note",control:d,render:t=>{let{field:e}=t;return(0,n.jsx)("textarea",{rows:3,...e,style:{width:"100%",padding:10,borderRadius:8,border:"1px solid #ddd"}})}})]}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsxs)(u.Z,{direction:"row",spacing:2,children:[(0,n.jsx)(g.Z,{variant:"contained",size:"small",type:"submit",children:"Saqlash"}),(0,n.jsx)(g.Z,{variant:"outlined",size:"small",color:"info",onClick:()=>{i&&f({...i,status:"on_review"})},children:"Koʻrib chiqishga yuborish"}),(0,n.jsx)(g.Z,{variant:"outlined",size:"small",color:"warning",onClick:()=>{i&&f({...i,status:"returned"})},children:"Qaytarish"}),(0,n.jsx)(g.Z,{variant:"outlined",size:"small",color:"success",onClick:()=>{i&&f({...i,status:"done"})},children:"Bajarildi"})]})})]})}):(0,n.jsx)(m.Z,{variant:"body2",sx:{mt:2},children:"Qism tanlanmagan"})]})]})},f=t=>{let{id:e}=t,[a,s]=(0,o.useState)(0),[i,r]=(0,o.useState)(null),[d,g]=(0,o.useState)([]),[Z,f]=(0,o.useState)([]),[k,I]=(0,o.useState)([]);return(0,o.useEffect)(()=>{let t=async()=>{var t,a,n;let[s,i,d,o]=await Promise.all([h.Do.get(v.Z.taskById(e)),h.Do.get(v.Z.taskEvent,{task:e,perPage:50}),h.Do.get(v.Z.taskComment,{task:e,perPage:50}),h.Do.get(v.Z.taskAttachment,{task:e,perPage:50})]);r(s.data),g((null===(t=i.data)||void 0===t?void 0:t.results)||[]),f((null===(a=d.data)||void 0===a?void 0:a.results)||[]),I((null===(n=o.data)||void 0===n?void 0:n.results)||[])};e&&t()},[e]),(0,n.jsxs)(l.ZP,{container:!0,spacing:6,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,md:4,lg:3,children:(0,n.jsx)(b,{taskId:e})}),(0,n.jsxs)(l.ZP,{item:!0,xs:12,md:8,lg:9,children:[(0,n.jsxs)(c.Z,{sx:{mb:3},children:[(0,n.jsxs)(u.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,n.jsx)(m.Z,{variant:"h6",children:(null==i?void 0:i.name)||"Task #".concat(e)}),(null==i?void 0:i.status)&&(0,n.jsx)(p.Z,{label:i.status,color:"primary",size:"small"}),(null==i?void 0:i.priority)&&(0,n.jsx)(p.Z,{label:i.priority,color:"warning",size:"small"}),(null==i?void 0:i.type)&&(0,n.jsx)(p.Z,{label:i.type,color:"info",size:"small"})]}),(0,n.jsx)(m.Z,{variant:"body2",sx:{mt:1},children:(null==i?void 0:i.sending_org)&&"Yuboruvchi: ".concat(i.sending_org)}),(0,n.jsxs)(m.Z,{variant:"body2",children:[(null==i?void 0:i.input_doc_number)&&"Kirish raqami: ".concat(i.input_doc_number),(null==i?void 0:i.output_doc_number)&&" | Chiqish raqami: ".concat(i.output_doc_number)]})]}),(0,n.jsxs)(x.Z,{value:a,onChange:(t,e)=>s(e),sx:{mb:4},children:[(0,n.jsx)(j.Z,{label:"Hujjat"}),(0,n.jsx)(j.Z,{label:"Vazifalar tarixi"}),(0,n.jsx)(j.Z,{label:"Amalga oshirish jarayoni"})]}),0===a&&(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(m.Z,{variant:"subtitle1",sx:{mb:2},children:"Izohlar (Chip/Tag)"}),(0,n.jsx)(u.Z,{direction:"row",spacing:1,flexWrap:"wrap",sx:{mb:4},children:Z.map(t=>(0,n.jsx)(p.Z,{label:t.text,color:t.is_system?"default":"secondary",variant:"outlined"},t.id))}),(0,n.jsx)(y.Z,{sx:{my:2}}),(0,n.jsx)(m.Z,{variant:"subtitle1",sx:{mb:2},children:"Fayllar (Attachments)"}),(0,n.jsx)(u.Z,{direction:"column",spacing:1,children:k.map(t=>(0,n.jsxs)(u.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,n.jsx)(m.Z,{variant:"body2",children:t.title}),(0,n.jsx)("a",{href:t.file,download:!0,children:"download"})]},t.id))})]}),1===a&&(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(m.Z,{variant:"subtitle1",sx:{mb:2},children:"Vazifalar tarixi (TaskEvent list)"}),(0,n.jsx)(u.Z,{spacing:2,children:d.map(t=>(0,n.jsxs)(c.Z,{sx:{p:2,border:t=>"1px solid rgba(".concat(t.palette.customColors.main,", 0.2)"),borderRadius:2},children:[(0,n.jsx)(m.Z,{variant:"caption",children:t.created_at}),(0,n.jsxs)(m.Z,{variant:"body2",children:["[",t.event_type,"] ",t.message]})]},t.id))})]}),2===a&&(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(m.Z,{variant:"subtitle1",sx:{mb:2},children:"Amalga oshirish jarayoni (Timeline)"}),(0,n.jsx)(u.Z,{spacing:2,children:d.map(t=>(0,n.jsxs)(u.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,n.jsx)(p.Z,{label:t.event_type,size:"small"}),(0,n.jsx)(m.Z,{variant:"body2",children:t.message}),(0,n.jsx)(m.Z,{variant:"caption",children:t.created_at})]},t.id))})]})]})]})},k=()=>{let{id:t}=(0,s.useRouter)().query;return(0,n.jsxs)(i.Z,{children:[(0,n.jsx)(r.Z,{title:"Task #".concat(t)}),(0,n.jsx)(d.Z,{children:(0,n.jsx)(f,{id:t})})]})}}},function(t){t.O(0,[7536,3035,7141,2888,9774,179],function(){return t(t.s=94487)}),_N_E=t.O()}]);