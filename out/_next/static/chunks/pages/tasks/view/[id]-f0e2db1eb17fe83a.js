(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7749],{94487:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tasks/view/[id]",function(){return a(36174)}])},7879:function(e,t,a){"use strict";var r=a(85893),n=a(67294),i=a(77527),s=a(40492);let l=(0,i.ZP)(s.Z)(e=>{let{theme:t}=e;return{alignItems:"flex-start","& .MuiInputLabel-root":{transform:"none",lineHeight:1.154,position:"relative",marginBottom:t.spacing(1),fontSize:t.typography.body2.fontSize,color:"".concat(t.palette.text.primary," !important")},"& .MuiInputBase-root":{borderRadius:8,backgroundColor:"transparent !important",border:"1px solid rgba(".concat(t.palette.customColors.main,", 0.2)"),transition:t.transitions.create(["border-color","box-shadow"],{duration:t.transitions.duration.shorter}),"&:not(.Mui-focused):not(.Mui-disabled):not(.Mui-error):hover":{borderColor:"rgba(".concat(t.palette.customColors.main,", 0.28)")},"&:before, &:after":{display:"none"},"&.MuiInputBase-sizeSmall":{borderRadius:6},"&.Mui-error":{borderColor:t.palette.error.main},"&.Mui-focused":{boxShadow:t.shadows[2],"& .MuiInputBase-input:not(.MuiInputBase-readOnly):not([readonly])::placeholder":{transform:"translateX(4px)"},"&.MuiInputBase-colorPrimary":{borderColor:t.palette.primary.main},"&.MuiInputBase-colorSecondary":{borderColor:t.palette.secondary.main},"&.MuiInputBase-colorInfo":{borderColor:t.palette.info.main},"&.MuiInputBase-colorSuccess":{borderColor:t.palette.success.main},"&.MuiInputBase-colorWarning":{borderColor:t.palette.warning.main},"&.MuiInputBase-colorError":{borderColor:t.palette.error.main},"&.Mui-error":{borderColor:t.palette.error.main}},"&.Mui-disabled":{backgroundColor:"".concat(t.palette.action.selected," !important")},"& .MuiInputAdornment-root":{marginTop:"0 !important"}},"& .MuiInputBase-input":{color:t.palette.text.secondary,"&:not(textarea)":{padding:"15.5px 13px"},"&:not(textarea).MuiInputBase-inputSizeSmall":{padding:"7.5px 13px"},"&:not(.MuiInputBase-readOnly):not([readonly])::placeholder":{transition:t.transitions.create(["opacity","transform"],{duration:t.transitions.duration.shorter})},"&.MuiInputBase-inputAdornedStart:not(.MuiAutocomplete-input)":{paddingLeft:0},"&.MuiInputBase-inputAdornedEnd:not(.MuiAutocomplete-input)":{paddingRight:0}},"& .MuiFormHelperText-root":{lineHeight:1.154,margin:t.spacing(1,0,0),color:t.palette.text.secondary,fontSize:t.typography.body2.fontSize,"&.Mui-error":{color:t.palette.error.main}},"& .MuiSelect-select:focus, & .MuiNativeSelect-select:focus":{backgroundColor:"transparent"},"& .MuiSelect-filled .MuiChip-root":{height:22},"& .MuiAutocomplete-input":{paddingLeft:"6px !important",paddingTop:"7.5px !important",paddingBottom:"7.5px !important","&.MuiInputBase-inputSizeSmall":{paddingLeft:"6px !important",paddingTop:"2.5px !important",paddingBottom:"2.5px !important"}},"& .MuiAutocomplete-inputRoot":{paddingTop:"8px !important",paddingLeft:"8px !important",paddingBottom:"8px !important","&:not(.MuiInputBase-sizeSmall).MuiInputBase-adornedStart":{paddingLeft:"13px !important"},"&.MuiInputBase-sizeSmall":{paddingTop:"5px !important",paddingLeft:"5px !important",paddingBottom:"5px !important","& .MuiAutocomplete-tag":{margin:2,height:22}}},"& .MuiInputBase-multiline":{padding:"15.25px 13px","&.MuiInputBase-sizeSmall":{padding:"7.25px 13px"},"& textarea.MuiInputBase-inputSizeSmall:placeholder-shown":{overflowX:"hidden"}},"& + .react-datepicker__close-icon":{top:11,"&:after":{fontSize:"1.6rem !important"}}}}),o=(0,n.forwardRef)((e,t)=>{let{size:a="small",InputLabelProps:n,...i}=e;return(0,r.jsx)(l,{size:a,inputRef:t,...i,variant:"filled",InputLabelProps:{...n,shrink:!0}})});t.Z=o},69447:function(e,t,a){"use strict";var r=a(85893),n=a(18745),i=a(17494),s=a(2339),l=a(17643);let o=e=>{let{sx:t,skin:a,color:o,variant:c}=e,d=(0,n.Z)(),u=(0,s.Z)(),x={primary:{boxShadow:"none",color:d.palette.primary.main,backgroundColor:u.primaryLight.backgroundColor},secondary:{boxShadow:"none",color:d.palette.secondary.main,backgroundColor:u.secondaryLight.backgroundColor},success:{boxShadow:"none",color:d.palette.success.main,backgroundColor:u.successLight.backgroundColor},error:{boxShadow:"none",color:d.palette.error.main,backgroundColor:u.errorLight.backgroundColor},warning:{boxShadow:"none",color:d.palette.warning.main,backgroundColor:u.warningLight.backgroundColor},info:{boxShadow:"none",color:d.palette.info.main,backgroundColor:u.infoLight.backgroundColor},grey:{boxShadow:"none",color:d.palette.grey[500],backgroundColor:(0,l.E)(d.palette.grey[500],.12)}};return(0,r.jsx)(i.Z,{...e,sx:o&&"light"===a&&"filled"===c?Object.assign(x[o],t):t})};o.defaultProps={color:"grey",variant:"filled"},t.Z=o},74538:function(e,t){"use strict";let a=e=>Array.isArray(e)?e[0]:null==e?"":String(e);t.Z={login:"/auth/token",logout:"/auth/logout",me:"/user-view",companyProfile:"/company-profile",companyProfileById:e=>"/company-profile/".concat(a(e)),companyProfileFields:"/company-profile/fields",country:"/country/",district:"/district",districtById:e=>"/district/".concat(a(e)),region:"/region/",regionById:e=>"/region/".concat(a(e)),countryById:e=>"/country/".concat(a(e)),countryFields:"/country/fields/",command:"/command/",commandById:e=>"/command/".concat(a(e)),industries:"/industry",industryById:e=>"/industry/".concat(a(e)),industryFields:"/industry/fields",users:"/user",userById:e=>"/user/".concat(a(e)),equipmentCategories:"/equipment-category",equipmentCategoryById:e=>"/equipment-category/".concat(a(e)),services:"/service",serviceById:e=>"/service/".concat(a(e)),partners:"/partner",partnerById:e=>"/partner/".concat(a(e)),company:"/company/",companyById:e=>"/company/".concat(a(e)),replyLetter:"/reply-letter/",replyLetterById:e=>"/reply-letter/".concat(a(e)),replyLetterFile:"/reply-letter-file/",replyLetterFileById:e=>"/reply-letter-file/".concat(a(e)),documents:"/documents/",documentById:e=>"/documents/".concat(a(e)),documentForm:"/document-form/",documentFormById:e=>"/document-form/".concat(a(e)),listOfMagazine:"/list-of-magazine/",listOfMagazineById:e=>"/list-of-magazine/".concat(a(e)),task:"/task/",taskById:e=>"/task/".concat(a(e)),taskPart:"/task-part/",taskPartById:e=>"/task-part/".concat(a(e)),taskEvent:"/task-event/",taskEventById:e=>"/task-event/".concat(a(e)),taskComment:"/task-comment/",taskCommentById:e=>"/task-comment/".concat(a(e)),taskAttachment:"/task-attachment/",taskAttachmentById:e=>"/task-attachment/".concat(a(e)),department:"/department/",departmentById:e=>"/department/".concat(a(e)),position:"/position/",positionById:e=>"/position/".concat(a(e)),projects:"/project",projectById:e=>"/project/".concat(a(e)),projectDeliverables:"/project-deliverable",projectDeliverableById:e=>"/project-deliverable/".concat(a(e)),projectImages:"/project-image",projectImageById:e=>"/project-image/".concat(a(e)),stats:"/stats",statById:e=>"/stats/".concat(a(e)),faqs:"/faq",faqById:e=>"/faq/".concat(a(e)),inquiries:"/inquiry",inquiryById:e=>"/inquiry/".concat(a(e)),downloads:"/command-file/",downloadById:e=>"/command-file/".concat(a(e)),news:"/news-post",newsById:e=>"/news-post/".concat(a(e)),testimonials:"/testimonial",testimonialById:e=>"/testimonial/".concat(a(e)),ourWork:"/our-work",ourWorkById:e=>"/our-work/".concat(a(e)),applicationApprovedByID:e=>"/application-approved/".concat(a(e)),limitData:"/limit-data"}},36174:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ey}});var r=a(85893),n=a(67294),i=a(11163),s=a(90642),l=a(68573),o=a(60762),c=a(71919),d=a(84166),u=a(96788),x=a(81873),p=a(43374),m=a(28907),h=a(74538),j=a(52293),g=a(18745),y=a(56912),Z=a(76592),v=a(70360),b=a(46577),f=a(8863),k=a(19827),w=a(21038),_=a(52857),I=a(75673);function B(e){let{parts:t,selectedPartId:a,setSelectedPartId:n}=e,i=e=>{switch(e){case"new":default:return"default";case"in_progress":return"info";case"on_review":case"returned":return"warning";case"done":return"success";case"cancelled":return"error"}};return(0,r.jsx)(o.Z,{children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Z,{children:(0,r.jsxs)(d.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:2},children:[(0,r.jsx)(u.Z,{variant:"subtitle2",children:"Qismlar (TaskPart)"}),(0,r.jsxs)(u.Z,{variant:"caption",color:"text.secondary",children:[t.length," ta"]})]})}),t.length?(0,r.jsxs)(Z.Z,{size:"small",sx:{"& .MuiTableCell-root":{py:1}},children:[(0,r.jsx)(v.Z,{children:(0,r.jsxs)(b.Z,{children:[(0,r.jsx)(f.Z,{children:"Qism nomi"}),(0,r.jsx)(f.Z,{children:"Status"}),(0,r.jsx)(f.Z,{children:"Bo‘lim"}),(0,r.jsx)(f.Z,{children:"Ijrochi"}),(0,r.jsx)(f.Z,{children:"Boshlanish"}),(0,r.jsx)(f.Z,{children:"Tugash"}),(0,r.jsx)(f.Z,{align:"right",children:"Amallar"})]})}),(0,r.jsx)(k.Z,{children:t.map(e=>{var t,s;let l=a===e.id;return(0,r.jsxs)(b.Z,{hover:!0,selected:l,onClick:()=>n(e.id),sx:{cursor:"pointer"},children:[(0,r.jsxs)(f.Z,{children:[(0,r.jsxs)(d.Z,{direction:"row",spacing:1,alignItems:"center",children:[(0,r.jsx)(I.Z,{icon:"mdi:subdirectory-arrow-right"}),(0,r.jsx)(u.Z,{variant:"body2",sx:{fontWeight:600},children:e.title||"Qism #".concat(e.id)})]}),!!e.note&&(0,r.jsx)(u.Z,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.5},children:e.note})]}),(0,r.jsx)(f.Z,{children:(0,r.jsx)(x.Z,{size:"small",label:e.status,color:i(e.status),variant:"outlined"})}),(0,r.jsx)(f.Z,{children:(null===(t=e.department_detail)||void 0===t?void 0:t.name)||e.department}),(0,r.jsx)(f.Z,{children:(null===(s=e.assignee_detail)||void 0===s?void 0:s.fullname)||e.assignee}),(0,r.jsx)(f.Z,{children:e.start_date||"—"}),(0,r.jsx)(f.Z,{children:e.end_date||"—"}),(0,r.jsx)(f.Z,{align:"right",onClick:e=>e.stopPropagation(),children:(0,r.jsx)(w.Z,{title:"Oʻchirish",children:(0,r.jsx)(_.Z,{size:"small",children:(0,r.jsx)(I.Z,{icon:"mdi:delete"})})})})]},e.id)})})]}):(0,r.jsx)(c.Z,{children:(0,r.jsx)(u.Z,{variant:"body2",color:"text.secondary",children:"Qismlar mavjud emas"})})]})})}var C=a(33934),P=a(14934),z=a(47407),S=a(19304),M=a(87590),q=a(32200),F=a(61769),T=a(21201);let A=e=>{let t=(e.title||"").trim();if(t)return t;let a=(e.file||"").trim();if(!a)return"Fayl #".concat(e.id);try{let e=a.split("?")[0],t=e.split("/");return decodeURIComponent(t[t.length-1]||e)}catch(e){return a}},L=e=>{let t=(e||"").toLowerCase().split("?")[0],a=t.split(".").pop();return a&&a!==t?a:""},R=e=>{switch(e){case"pdf":return"tabler:file-type-pdf";case"doc":case"docx":return"tabler:file-type-doc";case"xls":case"xlsx":return"tabler:file-type-xls";case"ppt":case"pptx":return"tabler:file-type-ppt";case"png":case"jpg":case"jpeg":case"webp":case"gif":return"tabler:photo";case"zip":case"rar":case"7z":return"tabler:archive";default:return"tabler:file"}};function W(e){let{taskId:t,partId:a}=e,{data:i,isLoading:l,isError:p}=(0,C.a)({queryKey:["task-attachments",t,null!=a?a:null],queryFn:async()=>{let e={task:t,perPage:50,...null!=a?{part:a}:{}};return(await j.Do.get(h.Z.taskAttachment,e)).data||{results:[]}},enabled:!!t,staleTime:1e4}),m=(null==i?void 0:i.results)||[];return l?(0,r.jsxs)(d.Z,{spacing:2,children:[(0,r.jsx)(P.Z,{variant:"text",width:"30%"}),(0,r.jsx)(P.Z,{variant:"rectangular",height:64,sx:{borderRadius:2}}),(0,r.jsx)(P.Z,{variant:"rectangular",height:64,sx:{borderRadius:2}}),(0,r.jsx)(P.Z,{variant:"rectangular",height:64,sx:{borderRadius:2}})]}):p?(0,r.jsx)(u.Z,{variant:"body2",color:"error",children:"Fayllarni yuklashda xatolik yuz berdi"}):m.length?(0,r.jsx)(o.Z,{children:(0,r.jsxs)(c.Z,{children:[(0,r.jsxs)(s.Z,{sx:{mb:2,display:"flex",alignItems:"center",justifyContent:"space-between",gap:2},children:[(0,r.jsx)(u.Z,{variant:"subtitle2",children:"Biriktirilgan fayllar"}),(0,r.jsx)(x.Z,{size:"small",color:"info",label:"".concat(m.length," ta")})]}),(0,r.jsx)(z.Z,{disablePadding:!0,children:m.map((e,t)=>{var a;let i=A(e),s=L(e.file||e.title),l=R(s),o=e.created_at?new Date(e.created_at).toLocaleString():"",c=e.file||"#";return(0,r.jsxs)(n.Fragment,{children:[(0,r.jsxs)(S.ZP,{disableGutters:!0,secondaryAction:c&&"#"!==c?(0,r.jsx)(w.Z,{title:"Ochish / yuklab olish",children:(0,r.jsx)(_.Z,{component:"a",href:c,target:"_blank",rel:"noreferrer",children:(0,r.jsx)(I.Z,{icon:"tabler:download"})})}):null,sx:{py:1.25,px:1,borderRadius:2,"&:hover":{backgroundColor:e=>e.palette.action.hover}},children:[(0,r.jsx)(M.Z,{children:(0,r.jsx)(T.Z,{variant:"rounded",sx:{width:40,height:40,bgcolor:e=>e.palette.action.selected,color:"text.primary"},children:(0,r.jsx)(I.Z,{icon:l})})}),(0,r.jsx)(q.Z,{primary:(0,r.jsxs)(d.Z,{direction:"row",spacing:1,sx:{alignItems:"center",flexWrap:"wrap",rowGap:1},children:[c&&"#"!==c?(0,r.jsx)(F.Z,{href:c,target:"_blank",rel:"noreferrer",underline:"hover",color:"inherit",children:(0,r.jsx)(u.Z,{variant:"subtitle2",sx:{fontWeight:600},children:i})}):(0,r.jsx)(u.Z,{variant:"subtitle2",sx:{fontWeight:600},children:i}),s?(0,r.jsx)(x.Z,{size:"small",variant:"outlined",label:s.toUpperCase()}):null,e.part?(0,r.jsx)(x.Z,{size:"small",variant:"outlined",label:"Qism #".concat(e.part)}):null]}),secondary:(0,r.jsxs)(d.Z,{direction:"row",spacing:1,sx:{alignItems:"center",flexWrap:"wrap",rowGap:.5},children:[o?(0,r.jsx)(u.Z,{variant:"caption",color:"text.secondary",children:o}):null,"number"==typeof e.uploaded_by?(0,r.jsxs)(u.Z,{variant:"caption",color:"text.secondary",children:["• Yuklovchi: #",e.uploaded_by]}):null]})})]}),t<m.length-1?(0,r.jsx)(y.Z,{sx:{my:1}}):null]},null!==(a=e.id)&&void 0!==a?a:t)})})]})}):(0,r.jsx)(o.Z,{children:(0,r.jsx)(c.Z,{children:(0,r.jsx)(s.Z,{sx:{py:2},children:(0,r.jsx)(u.Z,{variant:"body2",color:"text.secondary",children:"Biriktirilgan fayllar yo‘q"})})})})}let D=e=>{var t,a;let r=(e||"").trim();if(!r)return"?";let n=r.split(" ").filter(Boolean);return(((null===(t=n[0])||void 0===t?void 0:t[0])||"")+((null===(a=n[1])||void 0===a?void 0:a[0])||"")).toUpperCase()||r[0].toUpperCase()};function O(e){let{taskId:t,partId:a}=e,{data:i,isLoading:l,isError:p}=(0,C.a)({queryKey:["task-comments",t,null!=a?a:null],queryFn:async()=>{let e={task:t,perPage:50};return null!=a&&(e.part=a),(await j.Do.get(h.Z.taskComment,e)).data||{results:[]}},enabled:!!t,staleTime:1e4}),m=(null==i?void 0:i.results)||[];return l?(0,r.jsxs)(d.Z,{spacing:2,children:[(0,r.jsx)(P.Z,{variant:"text",width:"25%"}),(0,r.jsx)(P.Z,{variant:"rectangular",height:72,sx:{borderRadius:2}}),(0,r.jsx)(P.Z,{variant:"rectangular",height:72,sx:{borderRadius:2}}),(0,r.jsx)(P.Z,{variant:"rectangular",height:72,sx:{borderRadius:2}})]}):p?(0,r.jsx)(u.Z,{variant:"body2",color:"error",children:"Kommentlarni yuklashda xatolik yuz berdi"}):m.length?(0,r.jsx)(o.Z,{children:(0,r.jsxs)(c.Z,{children:[(0,r.jsxs)(s.Z,{sx:{mb:2,display:"flex",alignItems:"center",justifyContent:"space-between",gap:2},children:[(0,r.jsx)(u.Z,{variant:"subtitle2",children:"Kommentariyalar"}),(0,r.jsx)(x.Z,{size:"small",color:"info",label:"".concat(m.length," ta")})]}),(0,r.jsx)(z.Z,{disablePadding:!0,children:m.map((e,t)=>{var a,i;let s=e.created_at?new Date(e.created_at).toLocaleString():"",l=e.is_system?"System":"".concat(null===(a=e.author_detail)||void 0===a?void 0:a.fullname);return(0,r.jsxs)(n.Fragment,{children:[(0,r.jsxs)(S.ZP,{disableGutters:!0,alignItems:"flex-start",sx:{py:1.25,px:1,borderRadius:2,"&:hover":{backgroundColor:e=>e.palette.action.hover}},children:[(0,r.jsx)(M.Z,{children:(0,r.jsx)(T.Z,{sx:{width:40,height:40,bgcolor:t=>e.is_system?t.palette.grey[200]:t.palette.primary.light,color:t=>e.is_system?t.palette.text.primary:t.palette.primary.contrastText},children:e.is_system?(0,r.jsx)(I.Z,{icon:"tabler:settings"}):D(l)})}),(0,r.jsx)(q.Z,{primary:(0,r.jsxs)(d.Z,{direction:"row",spacing:1,sx:{alignItems:"center",flexWrap:"wrap",rowGap:1},children:[(0,r.jsx)(u.Z,{variant:"subtitle2",sx:{fontWeight:700},children:l}),e.is_system?(0,r.jsx)(x.Z,{size:"small",color:"default",variant:"outlined",label:"System"}):null,e.part?(0,r.jsx)(x.Z,{size:"small",variant:"outlined",label:"Qism #".concat(e.part)}):null,s?(0,r.jsxs)(u.Z,{variant:"caption",sx:{color:"text.disabled"},children:["• ",s]}):null]}),secondary:(0,r.jsx)(u.Z,{variant:"body2",color:"text.secondary",sx:{mt:.5,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:e.text||"—"})})]}),t<m.length-1?(0,r.jsx)(y.Z,{sx:{my:1}}):null]},null!==(i=e.id)&&void 0!==i?i:t)})})]})}):(0,r.jsx)(o.Z,{children:(0,r.jsx)(c.Z,{children:(0,r.jsx)(u.Z,{variant:"body2",color:"text.secondary",children:"Hozircha komment yo‘q"})})})}function E(e){var t,a,n,i,p,m,Z;let{task:v,selectedPartId:b,setSelectedPartId:f}=e,k=(0,g.Z)(),w=null==v?void 0:v.id,{data:_}=(0,C.a)({queryKey:["task-parts",null!=w?w:"none"],enabled:!!w,queryFn:async()=>{let e=(await j.Do.get(h.Z.taskPart,{task:String(w),perPage:100})).data;return(null==e?void 0:e.results)||e||[]},initialData:[]});if(!v)return(0,r.jsx)(o.Z,{children:(0,r.jsx)(c.Z,{children:(0,r.jsx)(u.Z,{variant:"body2",color:"text.secondary",children:"Task ma’lumotlari topilmadi."})})});let I=e=>{let{label:t,value:a}=e;return(0,r.jsxs)(d.Z,{spacing:.75,children:[(0,r.jsx)(u.Z,{variant:"caption",color:"text.secondary",children:t}),(0,r.jsx)(u.Z,{variant:"body2",sx:{wordBreak:"break-word"},children:null!=a?a:"—"})]})};return(0,r.jsxs)(l.ZP,{container:!0,spacing:4,children:[(0,r.jsx)(l.ZP,{item:!0,xs:12,children:(0,r.jsx)(o.Z,{children:(0,r.jsxs)(c.Z,{children:[(0,r.jsxs)(d.Z,{direction:"row",justifyContent:"space-between",alignItems:"flex-start",spacing:3,children:[(0,r.jsxs)(s.Z,{sx:{minWidth:0},children:[(0,r.jsx)(u.Z,{variant:"overline",color:"text.secondary",children:"Hujjat (Task)"}),(0,r.jsx)(u.Z,{variant:"h6",sx:{mt:.5,lineHeight:1.35},children:v.name||"Task #".concat(v.id)}),(0,r.jsxs)(u.Z,{variant:"body2",color:"text.secondary",sx:{mt:1},children:["ID: ",v.id]})]}),(0,r.jsxs)(d.Z,{direction:"row",spacing:1,flexWrap:"wrap",justifyContent:"flex-end",children:[v.status&&(0,r.jsx)(x.Z,{size:"small",label:v.status,color:(e=>{switch(e){case"new":default:return"default";case"in_progress":return"info";case"on_review":case"returned":return"warning";case"done":return"success";case"cancelled":return"error"}})(v.status)}),v.priority&&(0,r.jsx)(x.Z,{size:"small",label:v.priority,color:"orgently"===v.priority?"error":"default",variant:"outlined"}),v.type&&(0,r.jsx)(x.Z,{size:"small",label:v.type,color:"primary",variant:"outlined"})]})]}),(0,r.jsx)(y.Z,{sx:{my:3}}),(0,r.jsxs)(l.ZP,{container:!0,spacing:3,children:[(0,r.jsx)(l.ZP,{item:!0,xs:12,md:4,children:(0,r.jsx)(I,{label:"Kirish raqami",value:v.input_doc_number})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,md:4,children:(0,r.jsx)(I,{label:"Chiqish raqami",value:v.output_doc_number})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,md:4,children:(0,r.jsx)(I,{label:"Yuboruvchi tashkilot",value:v.sending_org})})]})]})})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,md:6,children:(0,r.jsx)(o.Z,{children:(0,r.jsxs)(c.Z,{children:[(0,r.jsx)(u.Z,{variant:"subtitle1",sx:{mb:2},children:"Asosiy ma’lumotlar"}),(0,r.jsxs)(l.ZP,{container:!0,spacing:3,children:[(0,r.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(I,{label:"Kompaniya",value:(null===(t=v.company_detail)||void 0===t?void 0:t.name)||v.company})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(I,{label:"Bo‘lim",value:(null===(a=v.department_detail)||void 0===a?void 0:a.name)||v.department})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(I,{label:"Hujjat shakli",value:(null===(n=v.task_form_detail)||void 0===n?void 0:n.name)||v.task_form})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(I,{label:"Jurnal",value:(null===(i=v.list_of_magazine_detail)||void 0===i?void 0:i.name)||v.list_of_magazine})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(I,{label:"Imzolovchi",value:(null===(p=v.signed_by_detail)||void 0===p?void 0:p.fullname)||v.signed_by})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(I,{label:"Mas’ul shaxs",value:null!==(m=v.sending_respon_person)&&void 0!==m?m:"—"})})]})]})})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,md:6,children:(0,r.jsx)(o.Z,{children:(0,r.jsxs)(c.Z,{children:[(0,r.jsx)(u.Z,{variant:"subtitle1",sx:{mb:2},children:"Muddatlar"}),(0,r.jsxs)(l.ZP,{container:!0,spacing:3,children:[(0,r.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(I,{label:"Boshlanish sanasi",value:v.start_date})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(I,{label:"Tugash sanasi",value:v.end_date})})]}),(0,r.jsx)(y.Z,{sx:{my:3}}),(0,r.jsx)(u.Z,{variant:"subtitle1",sx:{mb:2},children:"Tizim ma’lumotlari"}),(0,r.jsxs)(l.ZP,{container:!0,spacing:3,children:[(0,r.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(I,{label:"Yaratilgan vaqt",value:v.created_time})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(I,{label:"Yangilangan vaqt",value:v.updated_time})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(I,{label:"Yaratgan (created_by)",value:v.created_by})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(I,{label:"Yangilagan (updated_by)",value:null!==(Z=v.updated_by)&&void 0!==Z?Z:"—"})})]})]})})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,children:(0,r.jsx)(o.Z,{children:(0,r.jsxs)(c.Z,{children:[(0,r.jsx)(u.Z,{variant:"subtitle1",sx:{mb:2},children:"Izoh"}),(0,r.jsx)(s.Z,{sx:{p:2.5,background:k.palette.background.paper},children:(0,r.jsx)(u.Z,{variant:"body2",sx:{whiteSpace:"pre-wrap"},children:v.note||"—"})})]})})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,children:(0,r.jsx)(B,{parts:_,selectedPartId:b,setSelectedPartId:f})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,children:(0,r.jsx)(W,{taskId:v.id,partId:null!=b?b:void 0})}),(0,r.jsx)(l.ZP,{item:!0,xs:12,children:(0,r.jsx)(O,{taskId:v.id,partId:null!=b?b:void 0})})]})}var Q=a(1954),K=a(73907),H=a(33453),J=a(92365),Y=a(40110),G=a(96727),N=a(86501),X=a(30202),U=a(7879),V=a(34273),$=e=>{let{task:t,part:a}=e,i=(0,X.NL)(),{user:s}=(0,V.a)(),[l,p]=n.useState(!1),[m,g]=n.useState(!1),[Z,v]=n.useState(""),[b,f]=n.useState(""),[k,w]=n.useState(null),[_,I]=n.useState(!1),B=null==t?void 0:t.id,C=null==a?void 0:a.id,P=C?"Qism #".concat(C):B?"Task #".concat(B):"—",z=()=>{v("")},S=()=>{f(""),w(null)},M=async()=>{B&&await i.invalidateQueries({queryKey:["task-comments"]})},q=async()=>{B&&await i.invalidateQueries({queryKey:["task-attachments"]})},F=async()=>{if(!B)return;let e=Z.trim();if(!e){N.ZP.error("Izoh matnini kiriting");return}try{I(!0),await j.Do.post(h.Z.taskComment,{task:B,part:null!=C?C:null,author:null==s?void 0:s.id,text:e}),N.ZP.success("Izoh qo‘shildi"),p(!1),z(),await M()}catch(e){console.error("Failed to create comment",e),N.ZP.error("Izoh qo‘shishda xatolik")}finally{I(!1)}},T=async()=>{if(B){if(!k){N.ZP.error("Fayl tanlang");return}try{I(!0);let e=new FormData;e.append("file",k),e.append("title",b.trim()||k.name),e.append("task",B.toString()),e.append("part",C?C.toString():""),await j.Do.postForm(h.Z.taskAttachment,e),N.ZP.success("Fayl biriktirildi"),g(!1),S(),await q()}catch(e){console.error("Failed to create attachment",e),N.ZP.error("Fayl biriktirishda xatolik")}finally{I(!1)}}};return(0,r.jsx)(o.Z,{sx:{position:{md:"sticky"},top:{md:24}},children:(0,r.jsxs)(c.Z,{children:[(0,r.jsxs)(d.Z,{spacing:2,children:[(0,r.jsx)(u.Z,{variant:"subtitle1",children:"Amallar"}),(0,r.jsx)(y.Z,{}),(0,r.jsxs)(d.Z,{spacing:1,children:[(0,r.jsx)(u.Z,{variant:"caption",color:"text.secondary",children:"Tanlangan qism"}),C?(0,r.jsxs)(d.Z,{spacing:1,children:[(0,r.jsxs)(d.Z,{direction:"row",spacing:1,alignItems:"center",flexWrap:"wrap",useFlexGap:!0,children:[(0,r.jsx)(x.Z,{size:"small",icon:(0,r.jsx)(Q.JO,{icon:"mdi:subdirectory-arrow-right"}),label:"Qism #".concat(C),variant:"outlined"}),(null==a?void 0:a.title)?(0,r.jsx)(x.Z,{size:"small",label:a.title,variant:"outlined"}):null,(null==a?void 0:a.status)?(0,r.jsx)(x.Z,{size:"small",label:a.status,color:"info",variant:"outlined"}):null]}),(0,r.jsx)(u.Z,{variant:"body2",color:"text.secondary",children:"Izoh va fayllar shu qismga qo‘shiladi."})]}):(0,r.jsxs)(d.Z,{spacing:.5,children:[(0,r.jsx)(u.Z,{variant:"body2",children:"Qism tanlanmagan"}),(0,r.jsx)(u.Z,{variant:"body2",color:"text.secondary",children:"Izoh va fayllar task’ning o‘ziga qo‘shiladi."})]})]}),(0,r.jsx)(y.Z,{}),(0,r.jsxs)(d.Z,{spacing:1,children:[(0,r.jsx)(u.Z,{variant:"caption",color:"text.secondary",children:"Muddat"}),(0,r.jsxs)(d.Z,{direction:"row",spacing:1,alignItems:"center",children:[(0,r.jsx)(Q.JO,{icon:"mdi:calendar"}),(0,r.jsx)(u.Z,{variant:"body2",children:(null==t?void 0:t.end_date)||"Belgilanmagan"})]}),(0,r.jsx)(K.Z,{size:"small",variant:"outlined",children:"Muddati belgilash"})]}),(0,r.jsx)(y.Z,{}),C&&(0,r.jsxs)(d.Z,{spacing:1,children:[(0,r.jsx)(u.Z,{variant:"caption",color:"text.secondary",children:"Qism holati"}),(0,r.jsxs)(d.Z,{direction:"row",spacing:1,alignItems:"center",children:[(0,r.jsx)(Q.JO,{icon:"mdi:subdirectory-arrow-right"}),(0,r.jsx)(u.Z,{variant:"body2",children:(null==a?void 0:a.status)||"Belgilanmagan"})]}),(0,r.jsxs)(d.Z,{direction:"row",spacing:1,children:[(0,r.jsx)(K.Z,{size:"small",variant:"contained",children:"Boshlash"}),(0,r.jsx)(K.Z,{size:"small",variant:"outlined",children:"Yakunlash"})]})]}),(0,r.jsx)(y.Z,{}),(0,r.jsxs)(d.Z,{spacing:1,children:[(0,r.jsx)(u.Z,{variant:"caption",color:"text.secondary",children:"Fayllar"}),(0,r.jsx)(d.Z,{direction:"row",spacing:1,children:(0,r.jsx)(K.Z,{size:"small",startIcon:(0,r.jsx)(Q.JO,{icon:"mdi:paperclip"}),variant:"outlined",disabled:!B,onClick:()=>g(!0),children:"Fayl qo'shish"})})]}),(0,r.jsx)(y.Z,{}),(0,r.jsxs)(d.Z,{spacing:1,children:[(0,r.jsx)(u.Z,{variant:"caption",color:"text.secondary",children:"Izohlar"}),(0,r.jsx)(K.Z,{size:"small",startIcon:(0,r.jsx)(Q.JO,{icon:"mdi:comment"}),variant:"outlined",disabled:!B,onClick:()=>p(!0),children:"Izoh qo'shish"})]})]}),(0,r.jsxs)(H.Z,{open:l,onClose:_?void 0:()=>p(!1),fullWidth:!0,maxWidth:"sm",children:[(0,r.jsxs)(J.Z,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,r.jsx)(Q.JO,{icon:"mdi:comment"}),"Izoh qo‘shish (",P,")"]}),(0,r.jsx)(Y.Z,{children:(0,r.jsx)(U.Z,{autoFocus:!0,fullWidth:!0,minRows:4,multiline:!0,label:"Xabar",placeholder:"Izoh… yozing",value:Z,onChange:e=>v(e.target.value),disabled:_,sx:{mt:1}})}),(0,r.jsxs)(G.Z,{children:[(0,r.jsx)(K.Z,{variant:"text",color:"secondary",disabled:_,onClick:()=>{p(!1),z()},children:"Bekor qilish"}),(0,r.jsx)(K.Z,{variant:"contained",disabled:_,onClick:F,children:"Yuborish"})]})]}),(0,r.jsxs)(H.Z,{open:m,onClose:_?void 0:()=>g(!1),fullWidth:!0,maxWidth:"sm",children:[(0,r.jsxs)(J.Z,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,r.jsx)(Q.JO,{icon:"mdi:paperclip"}),"Fayl biriktirish (",P,")"]}),(0,r.jsx)(Y.Z,{children:(0,r.jsxs)(d.Z,{spacing:2,sx:{mt:1},children:[(0,r.jsx)(U.Z,{fullWidth:!0,label:"Sarlavha (ixtiyoriy)",value:b,onChange:e=>f(e.target.value),disabled:_}),(0,r.jsxs)(K.Z,{component:"label",variant:"outlined",disabled:_,startIcon:(0,r.jsx)(Q.JO,{icon:"mdi:file-upload"}),children:["Fayl tanlash",(0,r.jsx)("input",{hidden:!0,type:"file",onChange:e=>{var t;return w((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)}})]}),k?(0,r.jsx)(d.Z,{direction:"row",spacing:1,alignItems:"center",children:(0,r.jsx)(x.Z,{icon:(0,r.jsx)(Q.JO,{icon:"mdi:file"}),label:k.name,variant:"outlined",onDelete:_?void 0:()=>w(null)})}):null]})}),(0,r.jsxs)(G.Z,{children:[(0,r.jsx)(K.Z,{variant:"text",color:"secondary",disabled:_,onClick:()=>{g(!1),S()},children:"Bekor qilish"}),(0,r.jsx)(K.Z,{variant:"contained",disabled:_,onClick:T,children:"Biriktirish"})]})]})]})})},ee=a(77527),et=a(36599),ea=a(87413),er=a(9601),en=a(72162),ei=a(17494),es=a(51221);let el=(0,ee.ZP)(et.Z)({"& .MuiTimelineItem-root":{width:"100%","&:before":{display:"none"}}}),eo=e=>{switch(e){case"assigned":case"status_changed":return"info";case"part_created":case"task_created":return"primary";case"commented":case"file_added":case"part_returned":case"task_returned":return"warning";case"part_completed":case"task_completed":return"success";case"part_cancelled":case"task_cancelled":return"error";default:return"grey"}};function ec(e){let{id:t}=e,{data:a=[],isLoading:n}=(0,C.a)({queryKey:["task-events",t],queryFn:async()=>{var e;return(null===(e=(await j.Do.get(h.Z.taskEvent,{task:t,perPage:50})).data)||void 0===e?void 0:e.results)||[]},staleTime:1e4});return(0,r.jsx)(o.Z,{children:(0,r.jsxs)(c.Z,{children:[(0,r.jsx)(u.Z,{variant:"subtitle2",sx:{mb:2},children:"Amalga oshirish jarayoni"}),n?(0,r.jsxs)(d.Z,{spacing:2,children:[(0,r.jsx)(P.Z,{variant:"text",width:"40%"}),(0,r.jsx)(P.Z,{variant:"rectangular",height:64,sx:{borderRadius:2}}),(0,r.jsx)(P.Z,{variant:"rectangular",height:64,sx:{borderRadius:2}}),(0,r.jsx)(P.Z,{variant:"rectangular",height:64,sx:{borderRadius:2}})]}):a.length?(0,r.jsx)(el,{children:a.map(e=>{var t;return(0,r.jsxs)(ea.Z,{children:[(0,r.jsxs)(er.Z,{children:[(0,r.jsx)(ei.Z,{color:eo(e.event_type),variant:"outlined"}),(0,r.jsx)(es.Z,{})]}),(0,r.jsx)(en.Z,{sx:{"& svg":{verticalAlign:"bottom",mx:4}},children:(0,r.jsxs)(s.Z,{sx:{mb:1.5,display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsxs)(u.Z,{variant:"subtitle1",sx:{mr:2},children:[(null===(t=e.actor_detail)||void 0===t?void 0:t.fullname)||"—"," — ",e.message||e.event_type]}),(0,r.jsx)(u.Z,{variant:"caption",sx:{color:"text.disabled"},children:e.created_time?new Date(e.created_time).toLocaleString():""})]})})]},e.id)})}):(0,r.jsx)(u.Z,{variant:"body2",color:"text.secondary",children:"Hech qanday jarayon elementi yoʻq"})]})})}var ed=a(89540),eu=a(69447),ex=a(54560);let ep=(0,ee.ZP)(et.Z)(e=>{let{theme:t}=e;return{"& .MuiTimelineItem-root:nth-of-type(even) .MuiTimelineContent-root":{textAlign:"left"},[t.breakpoints.down("md")]:{"& .MuiTimelineItem-root":{width:"100%","&:before":{display:"none"}}}}}),em=e=>{switch(e){case"assigned":case"status_changed":return"info";case"part_created":case"task_created":return"primary";case"commented":case"file_added":case"part_returned":case"task_returned":return"warning";case"part_completed":case"task_completed":return"success";case"part_cancelled":case"task_cancelled":return"error";default:return"grey"}},eh=e=>{switch(e){case"assigned":return"tabler:user-check";case"part_created":return"tabler:subtask";case"file_added":return"tabler:paperclip";case"commented":return"tabler:message-circle";case"task_created":return"tabler:file-plus";case"status_changed":return"tabler:refresh";case"part_completed":case"task_completed":return"tabler:circle-check";case"part_returned":case"task_returned":return"tabler:arrow-back-up";case"part_cancelled":case"task_cancelled":return"tabler:circle-x";default:return"tabler:info-circle"}};var ej=e=>{let{id:t}=e,{data:a=[],isLoading:n}=(0,C.a)({queryKey:["task-events",t],queryFn:async()=>{var e;return(null===(e=(await j.Do.get(h.Z.taskEvent,{task:t,perPage:50})).data)||void 0===e?void 0:e.results)||[]},staleTime:1e4}),{settings:i}=(0,ex.r)(),l=(0,ed.Z)(e=>e.breakpoints.down("md")),{direction:p}=i;return n?(0,r.jsxs)(d.Z,{spacing:2,children:[(0,r.jsx)(P.Z,{variant:"text",width:"40%"}),(0,r.jsx)(P.Z,{variant:"rectangular",height:64,sx:{borderRadius:2}}),(0,r.jsx)(P.Z,{variant:"rectangular",height:64,sx:{borderRadius:2}}),(0,r.jsx)(P.Z,{variant:"rectangular",height:64,sx:{borderRadius:2}})]}):(0,r.jsx)(o.Z,{children:(0,r.jsx)(c.Z,{children:(0,r.jsx)(ep,{position:l?"right":"alternate",children:a.length?a.map((e,t)=>{var a,n,i,l,o,c,p;let m=eh(e.event_type),h=em(e.event_type),j=(null===(a=e.actor_detail)||void 0===a?void 0:a.fullname)||"—",g=e.message||e.event_type,y=e.created_time?new Date(e.created_time).toLocaleString():"";return(0,r.jsxs)(ea.Z,{children:[(0,r.jsxs)(er.Z,{children:[(0,r.jsx)(eu.Z,{skin:"light",color:h,children:(0,r.jsx)(I.Z,{icon:m,fontSize:20})}),(0,r.jsx)(es.Z,{})]}),(0,r.jsxs)(en.Z,{sx:{"& svg":{verticalAlign:"bottom",mx:1}},children:[(0,r.jsxs)(s.Z,{sx:{mb:1,display:"flex",gap:2,flexWrap:"wrap",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsxs)(u.Z,{variant:"subtitle1",sx:{mr:2},children:[j," — ",g]}),(0,r.jsx)(u.Z,{variant:"caption",sx:{color:"text.disabled"},children:y})]}),(0,r.jsxs)(d.Z,{direction:"row",spacing:1,sx:{flexWrap:"wrap",rowGap:1},children:[(null===(n=e.part_detail)||void 0===n?void 0:n.title)?(0,r.jsx)(x.Z,{size:"small",label:"Qism: ".concat(e.part_detail.title)}):null,(null===(l=e.part_detail)||void 0===l?void 0:null===(i=l.department_detail)||void 0===i?void 0:i.name)?(0,r.jsx)(x.Z,{size:"small",label:"Bo'lim: ".concat(e.part_detail.department_detail.name)}):null,(null===(c=e.part_detail)||void 0===c?void 0:null===(o=c.assignee_detail)||void 0===o?void 0:o.fullname)?(0,r.jsx)(x.Z,{size:"small",label:"Ijrochi: ".concat(e.part_detail.assignee_detail.fullname)}):null,null]})]})]},null!==(p=e.id)&&void 0!==p?p:t)}):(0,r.jsx)(s.Z,{sx:{py:2},children:(0,r.jsx)(u.Z,{variant:"body2",color:"text.secondary",children:"Hech qanday jarayon elementi yoʻq"})})})})})},eg=()=>{let{id:e}=(0,i.useRouter)().query,[t,a]=(0,n.useState)(0),[g,y]=(0,n.useState)(),[Z,v]=(0,n.useState)(void 0);(0,n.useEffect)(()=>{!e||Array.isArray(e)||(async()=>{try{let t=await j.Do.get(h.Z.taskById(e));y(t.data)}catch(e){console.error("Failed to fetch task",e)}})()},[e]);let{data:b}=(0,C.a)({queryKey:["task-part",Z],enabled:!!Z,queryFn:async()=>(await j.Do.get(h.Z.taskPartById(Z))).data});return(0,r.jsx)(s.Z,{sx:{p:4},children:(0,r.jsxs)(l.ZP,{container:!0,spacing:4,children:[(0,r.jsxs)(l.ZP,{item:!0,xs:12,md:8,lg:9,children:[(0,r.jsx)(o.Z,{children:(0,r.jsxs)(c.Z,{children:[(0,r.jsxs)(d.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,r.jsx)(u.Z,{variant:"h6",children:g?"Task: #".concat(g.id," | ").concat(g.name):"Task"}),(0,r.jsxs)(d.Z,{direction:"row",spacing:1,children:[(0,r.jsx)(x.Z,{label:"Status: ".concat((null==g?void 0:g.status)||"—"),size:"small"}),(0,r.jsx)(x.Z,{label:"Prioritet: ".concat((null==g?void 0:g.priority)||"—"),size:"small"}),(null==g?void 0:g.end_date)&&(0,r.jsx)(x.Z,{label:"Muddat: ".concat(g.end_date),size:"small"})]})]}),(0,r.jsxs)(p.Z,{value:t,onChange:(e,t)=>a(t),sx:{mt:2},variant:"scrollable",scrollButtons:"auto",children:[(0,r.jsx)(m.Z,{label:"Hujjat"}),(0,r.jsx)(m.Z,{label:"Vazifalar tarixi"}),(0,r.jsx)(m.Z,{label:"Amalga oshirish jarayoni"})]})]})}),(0,r.jsxs)(s.Z,{sx:{mt:3},children:[0===t&&(0,r.jsx)(E,{task:g,selectedPartId:null!=Z?Z:void 0,setSelectedPartId:v}),1===t&&(0,r.jsx)(ec,{id:e}),2===t&&(0,r.jsx)(ej,{id:e})]})]}),(0,r.jsx)(l.ZP,{item:!0,xs:12,md:4,lg:3,children:(0,r.jsx)($,{task:g,part:b})})]})})};function ey(){return(0,r.jsx)(eg,{})}}},function(e){e.O(0,[2712,3035,7008,4468,5889,2888,9774,179],function(){return e(e.s=94487)}),_N_E=e.O()}]);