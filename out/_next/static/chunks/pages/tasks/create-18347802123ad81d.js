(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[365],{13264:function(e,r,t){"use strict";let n=(0,t(70182).ZP)();r.Z=n},66243:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tasks/create",function(){return t(90600)}])},71919:function(e,r,t){"use strict";t.d(r,{Z:function(){return x}});var n=t(87462),o=t(63366),i=t(67294),a=t(86010),l=t(94780),s=t(77527),d=t(29567),u=t(1588),m=t(34867);function c(e){return(0,m.Z)("MuiCardContent",e)}(0,u.Z)("MuiCardContent",["root"]);var v=t(85893);let p=["className","component"],g=e=>{let{classes:r}=e;return(0,l.Z)({root:["root"]},c,r)},h=(0,s.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,r)=>r.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}}));var x=i.forwardRef(function(e,r){let t=(0,d.Z)({props:e,name:"MuiCardContent"}),{className:i,component:l="div"}=t,s=(0,o.Z)(t,p),u=(0,n.Z)({},t,{component:l}),m=g(u);return(0,v.jsx)(h,(0,n.Z)({as:l,className:(0,a.Z)(m.root,i),ownerState:u,ref:r},s))})},34375:function(e,r,t){"use strict";t.d(r,{Z:function(){return y}});var n=t(63366),o=t(87462),i=t(67294),a=t(86010),l=t(94780),s=t(96788),d=t(29567),u=t(77527),m=t(1588),c=t(34867);function v(e){return(0,c.Z)("MuiCardHeader",e)}let p=(0,m.Z)("MuiCardHeader",["root","avatar","action","content","title","subheader"]);var g=t(85893);let h=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],x=e=>{let{classes:r}=e;return(0,l.Z)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},v,r)},Z=(0,u.ZP)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,r)=>(0,o.Z)({["& .".concat(p.title)]:r.title,["& .".concat(p.subheader)]:r.subheader},r.root)})({display:"flex",alignItems:"center",padding:16}),f=(0,u.ZP)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,r)=>r.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),j=(0,u.ZP)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,r)=>r.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),b=(0,u.ZP)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,r)=>r.content})({flex:"1 1 auto"});var y=i.forwardRef(function(e,r){let t=(0,d.Z)({props:e,name:"MuiCardHeader"}),{action:i,avatar:l,className:u,component:m="div",disableTypography:c=!1,subheader:v,subheaderTypographyProps:p,title:y,titleTypographyProps:S}=t,_=(0,n.Z)(t,h),q=(0,o.Z)({},t,{component:m,disableTypography:c}),w=x(q),k=y;null==k||k.type===s.Z||c||(k=(0,g.jsx)(s.Z,(0,o.Z)({variant:l?"body2":"h5",className:w.title,component:"span",display:"block"},S,{children:k})));let C=v;return null==C||C.type===s.Z||c||(C=(0,g.jsx)(s.Z,(0,o.Z)({variant:l?"body2":"body1",className:w.subheader,color:"text.secondary",component:"span",display:"block"},p,{children:C}))),(0,g.jsxs)(Z,(0,o.Z)({className:(0,a.Z)(w.root,u),as:m,ref:r,ownerState:q},_,{children:[l&&(0,g.jsx)(f,{className:w.avatar,ownerState:q,children:l}),(0,g.jsxs)(b,{className:w.content,ownerState:q,children:[k,C]}),i&&(0,g.jsx)(j,{className:w.action,ownerState:q,children:i})]}))})},90600:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return M}});var n=t(85893),o=t(60762),i=t(34375),a=t(71919),l=t(68573),s=t(46070),d=t(84166),u=t(73907),m=t(87536),c=t(47533),v=t(16310),p=t(7879),g=t(74538),h=t(52293),x=t(58898),Z=t(11163);t(5843);var f=t(81342),j=t(33251),b=t(9198),y=t.n(b),S=t(34273),_=t(22120);let q=e=>String(e).padStart(2,"0"),w=e=>"".concat(e.getFullYear(),"-").concat(q(e.getMonth()+1),"-").concat(q(e.getDate()),"T").concat(q(e.getHours()),":").concat(q(e.getMinutes())),k=e=>{if(!e)return null;if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[r,t,n]=e.split("-").map(Number);return new Date(r,(t||1)-1,n||1,0,0,0,0)}let r=new Date(e);return Number.isNaN(r.getTime())?null:r},C={status:"new",type:"task",name:"",task_form:void 0,sending_org:void 0,input_doc_number:"",output_doc_number:"",start_date:"",end_date:"",priority:"ordinary",department:void 0,signed_by:void 0,note:"",list_of_magazine:void 0},T=e=>v.Ry({type:v.Z_().oneOf(["task","application"]).required(String(e("errors.required"))),name:v.Z_().min(2,String(e("errors.minChars",{count:2}))).required(String(e("errors.required"))),task_form:v.Rx().typeError(String(e("errors.select"))).required(String(e("errors.required"))),sending_org:v.Rx().required(String(e("errors.required"))),input_doc_number:v.Z_().required(String(e("errors.required"))),output_doc_number:v.Z_().required(String(e("errors.required"))),start_date:v.Z_().required(String(e("errors.required"))),end_date:v.Z_().optional().default("").test("end-after-start",String(e("errors.endAfterStart")),function(e){let{start_date:r}=this.parent;return!r||!e||new Date(e)>=new Date(r)}),priority:v.Z_().oneOf(["ordinary","orgently"]).required(String(e("errors.required"))),department:v.Rx().required(String(e("errors.required"))),note:v.Z_().required(String(e("errors.required"))),list_of_magazine:v.Rx().required(String(e("errors.required"))),signed_by:v.Rx().required(String(e("errors.required")))});var P=()=>{let{t:e}=(0,_.$G)(),r=T(e),{control:t,handleSubmit:i}=(0,m.cI)({defaultValues:C,resolver:(0,c.X)(r)}),v=(0,x.Z)(),b=(0,Z.useRouter)(),{user:q}=(0,S.a)(),{data:P}=(0,j.z)(g.Z.department,{page:1,limit:100}),{data:M}=(0,j.z)(g.Z.users,{page:1,limit:100,roles__name:"Signatory"}),{data:N}=(0,j.z)(g.Z.documentForm,{page:1,limit:100}),D=N||[],{data:O}=(0,j.z)(g.Z.listOfMagazine,{page:1,limit:100}),R=e=>"string"==typeof e?e:void 0,H=async r=>{try{var t;let n=await h.Do.post(g.Z.task,{...r,company:null==q?void 0:q.company_id}),o=null===(t=n.data)||void 0===t?void 0:t.id;v.success(String(e("tasks.toast.created"))),o?b.push("/tasks/update/".concat(o)):b.push("/tasks")}catch(r){v.error((null==r?void 0:r.message)||String(e("tasks.toast.createError")))}};return(0,n.jsx)(o.Z,{children:(0,n.jsx)(a.Z,{children:(0,n.jsx)(f.Z,{children:(0,n.jsx)("form",{onSubmit:i(H),children:(0,n.jsxs)(l.ZP,{container:!0,spacing:4,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(m.Qr,{name:"type",control:t,render:r=>{let{field:t,fieldState:o}=r,i=[{value:"task",label:String(e("tasks.type.task"))},{value:"application",label:String(e("tasks.type.application"))}];return(0,n.jsx)(s.Z,{options:i,value:i.find(e=>e.value===t.value)||null,onChange:(e,r)=>t.onChange((null==r?void 0:r.value)||""),isOptionEqualToValue:(e,r)=>e.value===r.value,getOptionLabel:e=>e.label,renderInput:r=>{var t;return(0,n.jsx)(p.Z,{...r,fullWidth:!0,label:String(e("tasks.form.type")),error:!!o.error,helperText:R(null===(t=o.error)||void 0===t?void 0:t.message)})}})}})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(m.Qr,{name:"priority",control:t,render:r=>{let{field:t,fieldState:o}=r,i=[{value:"ordinary",label:String(e("tasks.priority.ordinary"))},{value:"orgently",label:String(e("tasks.priority.orgently"))}];return(0,n.jsx)(s.Z,{options:i,value:i.find(e=>e.value===t.value)||null,onChange:(e,r)=>t.onChange((null==r?void 0:r.value)||""),isOptionEqualToValue:(e,r)=>e.value===r.value,getOptionLabel:e=>e.label,renderInput:r=>{var t;return(0,n.jsx)(p.Z,{...r,fullWidth:!0,label:String(e("tasks.form.priority")),error:!!o.error,helperText:R(null===(t=o.error)||void 0===t?void 0:t.message)})}})}})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(m.Qr,{name:"name",control:t,rules:{required:String(e("errors.required"))},render:r=>{var t;let{field:o,fieldState:i}=r;return(0,n.jsx)(p.Z,{fullWidth:!0,label:String(e("tasks.form.name")),...o,error:!!i.error,helperText:R(null===(t=i.error)||void 0===t?void 0:t.message)})}})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(m.Qr,{name:"task_form",control:t,rules:{required:String(e("errors.required"))},render:r=>{let{field:t,fieldState:o}=r;return(0,n.jsx)(s.Z,{options:D||[],value:(D||[]).find(e=>e.id===t.value)||null,onChange:(e,r)=>{var n;return t.onChange(null!==(n=null==r?void 0:r.id)&&void 0!==n?n:void 0)},isOptionEqualToValue:(e,r)=>e.id===r.id,getOptionLabel:e=>(null==e?void 0:e.name)||"",renderInput:r=>{var t;return(0,n.jsx)(p.Z,{...r,fullWidth:!0,label:String(e("tasks.form.taskForm")),error:!!o.error,helperText:R(null===(t=o.error)||void 0===t?void 0:t.message)})}})}})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(m.Qr,{name:"sending_org",control:t,rules:{required:!0},render:r=>{var t;let{field:o,fieldState:i}=r;return(0,n.jsx)(p.Z,{fullWidth:!0,label:String(e("tasks.form.sendingOrg")),...o,error:!!i.error,helperText:null===(t=i.error)||void 0===t?void 0:t.message})}})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(m.Qr,{name:"input_doc_number",control:t,rules:{required:String(e("errors.required"))},render:r=>{var t;let{field:o,fieldState:i}=r;return(0,n.jsx)(p.Z,{fullWidth:!0,label:String(e("tasks.form.inputDocNumber")),...o,error:!!i.error,helperText:R(null===(t=i.error)||void 0===t?void 0:t.message)})}})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(m.Qr,{name:"output_doc_number",control:t,rules:{required:String(e("errors.required"))},render:r=>{var t;let{field:o,fieldState:i}=r;return(0,n.jsx)(p.Z,{fullWidth:!0,label:String(e("tasks.form.outputDocNumber")),...o,error:!!i.error,helperText:R(null===(t=i.error)||void 0===t?void 0:t.message)})}})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(m.Qr,{name:"start_date",control:t,rules:{required:String(e("errors.required"))},render:r=>{var t;let{field:o,fieldState:i}=r,a=k(o.value);return(0,n.jsx)("div",{children:(0,n.jsx)(y(),{selected:a,onChange:e=>o.onChange(e?w(e):""),showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:5,dateFormat:"yyyy-MM-dd HH:mm",showMonthDropdown:!0,showYearDropdown:!0,dropdownMode:"scroll",yearDropdownItemNumber:100,scrollableYearDropdown:!0,customInput:(0,n.jsx)(p.Z,{label:String(e("tasks.form.startDate")),fullWidth:!0,error:!!i.error,helperText:R(null===(t=i.error)||void 0===t?void 0:t.message)}),showPopperArrow:!0,isClearable:!0})})}})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(m.Qr,{name:"end_date",control:t,rules:{required:String(e("errors.required"))},render:r=>{var t;let{field:o,fieldState:i}=r,a=k(o.value);return(0,n.jsx)("div",{children:(0,n.jsx)(y(),{selected:a,onChange:e=>o.onChange(e?w(e):""),showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:5,dateFormat:"yyyy-MM-dd HH:mm",showMonthDropdown:!0,showYearDropdown:!0,dropdownMode:"scroll",yearDropdownItemNumber:100,scrollableYearDropdown:!0,customInput:(0,n.jsx)(p.Z,{label:String(e("tasks.form.endDate")),fullWidth:!0,error:!!i.error,helperText:R(null===(t=i.error)||void 0===t?void 0:t.message)}),showPopperArrow:!0,isClearable:!0})})}})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(m.Qr,{name:"department",control:t,rules:{required:String(e("errors.required"))},render:r=>{let{field:t,fieldState:o}=r;return(0,n.jsx)(s.Z,{options:P||[],value:(P||[]).find(e=>e.id===t.value)||null,onChange:(e,r)=>{var n;return t.onChange(null!==(n=null==r?void 0:r.id)&&void 0!==n?n:void 0)},isOptionEqualToValue:(e,r)=>e.id===r.id,getOptionLabel:e=>(null==e?void 0:e.name)||"",renderInput:r=>{var t;return(0,n.jsx)(p.Z,{...r,fullWidth:!0,label:String(e("tasks.form.department")),error:!!o.error,helperText:R(null===(t=o.error)||void 0===t?void 0:t.message)})}})}})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(m.Qr,{name:"signed_by",control:t,rules:{required:String(e("errors.required"))},render:r=>{let{field:t,fieldState:o}=r;return(0,n.jsx)(s.Z,{options:M||[],value:(M||[]).find(e=>e.id===t.value)||null,onChange:(e,r)=>{var n;return t.onChange(null!==(n=null==r?void 0:r.id)&&void 0!==n?n:void 0)},isOptionEqualToValue:(e,r)=>e.id===r.id,getOptionLabel:e=>(null==e?void 0:e.fullname)||"",renderInput:r=>{var t;return(0,n.jsx)(p.Z,{...r,fullWidth:!0,label:String(e("tasks.form.signedBy")),error:!!o.error,helperText:R(null===(t=o.error)||void 0===t?void 0:t.message)})}})}})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(m.Qr,{name:"note",control:t,render:r=>{var t;let{field:o,fieldState:i}=r;return(0,n.jsx)(p.Z,{fullWidth:!0,multiline:!0,rows:3,label:String(e("tasks.form.note")),...o,error:!!i.error,helperText:R(null===(t=i.error)||void 0===t?void 0:t.message)})}})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(m.Qr,{name:"list_of_magazine",control:t,rules:{required:String(e("errors.required"))},render:r=>{let{field:t,fieldState:o}=r;return(0,n.jsx)(s.Z,{options:O||[],value:(O||[]).find(e=>e.id===t.value)||null,onChange:(e,r)=>{var n;return t.onChange(null!==(n=null==r?void 0:r.id)&&void 0!==n?n:void 0)},isOptionEqualToValue:(e,r)=>e.id===r.id,getOptionLabel:e=>(null==e?void 0:e.name)||"",renderInput:r=>{var t;return(0,n.jsx)(p.Z,{...r,fullWidth:!0,label:String(e("tasks.form.magazine")),error:!!o.error,helperText:R(null===(t=o.error)||void 0===t?void 0:t.message)})}})}})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsxs)(d.Z,{direction:"row",spacing:2,justifyContent:"flex-end",children:[(0,n.jsx)(u.Z,{type:"button",variant:"outlined",onClick:()=>b.back(),children:String(e("common.cancel"))}),(0,n.jsx)(u.Z,{type:"submit",variant:"contained",children:String(e("common.save"))})]})})]})})})})})},M=()=>{let{t:e}=(0,_.$G)();return(0,n.jsxs)(o.Z,{children:[(0,n.jsx)(i.Z,{title:String(e("tasks.create.title"))}),(0,n.jsx)(a.Z,{children:(0,n.jsx)(P,{})})]})}}},function(e){e.O(0,[2785,7536,1980,2216,6949,2888,9774,179],function(){return e(e.s=66243)}),_N_E=e.O()}]);