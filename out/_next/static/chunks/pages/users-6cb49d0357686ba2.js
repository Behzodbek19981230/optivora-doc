(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2892],{66249:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/users",function(){return t(69644)}])},34375:function(e,r,t){"use strict";t.d(r,{Z:function(){return y}});var n=t(63366),i=t(87462),s=t(67294),a=t(86010),l=t(94780),o=t(96788),d=t(29567),c=t(77527),m=t(1588),u=t(34867);function x(e){return(0,u.Z)("MuiCardHeader",e)}let h=(0,m.Z)("MuiCardHeader",["root","avatar","action","content","title","subheader"]);var g=t(85893);let j=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],p=e=>{let{classes:r}=e;return(0,l.Z)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},x,r)},f=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,r)=>(0,i.Z)({["& .".concat(h.title)]:r.title,["& .".concat(h.subheader)]:r.subheader},r.root)})({display:"flex",alignItems:"center",padding:16}),Z=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,r)=>r.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),v=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,r)=>r.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),b=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,r)=>r.content})({flex:"1 1 auto"});var y=s.forwardRef(function(e,r){let t=(0,d.Z)({props:e,name:"MuiCardHeader"}),{action:s,avatar:l,className:c,component:m="div",disableTypography:u=!1,subheader:x,subheaderTypographyProps:h,title:y,titleTypographyProps:S}=t,w=(0,n.Z)(t,j),_=(0,i.Z)({},t,{component:m,disableTypography:u}),P=p(_),W=y;null==W||W.type===o.Z||u||(W=(0,g.jsx)(o.Z,(0,i.Z)({variant:l?"body2":"h5",className:P.title,component:"span",display:"block"},S,{children:W})));let C=x;return null==C||C.type===o.Z||u||(C=(0,g.jsx)(o.Z,(0,i.Z)({variant:l?"body2":"body1",className:P.subheader,color:"text.secondary",component:"span",display:"block"},h,{children:C}))),(0,g.jsxs)(f,(0,i.Z)({className:(0,a.Z)(P.root,c),as:m,ref:r,ownerState:_},w,{children:[l&&(0,g.jsx)(Z,{className:P.avatar,ownerState:_,children:l}),(0,g.jsxs)(b,{className:P.content,ownerState:_,children:[W,C]}),s&&(0,g.jsx)(v,{className:P.action,ownerState:_,children:s})]}))})},82071:function(e,r,t){"use strict";t.d(r,{x:function(){return n}});let n=e=>({noRowsLabel:String(e("common.datagrid.noRows",{defaultValue:"No rows"})),MuiTablePagination:{labelRowsPerPage:String(e("common.datagrid.rowsPerPage",{defaultValue:"Rows per page:"})),labelDisplayedRows:r=>{let{from:t,to:n,count:i}=r;return"".concat(t,"–").concat(n," ").concat(String(e("common.datagrid.of",{defaultValue:"of"}))," ").concat(-1!==i?i:">".concat(n))}}})},69644:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return J}});var n=t(85893),i=t(67294),s=t(11163),a=t(81873),l=t(52857),o=t(60762),d=t(34375),c=t(51015),m=t(33453),u=t(92365),x=t(40110),h=t(96727),g=t(28634),j=t(90142),p=t(75673),f=t(33251),Z=t(74538),v=t(52293),b=t(9198),y=t.n(b);t(5843);var S=t(87536),w=t(68573),_=t(12467),P=t(15903),W=t(6897),C=t(85533),k=t(12283),R=t(15972),z=t(13539),N=t(65806),M=t(7879),D=t(86501),I=t(81342),Q=t(34273),q=t(55421),E=t(22120),F=t(20788);let T={username:"",fullname:"",is_active:!0,date_of_birthday:"",gender:"",phone_number:"",avatar:"",email:"",role:[],password:"",region:0,district:0,address:"",companies:[],roles_detail:[]};var H=e=>{let{open:r,onClose:t,onSaved:s,mode:a,item:l}=e,{t:o}=(0,E.$G)(),{control:d,handleSubmit:g,reset:p,watch:b,formState:{isSubmitting:H,errors:O}}=(0,S.cI)({defaultValues:T}),{user:A}=(0,Q.a)(),{data:V=[]}=(0,f.z)(Z.Z.region,{perPage:100}),Y=b("region"),U=Y?"".concat(Z.Z.district,"?region=").concat(Y):Z.Z.district,{data:G=[]}=(0,f.z)(U,{perPage:200}),{data:L=[]}=(0,f.z)(Z.Z.company,{perPage:200}),[B,$]=(0,i.useState)(null),X=(0,i.useRef)(null),[J,K]=(0,i.useState)("");(0,i.useEffect)(()=>{if("edit"===a&&l){var e;p({...l,password:"",role:(null===(e=l.roles_detail)||void 0===e?void 0:e.map(e=>e.id))||[]}),K(l.avatar||"")}else p(T),K("")},[a,l,p]),(0,i.useEffect)(()=>{if(B){let e=URL.createObjectURL(B);return K(e),()=>URL.revokeObjectURL(e)}},[B]);let ee=async e=>{try{let r={...e};if(r.password||delete r.password,"create"===a){let r=new FormData;B&&r.append("avatar",B),Object.keys(e).forEach(t=>{if("roles"!=t){if("role"==t){var n;null===(n=e.role)||void 0===n||n.forEach(e=>{r.append("roles",e)});return}"companies"==t?e.companies.forEach(e=>{r.append("companies",e.toString())}):r.append(t,e[t])}}),await v.Do.postForm(Z.Z.users,r)}else if("edit"===a&&(null==l?void 0:l.id)){let r=new FormData;Object.keys(e).forEach(t=>{if("roles"!=t){if("role"==t){var n;null===(n=e.role)||void 0===n||n.forEach(e=>{r.append("roles",e)});return}if("companies"==t)e.companies.forEach((e,t)=>{r.append("companies",e.toString())});else{if("avatar"==t)return;r.append(t,e[t])}}}),B&&r.append("avatar",B),await v.Do.putForm(Z.Z.userById(l.id),r)}D.ZP.success(String(o("users.toast.saved"))),s(),t()}catch(e){console.error("Failed to save user:",e),D.ZP.error(String(o("users.toast.saveError")))}};return(0,n.jsxs)(m.Z,{open:r,onClose:H?void 0:t,fullWidth:!0,maxWidth:"md",children:[(0,n.jsx)(u.Z,{children:"create"===a?String(o("users.create.title")):String(o("users.edit.title"))}),(0,n.jsxs)("form",{onSubmit:g(ee),children:[(0,n.jsx)(x.Z,{children:(0,n.jsx)(I.Z,{children:(0,n.jsxs)(w.ZP,{container:!0,spacing:4,children:[(0,n.jsx)(w.ZP,{item:!0,xs:12,md:6,children:(0,n.jsx)(S.Qr,{name:"fullname",control:d,rules:{required:String(o("errors.required"))},render:e=>{var r;let{field:t}=e;return(0,n.jsx)(M.Z,{fullWidth:!0,label:String(o("users.form.fullname")),...t,error:!!O.fullname,helperText:null===(r=O.fullname)||void 0===r?void 0:r.message})}})}),(0,n.jsx)(w.ZP,{item:!0,xs:12,md:6,children:(0,n.jsx)(S.Qr,{name:"email",control:d,rules:{required:String(o("errors.required"))},render:e=>{var r;let{field:t}=e;return(0,n.jsx)(M.Z,{fullWidth:!0,type:"email",label:String(o("users.form.email")),...t,error:!!O.email,helperText:null===(r=O.email)||void 0===r?void 0:r.message})}})}),(0,n.jsx)(w.ZP,{item:!0,xs:12,md:6,children:(0,n.jsx)(S.Qr,{name:"phone_number",control:d,render:e=>{let{field:r}=e;return(0,n.jsx)(M.Z,{fullWidth:!0,label:String(o("users.form.phone")),...r})}})}),(0,n.jsx)(w.ZP,{item:!0,xs:12,md:6,children:(0,n.jsx)(S.Qr,{name:"date_of_birthday",control:d,render:e=>{let{field:r}=e,t=r.value?new Date(r.value):null;return(0,n.jsx)("div",{children:(0,n.jsx)(y(),{selected:t,onChange:e=>r.onChange(e?e.toISOString().slice(0,10):""),dateFormat:"yyyy-MM-dd",customInput:(0,n.jsx)(M.Z,{label:String(o("users.form.birthDate")),fullWidth:!0}),showPopperArrow:!0,isClearable:!0})})}})}),(0,n.jsx)(w.ZP,{item:!0,xs:12,md:6,children:(0,n.jsx)(S.Qr,{name:"gender",control:d,rules:{required:String(o("errors.required"))},render:e=>{let{field:r}=e;return(0,n.jsxs)(W.Z,{error:!!O.gender,children:[(0,n.jsx)(C.Z,{children:String(o("users.form.gender"))}),(0,n.jsxs)(P.Z,{row:!0,...r,children:[(0,n.jsx)(N.Z,{value:"male",control:(0,n.jsx)(_.Z,{}),label:String(o("users.gender.male"))}),(0,n.jsx)(N.Z,{value:"female",control:(0,n.jsx)(_.Z,{}),label:String(o("users.gender.female"))})]}),O.gender&&(0,n.jsx)(k.Z,{children:O.gender.message})]})}})}),(0,n.jsx)(w.ZP,{item:!0,xs:12,md:6,children:(0,n.jsx)(S.Qr,{name:"role",control:d,rules:{required:String(o("errors.required"))},render:e=>{var r;let{field:t}=e;return(0,n.jsx)(M.Z,{select:!0,fullWidth:!0,label:String(o("users.form.role")),SelectProps:{multiple:!0},value:Array.isArray(t.value)?t.value:t.value?[t.value]:[],onChange:e=>{let r=e.target.value;t.onChange("string"==typeof r?r.split(","):r)},error:!!O.role,helperText:null===(r=O.role)||void 0===r?void 0:r.message,children:F.e.map(e=>(0,n.jsx)(R.Z,{value:e.value,children:o("users.roles.".concat(e.label.toLowerCase()))},e.value))})}})}),(0,n.jsx)(w.ZP,{item:!0,xs:12,md:6,children:(0,n.jsx)(S.Qr,{name:"username",control:d,rules:{required:String(o("errors.required"))},render:e=>{var r;let{field:t}=e;return(0,n.jsx)(M.Z,{fullWidth:!0,label:String(o("users.form.username")),...t,error:!!O.username,helperText:null===(r=O.username)||void 0===r?void 0:r.message})}})}),(0,n.jsx)(w.ZP,{item:!0,xs:12,md:6,children:(0,n.jsx)(S.Qr,{name:"password",control:d,render:e=>{let{field:r}=e;return(0,n.jsx)(M.Z,{fullWidth:!0,type:"password",label:String(o("users.form.password")),...r,autoComplete:"new-password"})}})}),(0,n.jsx)(w.ZP,{item:!0,xs:12,md:6,children:(0,n.jsx)(S.Qr,{name:"region",control:d,rules:{required:String(o("errors.required"))},render:e=>{var r;let{field:t}=e;return(0,n.jsx)(M.Z,{select:!0,fullWidth:!0,label:String(o("users.form.region")),...t,error:!!O.region,helperText:null===(r=O.region)||void 0===r?void 0:r.message,children:V.map(e=>(0,n.jsx)(R.Z,{value:e.id,children:e.name_uz||e.name},e.id))})}})}),(0,n.jsx)(w.ZP,{item:!0,xs:12,md:6,children:(0,n.jsx)(S.Qr,{name:"district",control:d,rules:{required:String(o("errors.required"))},render:e=>{var r;let{field:t}=e;return(0,n.jsx)(M.Z,{select:!0,fullWidth:!0,label:String(o("users.form.district")),...t,error:!!O.district,helperText:null===(r=O.district)||void 0===r?void 0:r.message,children:G.map(e=>(0,n.jsx)(R.Z,{value:e.id,children:e.name_uz||e.name},e.id))})}})}),(0,n.jsx)(w.ZP,{item:!0,xs:12,children:(0,n.jsx)(S.Qr,{name:"address",control:d,render:e=>{let{field:r}=e;return(0,n.jsx)(M.Z,{fullWidth:!0,label:String(o("users.form.address")),...r})}})}),(0,n.jsx)(w.ZP,{item:!0,xs:12,children:(0,n.jsx)(S.Qr,{name:"companies",control:d,render:e=>{let{field:r}=e;return(0,n.jsx)(M.Z,{select:!0,fullWidth:!0,label:String(o("users.form.companies")),...r,SelectProps:{multiple:!0},children:L.map(e=>(0,n.jsx)(R.Z,{value:e.id,children:e.name},e.id))})}})}),(0,n.jsxs)(w.ZP,{item:!0,xs:6,children:[(0,n.jsx)("input",{ref:X,hidden:!0,type:"file",accept:"image/*",onChange:e=>{var r;return $((null===(r=e.target.files)||void 0===r?void 0:r[0])||null)}}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,n.jsx)(j.Z,{src:J||void 0,variant:"circular",onClick:()=>{var e;return null===(e=X.current)||void 0===e?void 0:e.click()},sx:{width:96,height:96,cursor:"pointer",borderRadius:"50%","& img":{width:"100%",height:"100%",objectFit:"cover"}},children:(0,q.Q)(b("fullname")||b("username")||"U")}),(0,n.jsx)(c.Z,{variant:"outlined",onClick:()=>{var e;return null===(e=X.current)||void 0===e?void 0:e.click()},children:String(o("users.form.uploadAvatar"))})]})]}),(0,n.jsx)(w.ZP,{item:!0,xs:6,children:(0,n.jsx)(S.Qr,{name:"is_active",control:d,render:e=>{let{field:r}=e;return(0,n.jsx)(N.Z,{control:(0,n.jsx)(z.Z,{checked:!!r.value,onChange:(e,t)=>r.onChange(t)}),label:String(o("users.form.active"))})}})})]})})}),(0,n.jsxs)(h.Z,{children:[(0,n.jsx)(c.Z,{type:"button",variant:"tonal",color:"secondary",onClick:t,disabled:H,children:String(o("common.cancel"))}),(0,n.jsx)(c.Z,{type:"submit",disabled:H,children:H?String(o("common.saving")):String(o("common.save"))})]})]})]})},O=t(96788),A=t(90642),V=t(30381),Y=t.n(V),U=t(56912),G=t(84166),L=t(21038),B=e=>{var r,t,i,s;let{open:o,onClose:d,user:g}=e,{t:f,i18n:Z}=(0,E.$G)(),v=e=>{if(!e)return"—";let r=Z.language;return r.startsWith("uz")?e.name_uz||e.name||"—":r.startsWith("ru")?e.name_ru||e.name||"—":r.startsWith("en")?e.name_en||e.name||"—":e.name||e.name_uz||e.name_ru||e.name_en||"—"},b=e=>{if(null==e)return"—";let r=String(e).trim();return r.length?r:"—"};return(0,n.jsxs)(m.Z,{open:o,onClose:d,maxWidth:"md",fullWidth:!0,children:[(0,n.jsx)(u.Z,{sx:{pr:12},children:(0,n.jsxs)(A.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:2},children:[(0,n.jsx)(O.Z,{variant:"h6",children:String(f("users.view.title",{defaultValue:"User details"}))}),(0,n.jsx)(L.Z,{title:String(f("common.close")),children:(0,n.jsx)(l.Z,{onClick:d,"aria-label":"close",children:(0,n.jsx)(p.Z,{icon:"tabler:x"})})})]})}),(0,n.jsx)(x.Z,{children:g?(0,n.jsxs)(A.Z,{sx:{pb:2},children:[(0,n.jsxs)(A.Z,{sx:{display:"flex",alignItems:{xs:"flex-start",sm:"center"},justifyContent:"space-between",gap:4,flexDirection:{xs:"column",sm:"row"}},children:[(0,n.jsxs)(A.Z,{sx:{display:"flex",alignItems:"center",gap:3,minWidth:0},children:[(0,n.jsx)(j.Z,{src:g.avatar,variant:"circular",sx:{width:88,height:88,borderRadius:"50%","& img":{width:"100%",height:"100%",objectFit:"cover"}}}),(0,n.jsxs)(A.Z,{sx:{minWidth:0},children:[(0,n.jsx)(O.Z,{variant:"h6",sx:{fontWeight:700},noWrap:!0,children:b(g.fullname||g.username)}),(0,n.jsx)(O.Z,{variant:"body2",color:"text.secondary",noWrap:!0,children:b(g.email)}),(0,n.jsxs)(O.Z,{variant:"caption",color:"text.secondary",noWrap:!0,children:["@",b(g.username)]})]})]}),(0,n.jsxs)(G.Z,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:[(0,n.jsx)(a.Z,{size:"small",color:g.is_active?"success":"default",variant:g.is_active?"filled":"outlined",label:g.is_active?String(f("common.yes")):String(f("common.no"))}),null===(r=g.roles_detail)||void 0===r?void 0:r.slice(0,4).map(e=>(0,n.jsx)(a.Z,{label:e.name,size:"small",variant:"outlined"},e.id)),g.roles_detail&&g.roles_detail.length>4?(0,n.jsx)(a.Z,{size:"small",variant:"outlined",label:"+".concat(g.roles_detail.length-4),"aria-label":"more roles"}):null]})]}),(0,n.jsx)(U.Z,{sx:{my:4}}),(0,n.jsxs)(w.ZP,{container:!0,spacing:4,children:[(0,n.jsxs)(w.ZP,{item:!0,xs:12,md:6,children:[(0,n.jsx)(O.Z,{variant:"subtitle1",sx:{fontWeight:700,mb:2},children:String(f("users.view.sections.contact",{defaultValue:"Contact"}))}),(0,n.jsxs)(G.Z,{spacing:2,children:[(0,n.jsxs)(A.Z,{sx:{display:"flex",alignItems:"flex-start",gap:2},children:[(0,n.jsx)(p.Z,{icon:"tabler:mail",fontSize:"1.25rem"}),(0,n.jsxs)(A.Z,{sx:{minWidth:0},children:[(0,n.jsx)(O.Z,{variant:"body2",color:"text.secondary",children:String(f("users.form.email"))}),(0,n.jsx)(O.Z,{variant:"body1",noWrap:!0,children:b(g.email)})]})]}),(0,n.jsxs)(A.Z,{sx:{display:"flex",alignItems:"flex-start",gap:2},children:[(0,n.jsx)(p.Z,{icon:"tabler:phone",fontSize:"1.25rem"}),(0,n.jsxs)(A.Z,{sx:{minWidth:0},children:[(0,n.jsx)(O.Z,{variant:"body2",color:"text.secondary",children:String(f("users.form.phone"))}),(0,n.jsx)(O.Z,{variant:"body1",noWrap:!0,children:b(g.phone_number)})]})]}),(0,n.jsxs)(A.Z,{sx:{display:"flex",alignItems:"flex-start",gap:2},children:[(0,n.jsx)(p.Z,{icon:"tabler:map-pin",fontSize:"1.25rem"}),(0,n.jsxs)(A.Z,{sx:{minWidth:0},children:[(0,n.jsx)(O.Z,{variant:"body2",color:"text.secondary",children:String(f("users.form.address"))}),(0,n.jsx)(O.Z,{variant:"body1",children:b(g.address)})]})]})]})]}),(0,n.jsxs)(w.ZP,{item:!0,xs:12,md:6,children:[(0,n.jsx)(O.Z,{variant:"subtitle1",sx:{fontWeight:700,mb:2},children:String(f("users.view.sections.meta",{defaultValue:"Details"}))}),(0,n.jsxs)(w.ZP,{container:!0,spacing:2,children:[(0,n.jsxs)(w.ZP,{item:!0,xs:12,sm:6,children:[(0,n.jsx)(O.Z,{variant:"body2",color:"text.secondary",children:String(f("users.form.fullname"))}),(0,n.jsx)(O.Z,{variant:"body1",children:b(g.fullname)})]}),(0,n.jsxs)(w.ZP,{item:!0,xs:12,sm:6,children:[(0,n.jsx)(O.Z,{variant:"body2",color:"text.secondary",children:String(f("users.form.username"))}),(0,n.jsx)(O.Z,{variant:"body1",children:b(g.username)})]}),(0,n.jsxs)(w.ZP,{item:!0,xs:12,sm:6,children:[(0,n.jsx)(O.Z,{variant:"body2",color:"text.secondary",children:String(f("users.form.gender"))}),(0,n.jsx)(O.Z,{variant:"body1",children:"male"===(s=g.gender)?String(f("users.gender.male",{defaultValue:"Male"})):"female"===s?String(f("users.gender.female",{defaultValue:"Female"})):s||"—"})]}),(0,n.jsxs)(w.ZP,{item:!0,xs:12,sm:6,children:[(0,n.jsx)(O.Z,{variant:"body2",color:"text.secondary",children:String(f("users.form.birthDate"))}),(0,n.jsx)(O.Z,{variant:"body1",children:g.date_of_birthday?Y()(g.date_of_birthday).format("DD.MM.YYYY"):"—"})]}),(0,n.jsxs)(w.ZP,{item:!0,xs:12,sm:6,children:[(0,n.jsx)(O.Z,{variant:"body2",color:"text.secondary",children:String(f("users.form.region"))}),(0,n.jsx)(O.Z,{variant:"body1",children:v(g.region_detail)})]}),(0,n.jsxs)(w.ZP,{item:!0,xs:12,sm:6,children:[(0,n.jsx)(O.Z,{variant:"body2",color:"text.secondary",children:String(f("users.form.district"))}),(0,n.jsx)(O.Z,{variant:"body1",children:v(g.district_detail)})]}),(0,n.jsxs)(w.ZP,{item:!0,xs:12,children:[(0,n.jsx)(O.Z,{variant:"body2",color:"text.secondary",children:String(f("common.createdAt"))}),(0,n.jsx)(O.Z,{variant:"body1",children:Y()(g.date_joined).format("DD.MM.YYYY HH:mm")})]})]})]}),(0,n.jsx)(w.ZP,{item:!0,xs:12,children:(0,n.jsx)(U.Z,{sx:{my:1}})}),(0,n.jsxs)(w.ZP,{item:!0,xs:12,md:6,children:[(0,n.jsx)(O.Z,{variant:"subtitle1",sx:{fontWeight:700,mb:2},children:String(f("users.form.role"))}),(0,n.jsx)(A.Z,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:(null===(t=g.roles_detail)||void 0===t?void 0:t.length)?g.roles_detail.map(e=>(0,n.jsx)(a.Z,{label:e.name,size:"small"},e.id)):(0,n.jsx)(O.Z,{variant:"body2",color:"text.secondary",children:"—"})})]}),(0,n.jsxs)(w.ZP,{item:!0,xs:12,md:6,children:[(0,n.jsx)(O.Z,{variant:"subtitle1",sx:{fontWeight:700,mb:2},children:String(f("users.form.companies"))}),(0,n.jsx)(A.Z,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:(null===(i=g.companies_detail)||void 0===i?void 0:i.length)?g.companies_detail.map(e=>(0,n.jsx)(a.Z,{label:e.name,size:"small"},e.id)):(0,n.jsx)(O.Z,{variant:"body2",color:"text.secondary",children:"—"})})]})]})]}):(0,n.jsx)(O.Z,{color:"text.secondary",children:String(f("common.notFound"))})}),(0,n.jsx)(h.Z,{children:(0,n.jsx)(c.Z,{onClick:d,children:String(f("common.close"))})})]})},$=t(82071),X=()=>{(0,s.useRouter)();let{t:e}=(0,E.$G)(),[r,t]=(0,i.useState)({page:0,pageSize:10}),{data:b=[],loading:y,mutate:S}=(0,f.z)(Z.Z.users,{perPage:r.pageSize,page:r.page+1}),[w,_]=(0,i.useState)(!1),[P,W]=(0,i.useState)(null),[C,k]=(0,i.useState)(!1),[R,z]=(0,i.useState)(null),[N,M]=(0,i.useState)(!1),[D,I]=(0,i.useState)(null),Q=e=>{W(e),_(!0)},F=async e=>{await v.Do.delete(Z.Z.userById(e)),S()},T=e=>e.avatar?(0,n.jsx)(j.Z,{src:e.avatar,variant:"circular",sx:{mr:2.5,width:38,height:38,borderRadius:"50%","& img":{width:"100%",height:"100%",objectFit:"cover"},cursor:"pointer"},onClick:()=>{z(e.avatar),k(!0)}}):(0,n.jsx)(j.Z,{skin:"light",color:"primary",sx:{mr:2.5,width:38,height:38,fontWeight:500},children:(0,q.Q)(e.fullname||e.username)}),O=[{field:"fullname",headerName:String(e("users.table.fullname")),flex:.25,minWidth:220,renderCell:e=>{let r=e.row;return(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[T(r),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,n.jsx)("span",{style:{fontWeight:500},children:r.fullname||r.username}),(0,n.jsx)("span",{style:{color:"gray",fontSize:12},children:r.email})]})]})}},{field:"username",headerName:String(e("users.table.username")),flex:.15,minWidth:140},{field:"role",headerName:String(e("users.table.role")),flex:.12,minWidth:200,valueGetter:e=>{let r=e.row.roles_detail||[];return 0===r.length?"":r.map(e=>e.name).join(", ")}},{field:"phone_number",headerName:String(e("users.table.phone")),flex:.18,minWidth:160},{field:"is_active",headerName:String(e("users.table.active")),flex:.1,minWidth:100,valueGetter:r=>r.row.is_active?String(e("common.yes")):String(e("common.no"))},{field:"companies_detail",headerName:String(e("users.table.companies")),flex:.35,minWidth:260,sortable:!1,renderCell:e=>{let r=e.row.companies_detail||[];if(!r.length)return(0,n.jsx)("span",{style:{color:"gray"},children:"—"});let t=r.slice(0,3).map((e,r)=>{let t,i=r;if("string"==typeof e)t=e;else if("number"==typeof e)t=String(e);else{var s;i=null!==(s=e.id)&&void 0!==s?s:r,t=e.name||e.company_name||e.title||"#".concat(e.id)}return(0,n.jsx)(a.Z,{size:"small",label:t,sx:{mr:1,mb:1}},i)}),i=r.length-3;return(0,n.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center"},children:[t,i>0&&(0,n.jsx)(a.Z,{size:"small",label:"+".concat(i),sx:{mb:1}})]})}},{field:"actions",headerName:String(e("common.actions")),flex:.18,minWidth:160,sortable:!1,renderCell:e=>{let r=e.row;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Z,{"aria-label":"view",onClick:()=>{I(r),M(!0)},children:(0,n.jsx)(p.Z,{icon:"tabler:eye"})}),(0,n.jsx)(l.Z,{"aria-label":"edit",onClick:()=>Q(r),children:(0,n.jsx)(p.Z,{icon:"tabler:edit"})}),(0,n.jsx)(l.Z,{"aria-label":"delete",color:"error",onClick:()=>F(r.id),children:(0,n.jsx)(p.Z,{icon:"tabler:trash"})})]})}}];return(0,n.jsxs)(o.Z,{children:[(0,n.jsx)(d.Z,{title:String(e("users.title")),action:(0,n.jsx)(c.Z,{variant:"contained",onClick:()=>{W(null),_(!0)},children:String(e("common.create"))})}),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(g._,{autoHeight:!0,rowHeight:56,rows:b,columns:O,loading:y,disableRowSelectionOnClick:!0,pageSizeOptions:[10,25,50],paginationModel:r,onPaginationModelChange:t,getRowId:e=>e.id,localeText:(0,$.x)(e)})}),w&&(0,n.jsx)(H,{open:w,onClose:()=>_(!1),onSaved:S,mode:P?"edit":"create",item:P?{...P,companies:(P.companies||[]).map(e=>"string"==typeof e?Number(e):e)}:void 0}),(0,n.jsxs)(m.Z,{open:C,onClose:()=>k(!1),maxWidth:"sm",fullWidth:!0,children:[(0,n.jsx)(u.Z,{children:String(e("users.avatar.title"))}),(0,n.jsx)(x.Z,{children:R&&(0,n.jsx)("img",{src:R,alt:"User Avatar",style:{width:"100%",height:"auto",borderRadius:"8px"}})}),(0,n.jsx)(h.Z,{children:(0,n.jsx)(c.Z,{onClick:()=>k(!1),children:String(e("common.close"))})})]}),(0,n.jsx)(B,{open:N,onClose:()=>M(!1),user:D})]})},J=()=>(0,n.jsx)(X,{})}},function(e){e.O(0,[4885,2785,7536,9084,8634,1980,1863,2888,9774,179],function(){return e(e.s=66249)}),_N_E=e.O()}]);