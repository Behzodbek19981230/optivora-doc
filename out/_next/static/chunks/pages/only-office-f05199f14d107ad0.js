(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7133],{36930:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/only-office",function(){return n(81066)}])},81066:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var o=n(85893),c=n(67294),a=n(83454);let i=a.env.NEXT_PUBLIC_DOC_SERVER||"http://localhost:4000",r=a.env.NEXT_PUBLIC_ONLYOFFICE_URL||"http://localhost:8082";function d(){let[e,t]=(0,c.useState)([]),[n,a]=(0,c.useState)(null),[d,l]=(0,c.useState)(!1),s=(0,c.useRef)(null),u=(0,c.useMemo)(()=>i,[]);(0,c.useEffect)(()=>{fetch("".concat(u,"/documents")).then(async e=>{let o=await e.json();t(o||[]),!n&&Array.isArray(o)&&o.length>0&&a(o[0].id)}).catch(()=>t([]))},[u]);let f=(0,c.useCallback)(async()=>{try{let n=e.find(e=>"test.docx"==="".concat(e.name).concat(e.ext).toLowerCase()||"test.docs"==="".concat(e.name).concat(e.ext).toLowerCase());if(n)return a(n.id),n;let o=await fetch("".concat(u,"/documents/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"test",ext:".docx",contentBase64:""})}),c=await o.json(),i=await fetch("".concat(u,"/documents")),r=await i.json();return t(r||[]),a(c.id),c}catch(e){console.error("Failed to create default doc",e),alert("Default document could not be created. Ensure the backend is running on port 4000.")}},[u,e]),h=(0,c.useCallback)(async()=>{if(!n){let e=await f();if(!e)return}l(!0);try{var t;await new Promise((e,t)=>{let n=document.getElementById("onlyoffice-api");if(n)return window.DocsAPI?e():(n.addEventListener("load",()=>e()),void n.addEventListener("error",()=>t(Error("Failed to load OnlyOffice script"))));let o=document.createElement("script");o.id="onlyoffice-api",o.src="".concat(r,"/web-apps/apps/api/documents/api.js"),o.async=!0,o.onload=()=>e(),o.onerror=()=>t(Error("Failed to load OnlyOffice script")),document.body.appendChild(o)});let o=n||(null===(t=e.find(e=>"".concat(e.name).concat(e.ext).toLowerCase().startsWith("test.")))||void 0===t?void 0:t.id),c=await fetch("".concat(u,"/documents/onlyoffice-config/").concat(encodeURIComponent(o)),{method:"POST"}),a=await c.json(),i=window.DocsAPI;if(s.current&&s.current.destroyEditor)try{s.current.destroyEditor()}catch(e){}s.current=new i.DocEditor("onlyoffice-editor-container",{...a,width:"100%",height:"800px"})}catch(e){console.error(e),alert("Failed to open OnlyOffice editor. Check server and OnlyOffice containers.")}finally{l(!1)}},[u,n,e,f]);return(0,o.jsxs)("div",{style:{padding:16},children:[(0,o.jsx)("h2",{children:"OnlyOffice Word Editor"}),(0,o.jsxs)("p",{children:["Backend: ",(0,o.jsx)("code",{children:i})," \xb7 DocumentServer: ",(0,o.jsx)("code",{children:r})]}),(0,o.jsxs)("div",{style:{marginBottom:12},children:[(0,o.jsx)("label",{htmlFor:"docSelect",children:"Select document:"})," ",(0,o.jsxs)("select",{id:"docSelect",value:null!=n?n:"",onChange:e=>a(e.target.value),children:[0===e.length&&(0,o.jsx)("option",{value:"",children:"No documents found (upload one via API)"}),e.map(e=>(0,o.jsx)("option",{value:e.id,children:"".concat(e.name).concat(e.ext)},e.id))]}),(0,o.jsx)("button",{style:{marginLeft:8},onClick:h,disabled:!n||d,children:d?"Openingâ€¦":"Open in OnlyOffice"})]}),(0,o.jsx)("div",{id:"onlyoffice-editor-container",style:{border:"1px solid #ddd",borderRadius:8,overflow:"hidden"}})]})}}},function(e){e.O(0,[9774,2888,179],function(){return e(e.s=36930)}),_N_E=e.O()}]);