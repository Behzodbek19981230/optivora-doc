(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3689],{89032:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tasks",function(){return i(90337)}])},81359:function(e,t,i){"use strict";i.d(t,{Z:function(){return b}});var r=i(87462),n=i(63366),a=i(67294),o=i(86010),s=i(94780),l=i(29567),c=i(77527),d=i(1588),u=i(34867);function h(e){return(0,u.Z)("MuiCardActionArea",e)}let m=(0,d.Z)("MuiCardActionArea",["root","focusVisible","focusHighlight"]);var p=i(28425),g=i(85893);let f=["children","className","focusVisibleClassName"],v=e=>{let{classes:t}=e;return(0,s.Z)({root:["root"],focusHighlight:["focusHighlight"]},h,t)},x=(0,c.ZP)(p.Z,{name:"MuiCardActionArea",slot:"Root",overridesResolver:(e,t)=>t.root})(e=>{let{theme:t}=e;return{display:"block",textAlign:"inherit",borderRadius:"inherit",width:"100%",["&:hover .".concat(m.focusHighlight)]:{opacity:(t.vars||t).palette.action.hoverOpacity,"@media (hover: none)":{opacity:0}},["&.".concat(m.focusVisible," .").concat(m.focusHighlight)]:{opacity:(t.vars||t).palette.action.focusOpacity}}}),Z=(0,c.ZP)("span",{name:"MuiCardActionArea",slot:"FocusHighlight",overridesResolver:(e,t)=>t.focusHighlight})(e=>{let{theme:t}=e;return{overflow:"hidden",pointerEvents:"none",position:"absolute",top:0,right:0,bottom:0,left:0,borderRadius:"inherit",opacity:0,backgroundColor:"currentcolor",transition:t.transitions.create("opacity",{duration:t.transitions.duration.short})}});var b=a.forwardRef(function(e,t){let i=(0,l.Z)({props:e,name:"MuiCardActionArea"}),{children:a,className:s,focusVisibleClassName:c}=i,d=(0,n.Z)(i,f),u=v(i);return(0,g.jsxs)(x,(0,r.Z)({className:(0,o.Z)(u.root,s),focusVisibleClassName:(0,o.Z)(c,u.focusVisible),ref:t,ownerState:i},d,{children:[a,(0,g.jsx)(Z,{className:u.focusHighlight,ownerState:i})]}))})},71919:function(e,t,i){"use strict";i.d(t,{Z:function(){return v}});var r=i(87462),n=i(63366),a=i(67294),o=i(86010),s=i(94780),l=i(77527),c=i(29567),d=i(1588),u=i(34867);function h(e){return(0,u.Z)("MuiCardContent",e)}(0,d.Z)("MuiCardContent",["root"]);var m=i(85893);let p=["className","component"],g=e=>{let{classes:t}=e;return(0,s.Z)({root:["root"]},h,t)},f=(0,l.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}}));var v=a.forwardRef(function(e,t){let i=(0,c.Z)({props:e,name:"MuiCardContent"}),{className:a,component:s="div"}=i,l=(0,n.Z)(i,p),d=(0,r.Z)({},i,{component:s}),u=g(d);return(0,m.jsx)(f,(0,r.Z)({as:s,className:(0,o.Z)(u.root,a),ownerState:d,ref:t},l))})},84166:function(e,t,i){"use strict";i.d(t,{Z:function(){return w}});var r=i(63366),n=i(87462),a=i(67294),o=i(86010),s=i(59766),l=i(94780),c=i(34867),d=i(13264),u=i(29628),h=i(39707),m=i(66500),p=i(95408),g=i(98700),f=i(85893);let v=["component","direction","spacing","divider","children","className","useFlexGap"],x=(0,m.Z)(),Z=(0,d.Z)("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root});function b(e){return(0,u.Z)({props:e,name:"MuiStack",defaultTheme:x})}let k=e=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[e],y=({ownerState:e,theme:t})=>{let i=(0,n.Z)({display:"flex",flexDirection:"column"},(0,p.k9)({theme:t},(0,p.P$)({values:e.direction,breakpoints:t.breakpoints.values}),e=>({flexDirection:e})));if(e.spacing){let r=(0,g.hB)(t),n=Object.keys(t.breakpoints.values).reduce((t,i)=>(("object"==typeof e.spacing&&null!=e.spacing[i]||"object"==typeof e.direction&&null!=e.direction[i])&&(t[i]=!0),t),{}),a=(0,p.P$)({values:e.direction,base:n}),o=(0,p.P$)({values:e.spacing,base:n});"object"==typeof a&&Object.keys(a).forEach((e,t,i)=>{if(!a[e]){let r=t>0?a[i[t-1]]:"column";a[e]=r}}),i=(0,s.Z)(i,(0,p.k9)({theme:t},o,(t,i)=>e.useFlexGap?{gap:(0,g.NA)(r,t)}:{"& > :not(style) + :not(style)":{margin:0,[`margin${k(i?a[i]:e.direction)}`]:(0,g.NA)(r,t)}}))}return(0,p.dt)(t.breakpoints,i)};var j=i(77527),S=i(29567),w=function(e={}){let{createStyledComponent:t=Z,useThemeProps:i=b,componentName:s="MuiStack"}=e,d=()=>(0,l.Z)({root:["root"]},e=>(0,c.Z)(s,e),{}),u=t(y);return a.forwardRef(function(e,t){let s=i(e),l=(0,h.Z)(s),{component:c="div",direction:m="column",spacing:p=0,divider:g,children:x,className:Z,useFlexGap:b=!1}=l,k=(0,r.Z)(l,v),y=d();return(0,f.jsx)(u,(0,n.Z)({as:c,ownerState:{direction:m,spacing:p,useFlexGap:b},ref:t,className:(0,o.Z)(y.root,Z)},k,{children:g?function(e,t){let i=a.Children.toArray(e).filter(Boolean);return i.reduce((e,r,n)=>(e.push(r),n<i.length-1&&e.push(a.cloneElement(t,{key:`separator-${n}`})),e),[])}(x,g):x}))})}({createStyledComponent:(0,j.ZP)("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root}),useThemeProps:e=>(0,S.Z)({props:e,name:"MuiStack"})})},82071:function(e,t,i){"use strict";i.d(t,{x:function(){return r}});let r=e=>({noRowsLabel:String(e("common.datagrid.noRows",{defaultValue:"No rows"})),MuiTablePagination:{labelRowsPerPage:String(e("common.datagrid.rowsPerPage",{defaultValue:"Rows per page:"})),labelDisplayedRows:t=>{let{from:i,to:r,count:n}=t;return"".concat(i,"–").concat(r," ").concat(String(e("common.datagrid.of",{defaultValue:"of"}))," ").concat(-1!==n?n:">".concat(r))}}})},33251:function(e,t,i){"use strict";i.d(t,{z:function(){return o}});var r=i(30202),n=i(33934),a=i(52293);let o=function(e){var t,i;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=!(arguments.length>2)||void 0===arguments[2]||arguments[2],l=(0,r.NL)(),c=["list",e,o],d=Object.fromEntries(Object.entries(o).filter(e=>{let[,t]=e;return void 0!==t})),{data:u,isLoading:h,error:m}=(0,n.a)({queryKey:c,queryFn:async()=>{var t,i,r;let n=(await a.Do.get(e,d)).data,o=Array.isArray(n)?n:null!==(i=null==n?void 0:n.results)&&void 0!==i?i:[],s=Array.isArray(n)?o.length:null!==(r=null==n?void 0:null===(t=n.pagination)||void 0===t?void 0:t.total)&&void 0!==r?r:o.length;return{items:o,total:s}},enabled:s,staleTime:3e4});return{data:null!==(t=null==u?void 0:u.items)&&void 0!==t?t:[],total:null!==(i=null==u?void 0:u.total)&&void 0!==i?i:0,loading:h,error:m,mutate:()=>{l.invalidateQueries({queryKey:c})}}}},90337:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return V}});var r=i(85893),n=i(60762),a=i(34375),o=i(71919),s=i(67294),l=i(84166),c=i(21038),d=i(52857),u=i(73907),h=i(33453),m=i(92365),p=i(40110),g=i(96788),f=i(68573),v=i(81359),x=i(90642),Z=i(96727),b=i(16127),k=i(74538),y=i(33251),j=i(75673),S=i(41664),w=i.n(S),C=i(11163),N=i(22120),R=i(52293),M=i(58898),P=i(34273),_=i(82071),A=i(30381),H=i.n(A);let E=e=>{if(!e)return"—";let t=H()(e);return t.isValid()?t.format("DD.MM.YYYY HH:mm"):String(e)};var O=()=>{var e;let[t,i]=(0,s.useState)({page:0,pageSize:10}),a=(0,C.useRouter)(),{t:S}=(0,N.$G)(),A=(0,M.Z)(),{user:H}=(0,P.a)(),[O,V]=(0,s.useState)(!1),[W,z]=(0,s.useState)("task"),[D,T]=(0,s.useState)(!1),{data:$=[],total:F,loading:B}=(0,y.z)(k.Z.task,{page:t.page+1,limit:t.pageSize}),G=[{field:"id",headerName:String(S("common.id")),width:90},{field:"name",headerName:String(S("tasks.table.name")),flex:.3,minWidth:180},{field:"status",headerName:String(S("tasks.table.status")),flex:.2,minWidth:140},{field:"type",headerName:String(S("tasks.table.type")),flex:.15,minWidth:120},{field:"priority",headerName:String(S("tasks.table.priority")),flex:.15,minWidth:120},{field:"start_date",headerName:String(S("tasks.table.start")),flex:.15,minWidth:160,renderCell:e=>E(e.row.start_date)},{field:"end_date",headerName:String(S("tasks.table.end")),flex:.15,minWidth:160,renderCell:e=>E(e.row.end_date)},{field:"actions",headerName:String(S("common.actions")),width:120,sortable:!1,renderCell:e=>{let t=e.row.id;return(0,r.jsxs)(l.Z,{direction:"row",spacing:1,children:[(0,r.jsx)(c.Z,{title:String(S("common.view")),children:(0,r.jsx)(d.Z,{size:"small",component:w(),href:"/tasks/view/".concat(t),children:(0,r.jsx)(j.Z,{icon:"tabler:eye"})})}),(0,r.jsx)(c.Z,{title:String(S("common.edit")),children:(0,r.jsx)(d.Z,{size:"small",component:w(),href:"/tasks/update/".concat(t),children:(0,r.jsx)(j.Z,{icon:"tabler:pencil"})})})]})}}];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{direction:"row",justifyContent:"flex-end",sx:{mb:2},children:(null==H?void 0:null===(e=H.role_detail)||void 0===e?void 0:e.some(e=>"Performer"!==e.name))&&(0,r.jsx)(u.Z,{variant:"contained",startIcon:(0,r.jsx)(j.Z,{icon:"tabler:plus"}),onClick:()=>V(!0),children:String(S("tasks.create.title"))})}),(0,r.jsxs)(h.Z,{open:O,onClose:D?void 0:()=>V(!1),fullWidth:!0,maxWidth:"sm",children:[(0,r.jsx)(m.Z,{children:String(S("tasks.create.modal.title"))}),(0,r.jsxs)(p.Z,{children:[(0,r.jsx)(g.Z,{variant:"body2",sx:{color:"text.secondary",mb:4},children:String(S("tasks.create.modal.subtitle"))}),(0,r.jsxs)(f.ZP,{container:!0,spacing:3,children:[(0,r.jsx)(f.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(n.Z,{variant:"outlined",sx:{borderColor:"task"===W?"primary.main":"divider",bgcolor:"task"===W?"primary.lighter":"background.paper"},children:(0,r.jsx)(v.Z,{onClick:()=>z("task"),children:(0,r.jsxs)(o.Z,{sx:{height:100},children:[(0,r.jsxs)(x.Z,{sx:{display:"flex",alignItems:"center",gap:2,mb:1},children:[(0,r.jsx)(j.Z,{icon:"tabler:clipboard-list"}),(0,r.jsx)(g.Z,{variant:"h6",children:String(S("tasks.type.task"))})]}),(0,r.jsx)(g.Z,{variant:"body2",sx:{color:"text.secondary"},children:String(S("tasks.create.modal.taskHint"))})]})})})}),(0,r.jsx)(f.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(n.Z,{variant:"outlined",sx:{borderColor:"application"===W?"primary.main":"divider",bgcolor:"application"===W?"primary.lighter":"background.paper"},children:(0,r.jsx)(v.Z,{onClick:()=>z("application"),children:(0,r.jsxs)(o.Z,{sx:{height:100},children:[(0,r.jsxs)(x.Z,{sx:{display:"flex",alignItems:"center",gap:2,mb:1},children:[(0,r.jsx)(j.Z,{icon:"tabler:file-text"}),(0,r.jsx)(g.Z,{variant:"h6",children:String(S("tasks.type.application"))})]}),(0,r.jsx)(g.Z,{variant:"body2",sx:{color:"text.secondary"},children:String(S("tasks.create.modal.applicationHint"))})]})})})})]})]}),(0,r.jsxs)(Z.Z,{children:[(0,r.jsx)(u.Z,{variant:"tonal",color:"secondary",onClick:()=>V(!1),disabled:D,children:String(S("common.cancel"))}),(0,r.jsx)(u.Z,{variant:"contained",onClick:async()=>{try{var e;T(!0);let t=await R.Do.post(k.Z.task,{type:W,status:"new",company:null==H?void 0:H.company_id}),i=null===(e=t.data)||void 0===e?void 0:e.id;A.success(String(S("tasks.toast.created"))),V(!1),i&&a.push("/tasks/update/".concat(i))}catch(e){A.error((null==e?void 0:e.message)||String(S("tasks.toast.createError")))}finally{T(!1)}},disabled:D,children:D?String(S("common.creating")):String(S("common.create"))})]})]}),(0,r.jsx)(b._,{autoHeight:!0,rowHeight:56,rows:$,columns:G,loading:B,rowCount:F,paginationMode:"server",disableRowSelectionOnClick:!0,pageSizeOptions:[10,25,50],paginationModel:t,onPaginationModelChange:i,getRowId:e=>e.id,localeText:(0,_.x)(S)})]})},V=()=>{let{t:e}=(0,N.$G)();return(0,r.jsxs)(n.Z,{children:[(0,r.jsx)(a.Z,{title:String(e("tasks.title"))}),(0,r.jsx)(o.Z,{children:(0,r.jsx)(O,{})})]})}}},function(e){e.O(0,[4885,2785,7605,2888,9774,179],function(){return e(e.s=89032)}),_N_E=e.O()}]);