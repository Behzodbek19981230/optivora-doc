(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7639],{49144:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/company",function(){return r(80325)}])},82071:function(e,n,r){"use strict";r.d(n,{x:function(){return i}});let i=e=>({noRowsLabel:String(e("common.datagrid.noRows",{defaultValue:"No rows"})),MuiTablePagination:{labelRowsPerPage:String(e("common.datagrid.rowsPerPage",{defaultValue:"Rows per page:"})),labelDisplayedRows:n=>{let{from:r,to:i,count:t}=n;return"".concat(r,"â€“").concat(i," ").concat(String(e("common.datagrid.of",{defaultValue:"of"}))," ").concat(-1!==t?t:">".concat(i))}}})},33251:function(e,n,r){"use strict";r.d(n,{z:function(){return a}});var i=r(30202),t=r(33934),o=r(52293);let a=function(e){var n,r;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=!(arguments.length>2)||void 0===arguments[2]||arguments[2],d=(0,i.NL)(),s=["list",e,a],c=Object.fromEntries(Object.entries(a).filter(e=>{let[,n]=e;return void 0!==n})),{data:m,isLoading:u,error:x}=(0,t.a)({queryKey:s,queryFn:async()=>{var n,r,i;let t=(await o.Do.get(e,c)).data,a=Array.isArray(t)?t:null!==(r=null==t?void 0:t.results)&&void 0!==r?r:[],l=Array.isArray(t)?a.length:null!==(i=null==t?void 0:null===(n=t.pagination)||void 0===n?void 0:n.total)&&void 0!==i?i:a.length;return{items:a,total:l}},enabled:l,staleTime:3e4});return{data:null!==(n=null==m?void 0:m.items)&&void 0!==n?n:[],total:null!==(r=null==m?void 0:m.total)&&void 0!==r?r:0,loading:u,error:x,mutate:()=>{d.invalidateQueries({queryKey:s})}}}},80325:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return I}});var i=r(85893),t=r(67294),o=r(11163),a=r(33251),l=r(52293),d=r(74538),s=r(52857),c=r(60762),m=r(34375),u=r(73907),x=r(33453),h=r(92365),g=r(40110),p=r(96788),v=r(96727),y=r(16127),j=r(75673),Z=r(87536),f=r(68573),S=r(13539),b=r(65806),w=r(90642),C=r(7879),P=r(46070),_=r(86501),W=r(22120),k=r(90142),N=r(34273),q=e=>{let{open:n,onClose:r,onSaved:o,mode:s,item:c}=e,{t:m}=(0,W.$G)(),{user:y}=(0,N.a)(),q={code:"",name:"",is_active:!0,phone:"",country:0,region:0,district:0,address:"",created_by:(null==y?void 0:y.id)||0,logo:void 0},{control:D,handleSubmit:O,reset:R,watch:E,formState:{isSubmitting:T,errors:z}}=(0,Z.cI)({defaultValues:q}),[F,I]=(0,t.useState)(null),[Q,L]=(0,t.useState)(null),G=(0,t.useRef)(null),{data:V=[]}=(0,a.z)(d.Z.country,{limit:100}),{data:A=[]}=(0,a.z)(d.Z.region,{limit:100}),M=E("region"),B=M?"".concat(d.Z.district,"?region=").concat(M):d.Z.district,{data:H=[]}=(0,a.z)(B,{limit:200});(0,t.useEffect)(()=>{"edit"===s&&c?(R(c),L(c.logo||null)):(R(q),L(null)),I(null)},[s,c,R]),(0,t.useEffect)(()=>{if(F){let e=URL.createObjectURL(F);return L(e),()=>URL.revokeObjectURL(e)}},[F]);let U=async e=>{try{if("create"===s){if(F){let n=new FormData;n.append("logo",F),n.append("code",e.code),n.append("name",e.name),n.append("phone",e.phone),n.append("country",e.country.toString()),n.append("region",e.region.toString()),n.append("district",e.district.toString()),n.append("address",e.address),await l.Do.postForm(d.Z.company,n)}else await l.Do.post(d.Z.company,e)}else if("edit"===s&&(null==c?void 0:c.id)){if(F){let n=new FormData;n.append("logo",F),n.append("code",e.code),n.append("name",e.name),n.append("phone",e.phone),n.append("country",e.country.toString()),n.append("region",e.region.toString()),n.append("district",e.district.toString()),n.append("address",e.address),n.append("is_active",e.is_active.toString()),await l.Do.putForm(d.Z.companyById(c.id),n)}else delete e.logo,await l.Do.put(d.Z.companyById(c.id),e);window.location.reload()}_.ZP.success(String(m("company.toast.saved"))),o(),r()}catch(e){console.error("Failed to save company:",e),_.ZP.error(String(m("company.toast.saveError")))}};return(0,i.jsxs)(x.Z,{open:n,onClose:T?void 0:r,fullWidth:!0,maxWidth:"md",children:[(0,i.jsx)(h.Z,{children:"create"===s?String(m("company.create.title")):String(m("company.edit.title"))}),(0,i.jsxs)("form",{onSubmit:O(U),children:[(0,i.jsx)(g.Z,{children:(0,i.jsxs)(f.ZP,{container:!0,spacing:4,children:[(0,i.jsx)(f.ZP,{item:!0,xs:12,children:(0,i.jsxs)(w.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,i.jsx)(p.Z,{variant:"body2",sx:{mb:1},children:String(m("company.table.logo"))}),(0,i.jsx)(k.Z,{src:Q||void 0,variant:"circular",sx:{width:100,height:100,cursor:"pointer",borderColor:"primary.main","& img":{width:"100%",height:"100%",objectFit:"contain"}},onClick:()=>{var e;return null===(e=G.current)||void 0===e?void 0:e.click()},children:!Q&&(0,i.jsx)(j.Z,{icon:"tabler:camera-plus"})}),(0,i.jsx)("input",{type:"file",ref:G,style:{display:"none"},accept:"image/*",onChange:e=>{var n;return I((null===(n=e.target.files)||void 0===n?void 0:n[0])||null)}})]})}),(0,i.jsx)(f.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)(Z.Qr,{name:"code",control:D,rules:{required:String(m("errors.required"))},render:e=>{var n;let{field:r}=e;return(0,i.jsx)(C.Z,{fullWidth:!0,label:String(m("company.form.code")),...r,error:!!z.code,helperText:null===(n=z.code)||void 0===n?void 0:n.message})}})}),(0,i.jsx)(f.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)(Z.Qr,{name:"name",control:D,rules:{required:String(m("errors.required"))},render:e=>{var n;let{field:r}=e;return(0,i.jsx)(C.Z,{fullWidth:!0,label:String(m("company.form.name")),...r,error:!!z.name,helperText:null===(n=z.name)||void 0===n?void 0:n.message})}})}),(0,i.jsx)(f.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)(Z.Qr,{name:"phone",control:D,render:e=>{let{field:n}=e;return(0,i.jsx)(C.Z,{fullWidth:!0,label:String(m("company.form.phone")),...n})}})}),(0,i.jsx)(f.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)(Z.Qr,{name:"address",control:D,render:e=>{let{field:n}=e;return(0,i.jsx)(C.Z,{fullWidth:!0,label:String(m("company.form.address")),...n})}})}),(0,i.jsx)(f.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)(Z.Qr,{name:"country",control:D,rules:{required:String(m("errors.required"))},render:e=>{let{field:n,fieldState:r}=e;return(0,i.jsx)(P.Z,{options:V,value:V.find(e=>e.id===n.value)||null,onChange:(e,r)=>{var i;return n.onChange(null!==(i=null==r?void 0:r.id)&&void 0!==i?i:0)},isOptionEqualToValue:(e,n)=>e.id===n.id,getOptionLabel:e=>(null==e?void 0:e.name)||"",renderInput:e=>{var n;return(0,i.jsx)(C.Z,{...e,fullWidth:!0,label:String(m("company.form.country")),error:!!r.error,helperText:null===(n=r.error)||void 0===n?void 0:n.message})}})}})}),(0,i.jsx)(f.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)(Z.Qr,{name:"region",control:D,rules:{required:String(m("errors.required"))},render:e=>{let{field:n,fieldState:r}=e;return(0,i.jsx)(P.Z,{options:A,value:A.find(e=>e.id===n.value)||null,onChange:(e,r)=>{var i;return n.onChange(null!==(i=null==r?void 0:r.id)&&void 0!==i?i:0)},isOptionEqualToValue:(e,n)=>e.id===n.id,getOptionLabel:e=>(null==e?void 0:e.name)||"",renderInput:e=>{var n;return(0,i.jsx)(C.Z,{...e,fullWidth:!0,label:String(m("company.form.region")),error:!!r.error,helperText:null===(n=r.error)||void 0===n?void 0:n.message})}})}})}),(0,i.jsx)(f.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)(Z.Qr,{name:"district",control:D,rules:{required:String(m("errors.required"))},render:e=>{let{field:n,fieldState:r}=e;return(0,i.jsx)(P.Z,{options:H,value:H.find(e=>e.id===n.value)||null,onChange:(e,r)=>{var i;return n.onChange(null!==(i=null==r?void 0:r.id)&&void 0!==i?i:0)},isOptionEqualToValue:(e,n)=>e.id===n.id,getOptionLabel:e=>(null==e?void 0:e.name)||"",renderInput:e=>{var n;return(0,i.jsx)(C.Z,{...e,fullWidth:!0,label:String(m("company.form.district")),error:!!r.error,helperText:null===(n=r.error)||void 0===n?void 0:n.message})}})}})}),(0,i.jsx)(f.ZP,{item:!0,xs:6,children:(0,i.jsx)(Z.Qr,{name:"is_active",control:D,render:e=>{let{field:n}=e;return(0,i.jsx)(b.Z,{control:(0,i.jsx)(S.Z,{checked:!!n.value,onChange:(e,r)=>n.onChange(r)}),label:String(m("company.form.active"))})}})})]})}),(0,i.jsxs)(v.Z,{children:[(0,i.jsx)(u.Z,{type:"button",variant:"tonal",color:"secondary",onClick:r,disabled:T,children:String(m("common.cancel"))}),(0,i.jsx)(u.Z,{type:"submit",disabled:T,children:T?String(m("common.saving")):String(m("common.save"))})]})]})]})},D=r(97182),O=r(30381),R=r.n(O),E=e=>{var n,r,o;let{open:a,onClose:s,id:c}=e,{t:m}=(0,W.$G)(),[y,j]=(0,t.useState)(null),[Z,S]=(0,t.useState)(!1);return(0,t.useEffect)(()=>{(async()=>{if(c&&a){S(!0);try{let e=await l.Do.get(d.Z.companyById(c));j(e.data)}finally{S(!1)}}})()},[c,a]),(0,i.jsxs)(x.Z,{open:a,onClose:s,maxWidth:"md",fullWidth:!0,children:[(0,i.jsx)(h.Z,{children:String(m("company.view.title"))}),(0,i.jsx)(g.Z,{children:Z?(0,i.jsx)(w.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",py:8},children:(0,i.jsx)(D.Z,{})}):y?(0,i.jsxs)(f.ZP,{container:!0,spacing:4,children:[(0,i.jsx)(f.ZP,{item:!0,xs:12,md:4,children:(0,i.jsxs)(w.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,i.jsx)(k.Z,{src:"".concat("https://api-doc.optivora-group.com").concat(y.logo),variant:"rounded",sx:{width:200,height:200,"& img":{width:"100%",height:"100%",objectFit:"contain"}}}),(0,i.jsx)(p.Z,{variant:"h6",sx:{mt:2},children:y.name})]})}),(0,i.jsx)(f.ZP,{item:!0,xs:12,md:8,children:(0,i.jsxs)(f.ZP,{container:!0,spacing:2,children:[(0,i.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,i.jsx)(p.Z,{variant:"body2",color:"text.secondary",children:String(m("company.form.code"))}),(0,i.jsx)(p.Z,{variant:"body1",children:y.code})]}),(0,i.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,i.jsx)(p.Z,{variant:"body2",color:"text.secondary",children:String(m("company.form.name"))}),(0,i.jsx)(p.Z,{variant:"body1",children:y.name})]}),(0,i.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,i.jsx)(p.Z,{variant:"body2",color:"text.secondary",children:String(m("company.form.active"))}),(0,i.jsx)(p.Z,{variant:"body1",children:y.is_active?String(m("common.yes")):String(m("common.no"))})]}),(0,i.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,i.jsx)(p.Z,{variant:"body2",color:"text.secondary",children:String(m("company.form.phone"))}),(0,i.jsx)(p.Z,{variant:"body1",children:y.phone})]}),(0,i.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,i.jsx)(p.Z,{variant:"body2",color:"text.secondary",children:String(m("company.form.country"))}),(0,i.jsx)(p.Z,{variant:"body1",children:null===(n=y.country_detail)||void 0===n?void 0:n.name})]}),(0,i.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,i.jsx)(p.Z,{variant:"body2",color:"text.secondary",children:String(m("company.form.region"))}),(0,i.jsx)(p.Z,{variant:"body1",children:null===(r=y.region_detail)||void 0===r?void 0:r.name_uz})]}),(0,i.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,i.jsx)(p.Z,{variant:"body2",color:"text.secondary",children:String(m("company.form.district"))}),(0,i.jsx)(p.Z,{variant:"body1",children:null===(o=y.district_detail)||void 0===o?void 0:o.name_uz})]}),(0,i.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,i.jsx)(p.Z,{variant:"body2",color:"text.secondary",children:String(m("company.form.address"))}),(0,i.jsx)(p.Z,{variant:"body1",children:y.address})]}),(0,i.jsxs)(f.ZP,{item:!0,xs:12,sm:6,children:[(0,i.jsx)(p.Z,{variant:"body2",color:"text.secondary",children:String(m("common.createdAt"))}),(0,i.jsx)(p.Z,{variant:"body1",children:R()(y.created_time).format("DD.MM.YYYY HH:mm")})]})]})})]}):(0,i.jsx)(p.Z,{color:"text.secondary",children:String(m("common.notFound"))})}),(0,i.jsx)(v.Z,{children:(0,i.jsx)(u.Z,{onClick:s,children:String(m("common.close"))})})]})},T=r(55421),z=r(82071),F=()=>{(0,o.useRouter)();let{t:e}=(0,W.$G)(),[n,r]=(0,t.useState)({page:0,pageSize:10}),{data:Z=[],loading:f,mutate:S,total:b}=(0,a.z)(d.Z.company,{limit:n.pageSize,page:n.page+1}),[w,C]=(0,t.useState)(!1),[P,_]=(0,t.useState)(null),[N,D]=(0,t.useState)(!1),[O,R]=(0,t.useState)(null),[F,I]=(0,t.useState)(!1),[Q,L]=(0,t.useState)(null),G=e=>{_(e),C(!0)},V=e=>{L(e),I(!0)},A=async()=>{Q&&(await l.Do.delete(d.Z.companyById(Q.id)),S(),I(!1),L(null))},M=[{field:"code",headerName:String(e("company.table.code")),flex:.15,minWidth:120},{field:"name",headerName:String(e("company.table.name")),flex:.25,minWidth:180},{field:"is_active",headerName:String(e("company.table.active")),flex:.1,minWidth:100,valueGetter:n=>n.row.is_active?String(e("common.yes")):String(e("common.no"))},{field:"phone",headerName:String(e("company.table.phone")),flex:.2,minWidth:160},{field:"country",headerName:String(e("company.form.country")),flex:.12,minWidth:120,valueGetter:e=>{var n;return(null===(n=e.row.country_detail)||void 0===n?void 0:n.name)||e.row.country}},{field:"region",headerName:String(e("company.table.region")),flex:.12,minWidth:120,valueGetter:e=>{var n;return(null===(n=e.row.region_detail)||void 0===n?void 0:n.name_uz)||e.row.region}},{field:"district",headerName:String(e("company.table.district")),flex:.12,minWidth:120,valueGetter:e=>{var n;return(null===(n=e.row.district_detail)||void 0===n?void 0:n.name_uz)||e.row.district}},{field:"address",headerName:String(e("company.table.address")),flex:.3,minWidth:220},{field:"logo",headerName:String(e("company.table.logo")),flex:.15,minWidth:140,renderCell:e=>{let n=e.row;return(0,i.jsx)(k.Z,{src:n.logo,variant:"circular",sx:{width:38,height:38,borderRadius:"50%","& img":{width:"100%",height:"100%",objectFit:"cover"}},children:(0,T.Q)(n.name)})}},{field:"actions",headerName:String(e("common.actions")),sortable:!1,flex:.15,minWidth:140,renderCell:e=>{let n=e.row;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.Z,{"aria-label":"view",onClick:()=>{R(n.id),D(!0)},children:(0,i.jsx)(j.Z,{icon:"tabler:eye"})}),(0,i.jsx)(s.Z,{"aria-label":"edit",onClick:()=>G(n),children:(0,i.jsx)(j.Z,{icon:"tabler:edit"})}),(0,i.jsx)(s.Z,{"aria-label":"delete",color:"error",onClick:()=>V(n),children:(0,i.jsx)(j.Z,{icon:"tabler:trash"})})]})}}];return(0,i.jsxs)(c.Z,{children:[(0,i.jsx)(m.Z,{title:String(e("company.title")),action:(0,i.jsx)(u.Z,{variant:"contained",onClick:()=>{_(null),C(!0)},children:String(e("common.create"))})}),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(y._,{autoHeight:!0,rowHeight:56,rows:Z,columns:M,loading:f,disableRowSelectionOnClick:!0,pageSizeOptions:[10,25,50],paginationModel:n,onPaginationModelChange:r,getRowId:e=>e.id,localeText:(0,z.x)(e),rowCount:b})}),w&&(0,i.jsx)(q,{open:w,onClose:()=>C(!1),onSaved:S,mode:P?"edit":"create",item:P||void 0}),N&&(0,i.jsx)(E,{open:N,onClose:()=>D(!1),id:O}),(0,i.jsxs)(x.Z,{open:F,onClose:()=>I(!1),children:[(0,i.jsx)(h.Z,{children:String(e("common.deleteConfirm.title"))}),(0,i.jsx)(g.Z,{children:(0,i.jsxs)(p.Z,{children:[String(e("common.deleteConfirm.description")),' "',null==Q?void 0:Q.name,'"?']})}),(0,i.jsxs)(v.Z,{children:[(0,i.jsx)(u.Z,{onClick:()=>I(!1),children:String(e("common.cancel"))}),(0,i.jsx)(u.Z,{onClick:A,color:"error",variant:"contained",children:String(e("common.delete"))})]})]})]})},I=()=>(0,i.jsx)(F,{})}},function(e){e.O(0,[4885,2785,7536,7605,2888,9774,179],function(){return e(e.s=49144)}),_N_E=e.O()}]);