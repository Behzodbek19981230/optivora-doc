(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3689],{89032:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tasks",function(){return i(90337)}])},82071:function(e,t,i){"use strict";i.d(t,{x:function(){return a}});let a=e=>({noRowsLabel:String(e("common.datagrid.noRows",{defaultValue:"No rows"})),MuiTablePagination:{labelRowsPerPage:String(e("common.datagrid.rowsPerPage",{defaultValue:"Rows per page:"})),labelDisplayedRows:t=>{let{from:i,to:a,count:n}=t;return"".concat(i,"–").concat(a," ").concat(String(e("common.datagrid.of",{defaultValue:"of"}))," ").concat(-1!==n?n:">".concat(a))}}})},33251:function(e,t,i){"use strict";i.d(t,{z:function(){return l}});var a=i(30202),n=i(33934),r=i(52293);let l=function(e){var t,i;let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=(0,a.NL)(),o=["list",e,l],d=Object.fromEntries(Object.entries(l).filter(e=>{let[,t]=e;return void 0!==t})),{data:c,isLoading:u,error:m}=(0,n.a)({queryKey:o,queryFn:async()=>{var t,i,a;let n=(await r.Do.get(e,d)).data,l=Array.isArray(n)?n:null!==(i=null==n?void 0:n.results)&&void 0!==i?i:[],s=Array.isArray(n)?l.length:null!==(a=null==n?void 0:null===(t=n.pagination)||void 0===t?void 0:t.total)&&void 0!==a?a:l.length;return{items:l,total:s}},staleTime:3e4});return{data:null!==(t=null==c?void 0:c.items)&&void 0!==t?t:[],total:null!==(i=null==c?void 0:c.total)&&void 0!==i?i:0,loading:u,error:m,mutate:()=>{s.invalidateQueries({queryKey:o})}}}},90337:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return O}});var a=i(85893),n=i(60762),r=i(34375),l=i(71919),s=i(67294),o=i(84166),d=i(21038),c=i(52857),u=i(51015),m=i(33453),h=i(92365),g=i(40110),x=i(96788),p=i(68573),f=i(81359),j=i(90642),v=i(96727),k=i(28634),Z=i(74538),b=i(33251),S=i(75673),y=i(41664),w=i.n(y),_=i(11163),C=i(22120),N=i(52293),P=i(58898),R=i(34273),W=i(82071),z=i(30381),E=i.n(z);let H=e=>{if(!e)return"—";let t=E()(e);return t.isValid()?t.format("DD.MM.YYYY HH:mm"):String(e)};var M=()=>{var e;let[t,i]=(0,s.useState)({page:0,pageSize:10}),r=(0,_.useRouter)(),{t:y}=(0,C.$G)(),z=(0,P.Z)(),{user:E}=(0,R.a)(),[M,O]=(0,s.useState)(!1),[D,T]=(0,s.useState)("task"),[A,I]=(0,s.useState)(!1),{data:V=[],total:Y,loading:F}=(0,b.z)(Z.Z.task,{page:t.page+1,limit:t.pageSize}),G=[{field:"id",headerName:String(y("common.id")),width:90},{field:"name",headerName:String(y("tasks.table.name")),flex:.3,minWidth:180},{field:"status",headerName:String(y("tasks.table.status")),flex:.2,minWidth:140},{field:"type",headerName:String(y("tasks.table.type")),flex:.15,minWidth:120},{field:"priority",headerName:String(y("tasks.table.priority")),flex:.15,minWidth:120},{field:"start_date",headerName:String(y("tasks.table.start")),flex:.15,minWidth:160,renderCell:e=>H(e.row.start_date)},{field:"end_date",headerName:String(y("tasks.table.end")),flex:.15,minWidth:160,renderCell:e=>H(e.row.end_date)},{field:"actions",headerName:String(y("common.actions")),width:120,sortable:!1,renderCell:e=>{let t=e.row.id;return(0,a.jsxs)(o.Z,{direction:"row",spacing:1,children:[(0,a.jsx)(d.Z,{title:String(y("common.view")),children:(0,a.jsx)(c.Z,{size:"small",component:w(),href:"/tasks/view/".concat(t),children:(0,a.jsx)(S.Z,{icon:"tabler:eye"})})}),(0,a.jsx)(d.Z,{title:String(y("common.edit")),children:(0,a.jsx)(c.Z,{size:"small",component:w(),href:"/tasks/update/".concat(t),children:(0,a.jsx)(S.Z,{icon:"tabler:pencil"})})})]})}}];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.Z,{direction:"row",justifyContent:"flex-end",sx:{mb:2},children:(null==E?void 0:null===(e=E.role_detail)||void 0===e?void 0:e.some(e=>"Performer"!==e.name))&&(0,a.jsx)(u.Z,{variant:"contained",startIcon:(0,a.jsx)(S.Z,{icon:"tabler:plus"}),onClick:()=>O(!0),children:String(y("tasks.create.title"))})}),(0,a.jsxs)(m.Z,{open:M,onClose:A?void 0:()=>O(!1),fullWidth:!0,maxWidth:"sm",children:[(0,a.jsx)(h.Z,{children:String(y("tasks.create.modal.title"))}),(0,a.jsxs)(g.Z,{children:[(0,a.jsx)(x.Z,{variant:"body2",sx:{color:"text.secondary",mb:4},children:String(y("tasks.create.modal.subtitle"))}),(0,a.jsxs)(p.ZP,{container:!0,spacing:3,children:[(0,a.jsx)(p.ZP,{item:!0,xs:12,sm:6,children:(0,a.jsx)(n.Z,{variant:"outlined",sx:{borderColor:"task"===D?"primary.main":"divider",bgcolor:"task"===D?"primary.lighter":"background.paper"},children:(0,a.jsx)(f.Z,{onClick:()=>T("task"),children:(0,a.jsxs)(l.Z,{sx:{height:100},children:[(0,a.jsxs)(j.Z,{sx:{display:"flex",alignItems:"center",gap:2,mb:1},children:[(0,a.jsx)(S.Z,{icon:"tabler:clipboard-list"}),(0,a.jsx)(x.Z,{variant:"h6",children:String(y("tasks.type.task"))})]}),(0,a.jsx)(x.Z,{variant:"body2",sx:{color:"text.secondary"},children:String(y("tasks.create.modal.taskHint"))})]})})})}),(0,a.jsx)(p.ZP,{item:!0,xs:12,sm:6,children:(0,a.jsx)(n.Z,{variant:"outlined",sx:{borderColor:"application"===D?"primary.main":"divider",bgcolor:"application"===D?"primary.lighter":"background.paper"},children:(0,a.jsx)(f.Z,{onClick:()=>T("application"),children:(0,a.jsxs)(l.Z,{sx:{height:100},children:[(0,a.jsxs)(j.Z,{sx:{display:"flex",alignItems:"center",gap:2,mb:1},children:[(0,a.jsx)(S.Z,{icon:"tabler:file-text"}),(0,a.jsx)(x.Z,{variant:"h6",children:String(y("tasks.type.application"))})]}),(0,a.jsx)(x.Z,{variant:"body2",sx:{color:"text.secondary"},children:String(y("tasks.create.modal.applicationHint"))})]})})})})]})]}),(0,a.jsxs)(v.Z,{children:[(0,a.jsx)(u.Z,{variant:"tonal",color:"secondary",onClick:()=>O(!1),disabled:A,children:String(y("common.cancel"))}),(0,a.jsx)(u.Z,{variant:"contained",onClick:async()=>{try{var e;I(!0);let t=await N.Do.post(Z.Z.task,{type:D,status:"new",company:null==E?void 0:E.company_id}),i=null===(e=t.data)||void 0===e?void 0:e.id;z.success(String(y("tasks.toast.created"))),O(!1),i&&r.push("/tasks/update/".concat(i))}catch(e){z.error((null==e?void 0:e.message)||String(y("tasks.toast.createError")))}finally{I(!1)}},disabled:A,children:A?String(y("common.creating")):String(y("common.create"))})]})]}),(0,a.jsx)(k._,{autoHeight:!0,rowHeight:56,rows:V,columns:G,loading:F,rowCount:Y,paginationMode:"server",disableRowSelectionOnClick:!0,pageSizeOptions:[10,25,50],paginationModel:t,onPaginationModelChange:i,getRowId:e=>e.id,localeText:(0,W.x)(y)})]})},O=()=>{let{t:e}=(0,C.$G)();return(0,a.jsxs)(n.Z,{children:[(0,a.jsx)(r.Z,{title:String(e("tasks.title"))}),(0,a.jsx)(l.Z,{children:(0,a.jsx)(M,{})})]})}}},function(e){e.O(0,[3934,8634,7197,2888,9774,179],function(){return e(e.s=89032)}),_N_E=e.O()}]);