"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7555],{1652:function(e,t,r){r.d(t,{cP:function(){return a}});var i=r(77527);let a=(0,i.ZP)("div")(e=>{let{theme:t}=e;return{"& .rdw-editor-wrapper":{border:"1px solid ".concat(t.palette.divider),"& .rdw-editor-toolbar":{border:0,marginBottom:0,background:t.palette.background.paper,borderBottom:"1px solid ".concat(t.palette.divider),"& .rdw-fontsize-dropdown":{minWidth:50},"& .rdw-link-modal":{height:"auto"},"& .rdw-colorpicker-modal, & .rdw-link-modal, & .rdw-embedded-modal, & .rdw-emoji-modal, & .rdw-image-modal":{boxShadow:t.shadows[8],borderColor:t.palette.divider,backgroundColor:t.palette.background.paper},"& .rdw-dropdown-optionwrapper":{boxShadow:t.shadows[8],borderColor:t.palette.divider,backgroundColor:t.palette.background.paper,"& .rdw-dropdownoption-highlighted":{backgroundColor:t.palette.action.hover},"& .rdw-dropdownoption-active":{backgroundColor:t.palette.action.selected}},"& .rdw-option-wrapper, & .rdw-dropdown-wrapper":{borderRadius:"4px !important",borderColor:t.palette.divider,background:t.palette.background.paper,"& .rdw-dropdown-carettoopen":{left:"auto",right:"10%",borderTopColor:t.palette.text.disabled},"& .rdw-dropdown-carettoclose":{left:"auto",right:"10%",borderBottomColor:t.palette.text.disabled},..."dark"===t.palette.mode?{"& img":{filter:"invert(1)"}}:{},"&:hover":{boxShadow:"none",backgroundColor:"rgba(".concat(t.palette.customColors.main,", 0.08)")}},"& .rdw-embedded-modal-size-input, & .rdw-image-modal-size-input":{width:"60%",minHeight:30},"& .rdw-link-modal-input, & .rdw-embedded-modal-link-input, & .rdw-image-modal-url-input":{minHeight:38},"& .rdw-link-modal-input, & .rdw-embedded-modal-link-input, & .rdw-image-modal-url-input, & .rdw-embedded-modal-size-input, & .rdw-image-modal-size-input":{background:"none",padding:t.spacing(0,3.5),color:t.palette.text.primary,borderColor:t.palette.divider,borderRadius:t.shape.borderRadius,fontSize:t.typography.body1.fontSize,"&:focus":{borderColor:t.palette.primary.main},"&::placeholder, &:-ms-input-placeholder, &::-ms-input-placeholder":{color:t.palette.text.disabled}},"& .rdw-link-modal-btn, & .rdw-embedded-modal-btn, & .rdw-image-modal-btn":{border:0,lineHeight:1.71,borderRadius:"5px",letterSpacing:"0.3px",textTransform:"uppercase",fontWeight:t.typography.fontWeightMedium,"&:first-of-type:not([disabled])":{boxShadow:t.shadows[3],color:t.palette.primary.contrastText,backgroundColor:t.palette.primary.main,"&:hover":{boxShadow:t.shadows[4],backgroundColor:t.palette.primary.dark},"&:active":{boxShadow:t.shadows[3]}},"&:last-child":{boxShadow:t.shadows[3],color:t.palette.secondary.contrastText,backgroundColor:t.palette.secondary.main,"&:hover":{boxShadow:t.shadows[4],backgroundColor:t.palette.secondary.dark},"&:active":{boxShadow:t.shadows[3]}},"&[disabled]":{cursor:"default",boxShadow:"none",color:t.palette.text.disabled,backgroundColor:t.palette.action.disabledBackground}}},"& .rdw-editor-main":{cursor:"text",padding:"0 1rem",minHeight:"10rem",color:t.palette.text.primary,..."rtl"===t.direction?{"& .public-DraftStyleDefault-block":{direction:"ltr !important",textAlign:"left !important"}}:{}}}}});(0,i.ZP)("div")(()=>({"& .rdw-editor-wrapper":{display:"flex",flexDirection:"column-reverse"}})),(0,i.ZP)("div")(()=>({"& .rdw-editor-wrapper, & .rdw-editor-toolbar":{border:"0 !important"}}))},73138:function(e,t,r){r.d(t,{Z:function(){return l}});var i=r(85893),a=r(5152);let n=r.n(a)()(()=>r.e(6925).then(r.t.bind(r,35108,23)).then(e=>e.Editor),{loadableGenerated:{webpack:()=>[35108]},ssr:!1});var l=e=>(0,i.jsx)(n,{editorState:e.editorState,onEditorStateChange:t=>e.onEditorStateChange(t)})},33971:function(e,t,r){var i=r(85893),a=r(37958),n=r(73907),l=r(77527),o=r(52857),s=r(96788),d=r(90642),c=r(67294),u=r(52293),p=r(74538),m=r(86501),h=r(34273),x=r(22120),g=r(7879),v=r(76592),b=r(70360),w=r(46577),k=r(8863),f=r(19827),Z=r(65806),j=r(13539),y=r(21038);r(80135);var S=r(75673),C=r(1652),_=r(73138),D=r(9041);let P=(0,l.ZP)(d.Z)(e=>{let{theme:t}=e;return{display:"flex",alignItems:"center",padding:t.spacing(6),justifyContent:"space-between"}});t.Z=e=>{var t,r,l;let{open:R,toggle:z,taskId:F,partId:q,part:E,task:I}=e,{user:L}=(0,h.a)(),{t:T}=(0,x.$G)(),[W,B]=c.useState(D.EditorState.createEmpty()),[G,A]=c.useState([]),[H,M]=c.useState(!1),[U,Y]=c.useState({comment:"",file:""}),N=e=>A(t=>t.filter((t,r)=>r!==e)),$=(e,t)=>A(r=>r.map((r,i)=>i===e?{...r,isLink:t,link:t?r.link:"",file:t?null:r.file}:r)),K=(e,t)=>A(r=>r.map((r,i)=>i===e?{...r,link:t}:r)),O=(e,t)=>A(r=>r.map((r,i)=>i===e?{...r,file:t}:r));c.useEffect(()=>{R&&0===G.length&&A([{isLink:!1,link:"",file:null}])},[R]);let V=()=>{B(D.EditorState.createEmpty()),A([]),Y({comment:"",file:""})},J=async()=>{if(!F){m.ZP.error(String(T("tasks.view.actions.toasts.taskRequired")||"Task id required"));return}let e=W.getCurrentContent().hasText(),t=G.some(e=>{var t;return e.isLink?!!(null===(t=e.link)||void 0===t?void 0:t.trim()):!!e.file});if(e)Y(e=>({...e,comment:""}));else{Y(e=>({...e,comment:String(T("tasks.view.actions.toasts.commentRequired")||"Comment is required")}));return}if(t)Y(e=>({...e,file:""}));else{Y(e=>({...e,file:String(T("tasks.view.actions.toasts.fileRequired")||"Attachment is required")}));return}try{if(M(!0),e&&await u.Do.post(p.Z.taskComment,{part:null!=q?q:null,author:null==L?void 0:L.id,text:W.getCurrentContent().getPlainText()}),t){let e=G.filter(e=>e.isLink?e.link.trim().length:!!e.file);if(!e.length){m.ZP.error(String(T("tasks.view.actions.toasts.fileRequired")||"Attachment is required"));return}for(let t of e){var r,i;let e=new FormData;e.append("title",""),e.append("link",t.isLink?t.link.trim():""),e.append("part",q?q.toString():""),e.append("uploaded_by",null!==(i=null==L?void 0:null===(r=L.id)||void 0===r?void 0:r.toString())&&void 0!==i?i:""),!t.isLink&&t.file&&e.append("file",t.file),await u.Do.postForm(p.Z.taskAttachment,e)}}await u.Do.patch(p.Z.taskPartById(null!=q?q:null),{status:"on_review",task:F}),m.ZP.success(String(T("tasks.view.actions.toasts.saved")||"Saved")),V(),z()}catch(e){console.error("Failed to submit combined from drawer",e),m.ZP.error(String(T("tasks.view.actions.toasts.saveError")||"Failed to save"))}finally{M(!1),V()}},Q=async()=>{if(W.getCurrentContent().hasText())Y(e=>({...e,comment:""}));else{Y(e=>({...e,comment:String(T("tasks.view.actions.toasts.commentRequired")||"Comment is required")}));return}try{M(!0),await u.Do.patch(p.Z.taskPartById(null!=q?q:null),{status:"returned",task:F}),m.ZP.success(String(T("tasks.view.actions.toasts.resend")||"Resend"))}catch(e){console.error("Failed to resend combined",e),m.ZP.error(String(T("tasks.view.actions.toasts.resendError")||"Failed to resend"))}finally{M(!1),V(),z()}},X=async()=>{if(W.getCurrentContent().hasText())Y(e=>({...e,comment:""}));else{Y(e=>({...e,comment:String(T("tasks.view.actions.toasts.commentRequired")||"Comment is required")}));return}try{M(!0),await u.Do.patch(p.Z.taskPartById(null!=q?q:null),{status:"cancelled",task:F}),m.ZP.success(String(T("tasks.view.actions.toasts.cancel")||"Cancel"))}catch(e){console.error("Failed to cancel combined",e)}finally{M(!1),V(),z()}},ee=async()=>{if(W.getCurrentContent().hasText())Y(e=>({...e,comment:""}));else{Y(e=>({...e,comment:String(T("tasks.view.actions.toasts.commentRequired")||"Comment is required")}));return}try{M(!0),await u.Do.patch(p.Z.taskPartById(null!=q?q:null),{status:"done",task:F}),m.ZP.success(String(T("tasks.view.actions.toasts.done")||"Done"))}catch(e){console.error("Failed to complete combined",e)}finally{M(!1),V(),z()}};return(0,i.jsxs)(a.ZP,{open:R,anchor:"right",variant:"temporary",onClose:z,sx:{"& .MuiDrawer-paper":{width:[420,760]}},ModalProps:{keepMounted:!0},children:[(0,i.jsxs)(P,{children:[(0,i.jsx)(s.Z,{variant:"h5",children:String(T("tasks.view.actions.drawerTitle")||"Send / Execute")}),(0,i.jsx)(o.Z,{size:"small",onClick:z,sx:{p:"0.375rem",borderRadius:1,color:"text.primary",backgroundColor:"action.selected","&:hover":{backgroundColor:e=>"rgba(".concat(e.palette.customColors.main,", 0.16)")}},children:(0,i.jsx)(S.Z,{icon:"tabler:x",fontSize:"1.25rem"})})]}),(0,i.jsx)(d.Z,{sx:{p:e=>e.spacing(0,6,6)},children:(0,i.jsxs)(d.Z,{children:[(null==L?void 0:L.id)===(null==E?void 0:null===(t=E.assignee_detail)||void 0===t?void 0:t.id)&&q&&((null==E?void 0:E.status)==="new"||(null==E?void 0:E.status)==="in_progress"||(null==E?void 0:E.status)==="returned")&&(0,i.jsxs)(d.Z,{sx:{my:2,display:"flex",flexDirection:"column",gap:2},children:[(0,i.jsx)(s.Z,{variant:"subtitle2",children:String(T("tasks.view.actions.attachmentDialog.title")||"")}),(0,i.jsxs)(v.Z,{size:"small",children:[(0,i.jsx)(b.Z,{children:(0,i.jsxs)(w.Z,{children:[(0,i.jsx)(k.Z,{children:String(T("common.file")||"File")}),(0,i.jsx)(k.Z,{align:"right",children:String(T("common.actions")||"Actions")})]})}),(0,i.jsx)(f.Z,{children:G.map((e,t)=>(0,i.jsxs)(w.Z,{children:[(0,i.jsxs)(k.Z,{sx:{width:"90%"},children:[(0,i.jsx)(Z.Z,{control:(0,i.jsx)(j.Z,{checked:e.isLink,onChange:e=>$(t,e.target.checked)}),label:e.isLink?"Link":"File"}),e.isLink?(0,i.jsx)(g.Z,{fullWidth:!0,size:"small",label:String(T("common.link",{defaultValue:"Link"})),value:e.link,onChange:e=>K(t,e.target.value)}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.Z,{component:"label",variant:"outlined",size:"small",startIcon:(0,i.jsx)(S.Z,{icon:"tabler:upload"}),children:[String(T("tasks.view.actions.attachmentDialog.chooseFile")||"Choose file"),(0,i.jsx)("input",{hidden:!0,type:"file",onChange:e=>{var r;return O(t,(null===(r=e.target.files)||void 0===r?void 0:r[0])||null)}})]}),(0,i.jsx)(s.Z,{variant:"caption",sx:{display:"block",mt:1},color:"text.secondary",children:e.file?e.file.name:String(T("tasks.view.actions.attachmentDialog.noFileSelected")||"No file selected")})]})]}),(0,i.jsx)(k.Z,{align:"right",children:(0,i.jsx)(y.Z,{title:String(T("common.delete")||"Delete"),children:(0,i.jsx)(o.Z,{size:"small",color:"error",onClick:()=>N(t),children:(0,i.jsx)(S.Z,{icon:"mdi:delete"})})})})]},t))})]}),(0,i.jsx)(d.Z,{children:(0,i.jsx)(n.Z,{variant:"text",size:"small",startIcon:(0,i.jsx)(S.Z,{icon:"mdi:plus"}),onClick:()=>A(e=>[...e,{isLink:!1,link:"",file:null}]),children:String(T("tasks.view.actions.attachmentDialog.addRow")||"Add file")})}),U.file?(0,i.jsx)(s.Z,{color:"error",variant:"caption",sx:{mb:1},children:U.file}):null]}),(0,i.jsxs)(C.cP,{children:[(0,i.jsx)("div",{style:{marginBottom:8,fontWeight:500},children:String(T("commands.form.basis"))}),(0,i.jsx)(_.Z,{editorState:W,onEditorStateChange:e=>{B(e)}}),(0,i.jsx)(s.Z,{color:"error",variant:"caption",sx:{mb:1},children:U.comment})]}),(null==L?void 0:L.id)==(null==E?void 0:null===(r=E.assignee_detail)||void 0===r?void 0:r.id)&&q&&((null==E?void 0:E.status)==="new"||(null==E?void 0:E.status)==="in_progress"||(null==E?void 0:E.status)==="returned")&&(0,i.jsxs)(d.Z,{sx:{display:"flex",gap:2,mt:20},children:[(0,i.jsx)(n.Z,{variant:"contained",onClick:J,disabled:H,children:String(T("tasks.view.actions.drawer.executeCombined")||"Bajarish")}),(0,i.jsx)(n.Z,{variant:"outlined",color:"secondary",onClick:()=>V(),disabled:H,children:String(T("common.clear")||"Clear")})]}),(null==L?void 0:L.id)===(null==I?void 0:null===(l=I.signed_by_detail)||void 0===l?void 0:l.id)&&q&&(null==E?void 0:E.status)!=="new"&&(null==E?void 0:E.status)!=="in_progress"&&(null==E?void 0:E.status)!=="returned"&&(0,i.jsxs)(d.Z,{sx:{display:"flex",flexWrap:"wrap",gap:2,mt:20},children:[(0,i.jsx)(n.Z,{variant:"contained",color:"warning",onClick:Q,disabled:H,children:String(T("tasks.view.actions.resendForReview")||"Resend for review")}),(0,i.jsx)(n.Z,{variant:"contained",color:"error",onClick:X,disabled:H,children:String(T("tasks.view.actions.cancel")||String(T("common.cancel"))||"Cancel")}),(0,i.jsx)(n.Z,{variant:"contained",onClick:ee,disabled:H,children:String(T("tasks.view.actions.done")||"Done")})]})]})})]})}},15822:function(e,t,r){r.d(t,{Z:function(){return q}});var i=r(85893),a=r(67294),n=r(84166),l=r(14934),o=r(96788),s=r(60762),d=r(71919),c=r(90642),u=r(81873),p=r(47407),m=r(19304),h=r(21038),x=r(52857),g=r(87590),v=r(32200),b=r(61769),w=r(56912),k=r(21201),f=r(33934),Z=r(75673),j=r(52293),y=r(74538),S=r(22120),C=r(30381),_=r.n(C);let D=e=>{let t=(e.file||"").trim(),r=(e.link||"").trim();if(!t&&!r)return"Fayl #".concat(e.id);try{let e=(t||r).split("?")[0],i=e.split("/");return decodeURIComponent(i[i.length-1]||e)}catch(e){return t||r}},P=e=>{let t=(e||"").toLowerCase().split("?")[0],r=t.split(".").pop();return r&&r!==t?r:""},R=e=>{switch(e){case"pdf":return"tabler:file-type-pdf";case"doc":case"docx":return"tabler:file-type-doc";case"xls":case"xlsx":return"tabler:file-type-xls";case"ppt":case"pptx":return"tabler:file-type-ppt";case"png":case"jpg":case"jpeg":case"webp":case"gif":return"tabler:photo";case"zip":case"rar":case"7z":return"tabler:archive";default:return"tabler:file"}},z=e=>{let t=(e.link||"").trim(),r=(e.file||"").trim();return t||r||"#"},F=e=>(e.link||"").trim()&&!(e.file||"").trim()?"tabler:link":R(P(String(e.file||e.link||"")));function q(e){let{taskId:t,partId:r,isCompact:C}=e,{t:R}=(0,S.$G)(),{data:q,isLoading:E,isError:I}=(0,f.a)({queryKey:["task-attachments",t,void 0===r?"all":r],queryFn:async()=>{let e={task:t,limit:50};return void 0!==r&&(e.part=null===r?"":r),(await j.Do.get(y.Z.taskAttachment,e)).data||{results:[]}},enabled:!!t||!!r,staleTime:1e4}),L=(null==q?void 0:q.results)||[];return E?(0,i.jsxs)(n.Z,{spacing:2,children:[(0,i.jsx)(l.Z,{variant:"text",width:"30%"}),(0,i.jsx)(l.Z,{variant:"rectangular",height:64,sx:{borderRadius:2}}),(0,i.jsx)(l.Z,{variant:"rectangular",height:64,sx:{borderRadius:2}}),(0,i.jsx)(l.Z,{variant:"rectangular",height:64,sx:{borderRadius:2}})]}):I?(0,i.jsx)(o.Z,{variant:"body2",color:"error",children:String(R("tasks.view.attachments.loadError"))}):L.length?C?(0,i.jsx)(s.Z,{variant:"outlined",sx:{mb:2},children:(0,i.jsx)(d.Z,{sx:{py:"0.75rem !important"},children:(0,i.jsxs)(n.Z,{direction:"row",spacing:3,alignItems:"center",flexWrap:"wrap",useFlexGap:!0,children:[(0,i.jsxs)(o.Z,{variant:"subtitle2",sx:{mr:2},children:[String(R("tasks.view.attachments.title")),":"]}),L.map(e=>{let t=D(e),r=F(e),a=z(e);return(0,i.jsx)(u.Z,{icon:(0,i.jsx)(Z.Z,{icon:r}),label:t,component:"a",href:a,target:"_blank",clickable:!0,size:"small",variant:"outlined",color:"primary"},e.id)})]})})}):(0,i.jsx)(s.Z,{children:(0,i.jsxs)(d.Z,{children:[(0,i.jsxs)(c.Z,{sx:{mb:2,display:"flex",alignItems:"center",justifyContent:"space-between",gap:2},children:[(0,i.jsx)(o.Z,{variant:"subtitle2",children:String(R("tasks.view.attachments.title"))}),(0,i.jsx)(u.Z,{size:"small",color:"info",label:String(R("tasks.view.attachments.count",{count:L.length}))})]}),(0,i.jsx)(p.Z,{disablePadding:!0,children:L.map((e,t)=>{var r,l,s;let d=D(e),c=F(e),p=e.created_time||e.created_at||e.updated_time||e.updated_at,f=p?_()(p).format("DD.MM.YYYY HH:mm"):"",j=(null===(r=e.uploaded_by_detail)||void 0===r?void 0:r.fullname)||(null===(l=e.created_by_detail)||void 0===l?void 0:l.fullname)||("number"==typeof e.uploaded_by?"#".concat(e.uploaded_by):"number"==typeof e.created_by?"#".concat(e.created_by):""),y=z(e);return(0,i.jsxs)(a.Fragment,{children:[(0,i.jsxs)(m.ZP,{disableGutters:!0,secondaryAction:y&&"#"!==y?(0,i.jsx)(h.Z,{title:String(R("tasks.view.attachments.openOrDownload")),children:(0,i.jsx)(x.Z,{component:"a",href:y,target:"_blank",rel:"noreferrer",children:(0,i.jsx)(Z.Z,{icon:"tabler:download"})})}):null,sx:{py:1.25,px:1,borderRadius:2,"&:hover":{backgroundColor:e=>e.palette.action.hover}},children:[(0,i.jsx)(g.Z,{children:(0,i.jsx)(k.Z,{variant:"rounded",sx:{width:40,height:40,bgcolor:e=>e.palette.action.selected,color:"text.primary"},children:(0,i.jsx)(Z.Z,{icon:c})})}),(0,i.jsx)(v.Z,{primary:(0,i.jsxs)(n.Z,{direction:"row",spacing:1,sx:{alignItems:"center",flexWrap:"wrap",rowGap:1},children:[y&&"#"!==y?(0,i.jsx)(b.Z,{href:y,target:"_blank",rel:"noreferrer",underline:"hover",color:"inherit",children:(0,i.jsx)(o.Z,{variant:"subtitle2",sx:{fontWeight:600},children:d})}):(0,i.jsx)(o.Z,{variant:"subtitle2",sx:{fontWeight:600},children:d}),(()=>{let t=P(String(e.file||e.link||""));return t?(0,i.jsx)(u.Z,{size:"small",variant:"outlined",label:t.toUpperCase()}):null})(),e.part?(0,i.jsx)(u.Z,{size:"small",variant:"outlined",label:String(R("tasks.view.attachments.partLabel",{id:e.part}))}):null]}),secondary:(0,i.jsxs)(n.Z,{direction:"row",spacing:1,sx:{alignItems:"center",flexWrap:"wrap",rowGap:.5},children:[f?(0,i.jsx)(o.Z,{variant:"caption",color:"text.secondary",children:f}):null,j?(0,i.jsx)(o.Z,{variant:"caption",color:"text.secondary",children:String(R("tasks.view.attachments.uploader",{name:j}))}):null]})})]}),t<L.length-1?(0,i.jsx)(w.Z,{sx:{my:1}}):null]},null!==(s=e.id)&&void 0!==s?s:t)})})]})}):C?null:(0,i.jsx)(s.Z,{children:(0,i.jsx)(d.Z,{children:(0,i.jsx)(c.Z,{sx:{py:2},children:(0,i.jsx)(o.Z,{variant:"body2",color:"text.secondary",children:String(R("tasks.view.attachments.empty"))})})})})}},96145:function(e,t,r){r.d(t,{Z:function(){return y}});var i=r(85893),a=r(67294),n=r(84166),l=r(14934),o=r(96788),s=r(60762),d=r(71919),c=r(90642),u=r(81873),p=r(47407),m=r(19304),h=r(87590),x=r(21201),g=r(32200),v=r(56912),b=r(33934),w=r(75673),k=r(52293),f=r(74538),Z=r(22120);let j=e=>{var t,r;let i=(e||"").trim();if(!i)return"?";let a=i.split(" ").filter(Boolean);return(((null===(t=a[0])||void 0===t?void 0:t[0])||"")+((null===(r=a[1])||void 0===r?void 0:r[0])||"")).toUpperCase()||i[0].toUpperCase()};function y(e){let{taskId:t,partId:r}=e,{t:y}=(0,Z.$G)(),{data:S,isLoading:C,isError:_}=(0,b.a)({queryKey:["task-comments",t,null!=r?r:null],queryFn:async()=>{let e={task:null!=t?t:"",limit:50};return null!=r&&(e.part=r),(await k.Do.get(f.Z.taskComment,e)).data||{results:[]}},enabled:!!t||!!r,staleTime:1e4}),D=(null==S?void 0:S.results)||[];return C?(0,i.jsxs)(n.Z,{spacing:2,children:[(0,i.jsx)(l.Z,{variant:"text",width:"25%"}),(0,i.jsx)(l.Z,{variant:"rectangular",height:72,sx:{borderRadius:2}}),(0,i.jsx)(l.Z,{variant:"rectangular",height:72,sx:{borderRadius:2}}),(0,i.jsx)(l.Z,{variant:"rectangular",height:72,sx:{borderRadius:2}})]}):_?(0,i.jsx)(o.Z,{variant:"body2",color:"error",children:String(y("tasks.view.comments.loadError"))}):D.length?(0,i.jsx)(s.Z,{children:(0,i.jsxs)(d.Z,{children:[(0,i.jsxs)(c.Z,{sx:{mb:2,display:"flex",alignItems:"center",justifyContent:"space-between",gap:2},children:[(0,i.jsx)(o.Z,{variant:"subtitle2",children:String(y("tasks.view.comments.title"))}),(0,i.jsx)(u.Z,{size:"small",color:"info",label:String(y("tasks.view.comments.count",{count:D.length}))})]}),(0,i.jsx)(p.Z,{disablePadding:!0,children:D.map((e,t)=>{var r,l;let s=e.created_at?new Date(e.created_at).toLocaleString():"",d=e.is_system?String(y("tasks.view.comments.system")):"".concat(null===(r=e.author_detail)||void 0===r?void 0:r.fullname);return(0,i.jsxs)(a.Fragment,{children:[(0,i.jsxs)(m.ZP,{disableGutters:!0,alignItems:"flex-start",sx:{py:1.25,px:1,borderRadius:2,"&:hover":{backgroundColor:e=>e.palette.action.hover}},children:[(0,i.jsx)(h.Z,{children:(0,i.jsx)(x.Z,{sx:{width:40,height:40,bgcolor:t=>e.is_system?t.palette.grey[200]:t.palette.primary.light,color:t=>e.is_system?t.palette.text.primary:t.palette.primary.contrastText},children:e.is_system?(0,i.jsx)(w.Z,{icon:"tabler:settings"}):j(d)})}),(0,i.jsx)(g.Z,{primary:(0,i.jsxs)(n.Z,{direction:"row",spacing:1,sx:{alignItems:"center",flexWrap:"wrap",rowGap:1},children:[(0,i.jsx)(o.Z,{variant:"subtitle2",sx:{fontWeight:700},children:d}),e.is_system?(0,i.jsx)(u.Z,{size:"small",color:"default",variant:"outlined",label:String(y("tasks.view.comments.system"))}):null,e.part?(0,i.jsx)(u.Z,{size:"small",variant:"outlined",label:String(y("tasks.view.comments.partLabel",{id:e.part}))}):null,s?(0,i.jsxs)(o.Z,{variant:"caption",sx:{color:"text.disabled"},children:["• ",s]}):null]}),secondary:(0,i.jsx)(o.Z,{variant:"body2",color:"text.secondary",sx:{mt:.5,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:e.text||"—"})})]}),t<D.length-1?(0,i.jsx)(v.Z,{sx:{my:1}}):null]},null!==(l=e.id)&&void 0!==l?l:t)})})]})}):(0,i.jsx)(s.Z,{children:(0,i.jsx)(d.Z,{children:(0,i.jsx)(o.Z,{variant:"body2",color:"text.secondary",children:String(y("tasks.view.comments.empty"))})})})}}}]);