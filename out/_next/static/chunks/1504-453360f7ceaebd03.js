"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1504],{82071:function(e,t,a){a.d(t,{x:function(){return r}});let r=e=>({noRowsLabel:String(e("common.datagrid.noRows",{defaultValue:"No rows"})),MuiTablePagination:{labelRowsPerPage:String(e("common.datagrid.rowsPerPage",{defaultValue:"Rows per page:"})),labelDisplayedRows:t=>{let{from:a,to:r,count:n}=t;return"".concat(a,"â€“").concat(r," ").concat(String(e("common.datagrid.of",{defaultValue:"of"}))," ").concat(-1!==n?n:">".concat(r))}}})},33251:function(e,t,a){a.d(t,{z:function(){return l}});var r=a(30202),n=a(33934),i=a(52293);let l=function(e){var t,a;let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!(arguments.length>2)||void 0===arguments[2]||arguments[2],s=(0,r.NL)(),d=["list",e,l],c=Object.fromEntries(Object.entries(l).filter(e=>{let[,t]=e;return void 0!==t})),{data:u,isLoading:m,error:h}=(0,n.a)({queryKey:d,queryFn:async()=>{var t,a,r;let n=(await i.Do.get(e,c)).data,l=Array.isArray(n)?n:null!==(a=null==n?void 0:n.results)&&void 0!==a?a:[],o=Array.isArray(n)?l.length:null!==(r=null==n?void 0:null===(t=n.pagination)||void 0===t?void 0:t.total)&&void 0!==r?r:l.length;return{items:l,total:o}},enabled:o,staleTime:3e4});return{data:null!==(t=null==u?void 0:u.items)&&void 0!==t?t:[],total:null!==(a=null==u?void 0:u.total)&&void 0!==a?a:0,loading:m,error:h,mutate:()=>{s.invalidateQueries({queryKey:d})}}}},31504:function(e,t,a){var r=a(85893),n=a(67294),i=a(81873),l=a(90642),o=a(84166),s=a(21038),d=a(52857),c=a(60762),u=a(71919),m=a(73907),h=a(33453),g=a(92365),x=a(40110),p=a(96788),v=a(68573),f=a(81359),b=a(96727),y=a(16127),Z=a(11163),j=a(75673),S=a(33251),w=a(74538),k=a(41664),C=a.n(k),_=a(22120),N=a(52293),P=a(58898),W=a(34273),z=a(82071),M=a(30381),D=a.n(M);let H=e=>{switch(e){case"new":case"cancelled":return"error";case"in_progress":return"primary";case"on_review":case"returned":return"warning";case"done":return"success";case"archive":return"secondary";default:return"default"}};t.Z=e=>{var t;let{status:a,ownerFilter:k}=e,M=(0,Z.useRouter)(),{t:R}=(0,_.$G)(),[Y,V]=(0,n.useState)({page:0,pageSize:10}),E=(0,P.Z)(),{user:A}=(0,W.a)(),[I,O]=(0,n.useState)(!1),[B,L]=(0,n.useState)("task"),[T,F]=(0,n.useState)(!1),q="mine"===k?w.Z.taskSelf:w.Z.task,G={page:Y.page+1,limit:Y.pageSize,status:a},{data:Q=[],total:$,loading:J}=(0,S.z)(q,G),K=async e=>{if(confirm(String(R("documents.table.archiveConfirm"))))try{await N.Do.delete(w.Z.taskById(e.toString())),E.success(String(R("documents.table.archiveSuccess"))),M.replace(M.asPath)}catch(e){E.error((null==e?void 0:e.message)||String(R("documents.table.archiveError")))}},U=[{field:"input_doc_number",headerName:String(R("tasks.form.inputDocNumber")),flex:.2,minWidth:150},{field:"name",headerName:String(R("documents.table.name")),flex:.3,minWidth:180},{field:"status",headerName:String(R("documents.table.status")),flex:.2,minWidth:140,renderCell:e=>{let t=e.row.status;return(0,r.jsx)(i.Z,{label:R("documents.status.".concat(t)),color:H(t),size:"small",variant:"outlined"})}},{field:"created_by",headerName:String(R("tasks.form.signedBy",{defaultValue:"Signed by"})),flex:.2,minWidth:150,renderCell:e=>{let t=e.row.signed_by_detail;return(0,r.jsx)(l.Z,{sx:{width:"100%",whiteSpace:"normal",wordBreak:"break-word",overflowWrap:"anywhere",lineHeight:1.2},children:t?"".concat(t.fullname):""})}},{field:"type",headerName:String(R("documents.table.type")),flex:.15,minWidth:120,renderCell:e=>{let t=e.row.type;return R("tasks.type.".concat(t))}},{field:"priority",headerName:String(R("documents.table.priority")),flex:.15,minWidth:120,renderCell:e=>{let t=e.row.priority;return t?(0,r.jsx)(i.Z,{label:R("tasks.priority.".concat(t)),color:"ordinary"===t?"primary":"warning",size:"small"}):""}},{field:"start_date",headerName:String(R("documents.table.start")),flex:.15,minWidth:130,renderCell:e=>{let t=e.row.start_date;return D()(t).isValid()?D()(t).format("DD.MM.YYYY HH:mm"):""}},{field:"end_date",headerName:String(R("documents.table.end")),flex:.15,minWidth:130,renderCell:e=>{let t=e.row.end_date;return D()(t).isValid()?D()(t).format("DD.MM.YYYY HH:mm"):""}},{field:"actions",headerName:String(R("common.actions")),width:120,sortable:!1,renderCell:e=>{var t,n;let i=e.row.id;return(0,r.jsxs)(o.Z,{direction:"row",spacing:1,children:[(0,r.jsx)(s.Z,{title:String(R("common.view")),children:(0,r.jsx)(d.Z,{size:"small",component:C(),href:"/tasks/view/".concat(i),children:(0,r.jsx)(j.Z,{icon:"tabler:eye"})})}),["new"].includes(a)&&(null==A?void 0:null===(t=A.role_detail)||void 0===t?void 0:t.some(e=>"Manager"===e.name))&&(0,r.jsx)(s.Z,{title:String(R("common.edit")),children:(0,r.jsx)(d.Z,{size:"small",component:C(),href:"/tasks/update/".concat(i),children:(0,r.jsx)(j.Z,{icon:"tabler:pencil"})})}),(null==A?void 0:null===(n=A.role_detail)||void 0===n?void 0:n.some(e=>"Manager"===e.name))&&(0,r.jsx)(s.Z,{title:String(R("documents.table.archive")),children:(0,r.jsx)(d.Z,{size:"small",onClick:()=>K(i),children:(0,r.jsx)(j.Z,{icon:"tabler:archive"})})})]})}}];return(0,r.jsx)(c.Z,{variant:"outlined",children:(0,r.jsxs)(u.Z,{sx:{pb:0},children:["archive"!==a&&(0,r.jsx)(o.Z,{direction:"row",justifyContent:"flex-end",sx:{mb:2},children:(null==A?void 0:null===(t=A.role_detail)||void 0===t?void 0:t.some(e=>"Performer"!==e.name))&&(0,r.jsx)(m.Z,{variant:"contained",onClick:()=>O(!0),children:String(R("tasks.create.title"))})}),(0,r.jsxs)(h.Z,{open:I,onClose:T?void 0:()=>O(!1),fullWidth:!0,maxWidth:"sm",children:[(0,r.jsx)(g.Z,{children:String(R("tasks.create.modal.title"))}),(0,r.jsxs)(x.Z,{children:[(0,r.jsx)(p.Z,{variant:"body2",sx:{color:"text.secondary",mb:4},children:String(R("tasks.create.modal.subtitle"))}),(0,r.jsxs)(v.ZP,{container:!0,spacing:3,children:[(0,r.jsx)(v.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(c.Z,{variant:"outlined",sx:{borderColor:"task"===B?"primary.main":"divider",bgcolor:"task"===B?"primary.lighter":"background.paper"},children:(0,r.jsx)(f.Z,{onClick:()=>L("task"),children:(0,r.jsxs)(u.Z,{sx:{height:100},children:[(0,r.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",gap:2,mb:1},children:[(0,r.jsx)(j.Z,{icon:"tabler:clipboard-list"}),(0,r.jsx)(p.Z,{variant:"h6",children:String(R("tasks.type.task"))})]}),(0,r.jsx)(p.Z,{variant:"body2",sx:{color:"text.secondary"},children:String(R("tasks.create.modal.taskHint"))})]})})})}),(0,r.jsx)(v.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(c.Z,{variant:"outlined",sx:{borderColor:"application"===B?"primary.main":"divider",bgcolor:"application"===B?"primary.lighter":"background.paper"},children:(0,r.jsx)(f.Z,{onClick:()=>L("application"),children:(0,r.jsxs)(u.Z,{sx:{height:100},children:[(0,r.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",gap:2,mb:1},children:[(0,r.jsx)(j.Z,{icon:"tabler:file-text"}),(0,r.jsx)(p.Z,{variant:"h6",children:String(R("tasks.type.application"))})]}),(0,r.jsx)(p.Z,{variant:"body2",sx:{color:"text.secondary"},children:String(R("tasks.create.modal.applicationHint"))})]})})})})]})]}),(0,r.jsxs)(b.Z,{children:[(0,r.jsx)(m.Z,{variant:"tonal",color:"secondary",onClick:()=>O(!1),disabled:T,children:String(R("common.cancel"))}),(0,r.jsx)(m.Z,{variant:"contained",onClick:async()=>{try{var e;F(!0);let t=await N.Do.post(w.Z.task,{type:B,status:"new",company:null==A?void 0:A.company_id}),a=null===(e=t.data)||void 0===e?void 0:e.id;E.success(String(R("tasks.toast.created"))),O(!1),a&&M.push("/tasks/update/".concat(a))}catch(e){E.error((null==e?void 0:e.message)||String(R("tasks.toast.createError")))}finally{F(!1)}},disabled:T,children:T?String(R("common.creating")):String(R("common.create"))})]})]}),(0,r.jsx)(y._,{autoHeight:!0,rowHeight:56,rows:Q,columns:U,loading:J,rowCount:$,paginationMode:"server",disableRowSelectionOnClick:!0,pageSizeOptions:[10,25,50],paginationModel:Y,onPaginationModelChange:V,getRowId:e=>e.id,localeText:{...(0,z.x)(R),noRowsLabel:String(R("documents.table.emptyForStatus",{status:a}))}})]})})}}}]);