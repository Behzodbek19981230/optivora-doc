"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1504],{82071:function(e,t,r){r.d(t,{x:function(){return a}});let a=e=>({noRowsLabel:String(e("common.datagrid.noRows",{defaultValue:"No rows"})),MuiTablePagination:{labelRowsPerPage:String(e("common.datagrid.rowsPerPage",{defaultValue:"Rows per page:"})),labelDisplayedRows:t=>{let{from:r,to:a,count:n}=t;return"".concat(r,"â€“").concat(a," ").concat(String(e("common.datagrid.of",{defaultValue:"of"}))," ").concat(-1!==n?n:">".concat(a))}}})},33251:function(e,t,r){r.d(t,{z:function(){return l}});var a=r(30202),n=r(33934),i=r(52293);let l=function(e){var t,r;let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=!(arguments.length>2)||void 0===arguments[2]||arguments[2],o=(0,a.NL)(),d=["list",e,l],c=Object.fromEntries(Object.entries(l).filter(e=>{let[,t]=e;return void 0!==t})),{data:u,isLoading:m,error:h}=(0,n.a)({queryKey:d,queryFn:async()=>{var t,r,a;let n=(await i.Do.get(e,c)).data,l=Array.isArray(n)?n:null!==(r=null==n?void 0:n.results)&&void 0!==r?r:[],s=Array.isArray(n)?l.length:null!==(a=null==n?void 0:null===(t=n.pagination)||void 0===t?void 0:t.total)&&void 0!==a?a:l.length;return{items:l,total:s}},enabled:s,staleTime:3e4});return{data:null!==(t=null==u?void 0:u.items)&&void 0!==t?t:[],total:null!==(r=null==u?void 0:u.total)&&void 0!==r?r:0,loading:m,error:h,mutate:()=>{o.invalidateQueries({queryKey:d})}}}},31504:function(e,t,r){var a=r(85893),n=r(67294),i=r(81873),l=r(90642),s=r(84166),o=r(21038),d=r(52857),c=r(60762),u=r(71919),m=r(73907),h=r(33453),g=r(92365),x=r(40110),p=r(96788),v=r(68573),f=r(81359),b=r(96727),y=r(16127),S=r(11163),Z=r(75673),j=r(33251),w=r(74538),k=r(41664),C=r.n(k),_=r(22120),N=r(52293),z=r(58898),M=r(34273),P=r(82071),W=r(30381),D=r.n(W);let H=e=>{switch(e){case"new":case"cancelled":return"error";case"in_progress":return"primary";case"on_review":case"returned":return"warning";case"done":return"success";case"archive":return"secondary";default:return"default"}};t.Z=e=>{var t;let{status:r,ownerFilter:k}=e,W=(0,S.useRouter)(),{t:R}=(0,_.$G)(),[Y,E]=(0,n.useState)({page:0,pageSize:10}),V=(0,z.Z)(),{user:I}=(0,M.a)(),[A,B]=(0,n.useState)(!1),[O,L]=(0,n.useState)("task"),[T,F]=(0,n.useState)(!1),q="mine"===k?w.Z.taskSelf:w.Z.task,G={page:Y.page+1,limit:Y.pageSize,status:r},{data:Q=[],total:$,loading:J}=(0,j.z)(q,G),K=async e=>{if(confirm(String(R("documents.table.archiveConfirm"))))try{await N.Do.patch(w.Z.taskById(e.toString())+"/archive/"),V.success(String(R("documents.table.archiveSuccess"))),W.replace(W.asPath)}catch(e){V.error((null==e?void 0:e.message)||String(R("documents.table.archiveError")))}},U=async e=>{if(confirm(String(R("documents.table.deleteConfirm"))))try{await N.Do.delete(w.Z.taskById(e.toString())),V.success(String(R("documents.table.deleteSuccess")))}catch(e){V.error((null==e?void 0:e.message)||String(R("documents.table.deleteError")))}},X=[{field:"input_doc_number",headerName:String(R("tasks.form.inputDocNumber")),flex:.2,minWidth:150},{field:"name",headerName:String(R("documents.table.name")),flex:.3,minWidth:180},{field:"status",headerName:String(R("documents.table.status")),flex:.2,minWidth:140,renderCell:e=>{let t=e.row.status;return(0,a.jsx)(i.Z,{label:R("documents.status.".concat(t)),color:H(t),size:"small",variant:"outlined"})}},{field:"created_by",headerName:String(R("tasks.form.signedBy",{defaultValue:"Signed by"})),flex:.2,minWidth:150,renderCell:e=>{let t=e.row.signed_by_detail;return(0,a.jsx)(l.Z,{sx:{width:"100%",whiteSpace:"normal",wordBreak:"break-word",overflowWrap:"anywhere",lineHeight:1.2},children:t?"".concat(t.fullname):""})}},{field:"type",headerName:String(R("documents.table.type")),flex:.15,minWidth:120,renderCell:e=>{let t=e.row.type;return R("tasks.type.".concat(t))}},{field:"priority",headerName:String(R("documents.table.priority")),flex:.15,minWidth:120,renderCell:e=>{let t=e.row.priority;return t?(0,a.jsx)(i.Z,{label:R("tasks.priority.".concat(t)),color:"ordinary"===t?"primary":"warning",size:"small"}):""}},{field:"start_date",headerName:String(R("documents.table.start")),flex:.15,minWidth:130,renderCell:e=>{let t=e.row.start_date;return D()(t).isValid()?D()(t).format("DD.MM.YYYY HH:mm"):""}},{field:"end_date",headerName:String(R("documents.table.end")),flex:.15,minWidth:130,renderCell:e=>{let t=e.row.end_date;return D()(t).isValid()?D()(t).format("DD.MM.YYYY HH:mm"):""}},{field:"actions",headerName:String(R("common.actions")),width:120,sortable:!1,renderCell:e=>{var t,n,i;let l=e.row.id;return(0,a.jsxs)(s.Z,{direction:"row",spacing:1,children:[(0,a.jsx)(o.Z,{title:String(R("common.view")),children:(0,a.jsx)(d.Z,{size:"small",component:C(),href:"/tasks/view/".concat(l),children:(0,a.jsx)(Z.Z,{icon:"tabler:eye"})})}),["new"].includes(r)&&(null==I?void 0:null===(t=I.role_detail)||void 0===t?void 0:t.some(e=>"Manager"===e.name))&&(0,a.jsx)(o.Z,{title:String(R("common.edit")),children:(0,a.jsx)(d.Z,{size:"small",component:C(),href:"/tasks/update/".concat(l),children:(0,a.jsx)(Z.Z,{icon:"tabler:pencil"})})}),(null==I?void 0:null===(n=I.role_detail)||void 0===n?void 0:n.some(e=>"Manager"===e.name))&&!["archive"].includes(r)&&(0,a.jsx)(o.Z,{title:String(R("documents.table.archive")),children:(0,a.jsx)(d.Z,{size:"small",onClick:()=>K(l),children:(0,a.jsx)(Z.Z,{icon:"tabler:archive"})})}),(null==I?void 0:null===(i=I.role_detail)||void 0===i?void 0:i.some(e=>"Manager"===e.name))&&["new"].includes(r)&&(0,a.jsx)(o.Z,{title:String(R("common.delete")),children:(0,a.jsx)(d.Z,{size:"small",color:"error",onClick:()=>U(l),children:(0,a.jsx)(Z.Z,{icon:"tabler:trash"})})})]})}}];return(0,a.jsx)(c.Z,{variant:"outlined",children:(0,a.jsxs)(u.Z,{sx:{pb:0},children:["archive"!==r&&(0,a.jsx)(s.Z,{direction:"row",justifyContent:"flex-end",sx:{mb:2},children:(null==I?void 0:null===(t=I.role_detail)||void 0===t?void 0:t.some(e=>"Performer"!==e.name))&&(0,a.jsx)(m.Z,{variant:"contained",onClick:()=>B(!0),children:String(R("tasks.create.title"))})}),(0,a.jsxs)(h.Z,{open:A,onClose:T?void 0:()=>B(!1),fullWidth:!0,maxWidth:"sm",children:[(0,a.jsx)(g.Z,{children:String(R("tasks.create.modal.title"))}),(0,a.jsxs)(x.Z,{children:[(0,a.jsx)(p.Z,{variant:"body2",sx:{color:"text.secondary",mb:4},children:String(R("tasks.create.modal.subtitle"))}),(0,a.jsxs)(v.ZP,{container:!0,spacing:3,children:[(0,a.jsx)(v.ZP,{item:!0,xs:12,sm:6,children:(0,a.jsx)(c.Z,{variant:"outlined",sx:{borderColor:"task"===O?"primary.main":"divider",bgcolor:"task"===O?"primary.lighter":"background.paper"},children:(0,a.jsx)(f.Z,{onClick:()=>L("task"),children:(0,a.jsxs)(u.Z,{sx:{height:100},children:[(0,a.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",gap:2,mb:1},children:[(0,a.jsx)(Z.Z,{icon:"tabler:clipboard-list"}),(0,a.jsx)(p.Z,{variant:"h6",children:String(R("tasks.type.task"))})]}),(0,a.jsx)(p.Z,{variant:"body2",sx:{color:"text.secondary"},children:String(R("tasks.create.modal.taskHint"))})]})})})}),(0,a.jsx)(v.ZP,{item:!0,xs:12,sm:6,children:(0,a.jsx)(c.Z,{variant:"outlined",sx:{borderColor:"application"===O?"primary.main":"divider",bgcolor:"application"===O?"primary.lighter":"background.paper"},children:(0,a.jsx)(f.Z,{onClick:()=>L("application"),children:(0,a.jsxs)(u.Z,{sx:{height:100},children:[(0,a.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",gap:2,mb:1},children:[(0,a.jsx)(Z.Z,{icon:"tabler:file-text"}),(0,a.jsx)(p.Z,{variant:"h6",children:String(R("tasks.type.application"))})]}),(0,a.jsx)(p.Z,{variant:"body2",sx:{color:"text.secondary"},children:String(R("tasks.create.modal.applicationHint"))})]})})})})]})]}),(0,a.jsxs)(b.Z,{children:[(0,a.jsx)(m.Z,{variant:"tonal",color:"secondary",onClick:()=>B(!1),disabled:T,children:String(R("common.cancel"))}),(0,a.jsx)(m.Z,{variant:"contained",onClick:async()=>{try{var e;F(!0);let t=await N.Do.post(w.Z.task,{type:O,status:"new",company:null==I?void 0:I.company_id}),r=null===(e=t.data)||void 0===e?void 0:e.id;V.success(String(R("tasks.toast.created"))),B(!1),r&&W.push("/tasks/update/".concat(r))}catch(e){V.error((null==e?void 0:e.message)||String(R("tasks.toast.createError")))}finally{F(!1)}},disabled:T,children:T?String(R("common.creating")):String(R("common.create"))})]})]}),(0,a.jsx)(y._,{autoHeight:!0,rowHeight:56,rows:Q,columns:X,loading:J,rowCount:$,paginationMode:"server",disableRowSelectionOnClick:!0,pageSizeOptions:[10,25,50],paginationModel:Y,onPaginationModelChange:E,getRowId:e=>e.id,localeText:{...(0,P.x)(R),noRowsLabel:String(R("documents.table.emptyForStatus",{status:R("documents.status.".concat(r))}))}})]})})}}}]);