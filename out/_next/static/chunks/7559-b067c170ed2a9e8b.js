"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7559],{60762:function(e,t,r){r.d(t,{Z:function(){return Z}});var a=r(87462),n=r(63366),o=r(67294),i=r(86010),d=r(94780),l=r(77527),s=r(29567),c=r(93454),m=r(1588),u=r(34867);function p(e){return(0,u.Z)("MuiCard",e)}(0,m.Z)("MuiCard",["root"]);var h=r(85893);let g=["className","raised"],x=e=>{let{classes:t}=e;return(0,d.Z)({root:["root"]},p,t)},b=(0,l.ZP)(c.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({overflow:"hidden"}));var Z=o.forwardRef(function(e,t){let r=(0,s.Z)({props:e,name:"MuiCard"}),{className:o,raised:d=!1}=r,l=(0,n.Z)(r,g),c=(0,a.Z)({},r,{raised:d}),m=x(c);return(0,h.jsx)(b,(0,a.Z)({className:(0,i.Z)(m.root,o),elevation:d?8:void 0,ref:t,ownerState:c},l))})},4952:function(e,t,r){r.d(t,{Z:function(){return b}});var a=r(63366),n=r(87462),o=r(67294),i=r(86010),d=r(94780),l=r(77527),s=r(29567),c=r(1588),m=r(34867);function u(e){return(0,m.Z)("MuiCardActions",e)}(0,c.Z)("MuiCardActions",["root","spacing"]);var p=r(85893);let h=["disableSpacing","className"],g=e=>{let{classes:t,disableSpacing:r}=e;return(0,d.Z)({root:["root",!r&&"spacing"]},u,t)},x=(0,l.ZP)("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,!r.disableSpacing&&t.spacing]}})(e=>{let{ownerState:t}=e;return(0,n.Z)({display:"flex",alignItems:"center",padding:8},!t.disableSpacing&&{"& > :not(:first-of-type)":{marginLeft:8}})});var b=o.forwardRef(function(e,t){let r=(0,s.Z)({props:e,name:"MuiCardActions"}),{disableSpacing:o=!1,className:d}=r,l=(0,a.Z)(r,h),c=(0,n.Z)({},r,{disableSpacing:o}),m=g(c);return(0,p.jsx)(x,(0,n.Z)({className:(0,i.Z)(m.root,d),ownerState:c,ref:t},l))})},34375:function(e,t,r){r.d(t,{Z:function(){return j}});var a=r(63366),n=r(87462),o=r(67294),i=r(86010),d=r(94780),l=r(96788),s=r(29567),c=r(77527),m=r(1588),u=r(34867);function p(e){return(0,u.Z)("MuiCardHeader",e)}let h=(0,m.Z)("MuiCardHeader",["root","avatar","action","content","title","subheader"]);var g=r(85893);let x=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],b=e=>{let{classes:t}=e;return(0,d.Z)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},p,t)},Z=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,t)=>(0,n.Z)({["& .".concat(h.title)]:t.title,["& .".concat(h.subheader)]:t.subheader},t.root)})({display:"flex",alignItems:"center",padding:16}),f=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,t)=>t.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),w=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,t)=>t.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),v=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,t)=>t.content})({flex:"1 1 auto"});var j=o.forwardRef(function(e,t){let r=(0,s.Z)({props:e,name:"MuiCardHeader"}),{action:o,avatar:d,className:c,component:m="div",disableTypography:u=!1,subheader:p,subheaderTypographyProps:h,title:j,titleTypographyProps:S}=r,y=(0,a.Z)(r,x),C=(0,n.Z)({},r,{component:m,disableTypography:u}),k=b(C),P=j;null==P||P.type===l.Z||u||(P=(0,g.jsx)(l.Z,(0,n.Z)({variant:d?"body2":"h5",className:k.title,component:"span",display:"block"},S,{children:P})));let E=p;return null==E||E.type===l.Z||u||(E=(0,g.jsx)(l.Z,(0,n.Z)({variant:d?"body2":"body1",className:k.subheader,color:"text.secondary",component:"span",display:"block"},h,{children:E}))),(0,g.jsxs)(Z,(0,n.Z)({className:(0,i.Z)(k.root,c),as:m,ref:t,ownerState:C},y,{children:[d&&(0,g.jsx)(f,{className:k.avatar,ownerState:C,children:d}),(0,g.jsxs)(v,{className:k.content,ownerState:C,children:[P,E]}),o&&(0,g.jsx)(w,{className:k.action,ownerState:C,children:o})]}))})},91194:function(e,t,r){r(67294);var a=r(13077),n=r(85893);t.Z=(0,a.Z)((0,n.jsx)("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft")},59367:function(e,t,r){r(67294);var a=r(13077),n=r(85893);t.Z=(0,a.Z)((0,n.jsx)("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight")},1652:function(e,t,r){r.d(t,{cP:function(){return n}});var a=r(77527);let n=(0,a.ZP)("div")(e=>{let{theme:t}=e;return{"& .rdw-editor-wrapper":{border:"1px solid ".concat(t.palette.divider),"& .rdw-editor-toolbar":{border:0,marginBottom:0,background:t.palette.background.paper,borderBottom:"1px solid ".concat(t.palette.divider),"& .rdw-fontsize-dropdown":{minWidth:50},"& .rdw-link-modal":{height:"auto"},"& .rdw-colorpicker-modal, & .rdw-link-modal, & .rdw-embedded-modal, & .rdw-emoji-modal, & .rdw-image-modal":{boxShadow:t.shadows[8],borderColor:t.palette.divider,backgroundColor:t.palette.background.paper},"& .rdw-dropdown-optionwrapper":{boxShadow:t.shadows[8],borderColor:t.palette.divider,backgroundColor:t.palette.background.paper,"& .rdw-dropdownoption-highlighted":{backgroundColor:t.palette.action.hover},"& .rdw-dropdownoption-active":{backgroundColor:t.palette.action.selected}},"& .rdw-option-wrapper, & .rdw-dropdown-wrapper":{borderRadius:"4px !important",borderColor:t.palette.divider,background:t.palette.background.paper,"& .rdw-dropdown-carettoopen":{left:"auto",right:"10%",borderTopColor:t.palette.text.disabled},"& .rdw-dropdown-carettoclose":{left:"auto",right:"10%",borderBottomColor:t.palette.text.disabled},..."dark"===t.palette.mode?{"& img":{filter:"invert(1)"}}:{},"&:hover":{boxShadow:"none",backgroundColor:"rgba(".concat(t.palette.customColors.main,", 0.08)")}},"& .rdw-embedded-modal-size-input, & .rdw-image-modal-size-input":{width:"60%",minHeight:30},"& .rdw-link-modal-input, & .rdw-embedded-modal-link-input, & .rdw-image-modal-url-input":{minHeight:38},"& .rdw-link-modal-input, & .rdw-embedded-modal-link-input, & .rdw-image-modal-url-input, & .rdw-embedded-modal-size-input, & .rdw-image-modal-size-input":{background:"none",padding:t.spacing(0,3.5),color:t.palette.text.primary,borderColor:t.palette.divider,borderRadius:t.shape.borderRadius,fontSize:t.typography.body1.fontSize,"&:focus":{borderColor:t.palette.primary.main},"&::placeholder, &:-ms-input-placeholder, &::-ms-input-placeholder":{color:t.palette.text.disabled}},"& .rdw-link-modal-btn, & .rdw-embedded-modal-btn, & .rdw-image-modal-btn":{border:0,lineHeight:1.71,borderRadius:"5px",letterSpacing:"0.3px",textTransform:"uppercase",fontWeight:t.typography.fontWeightMedium,"&:first-of-type:not([disabled])":{boxShadow:t.shadows[3],color:t.palette.primary.contrastText,backgroundColor:t.palette.primary.main,"&:hover":{boxShadow:t.shadows[4],backgroundColor:t.palette.primary.dark},"&:active":{boxShadow:t.shadows[3]}},"&:last-child":{boxShadow:t.shadows[3],color:t.palette.secondary.contrastText,backgroundColor:t.palette.secondary.main,"&:hover":{boxShadow:t.shadows[4],backgroundColor:t.palette.secondary.dark},"&:active":{boxShadow:t.shadows[3]}},"&[disabled]":{cursor:"default",boxShadow:"none",color:t.palette.text.disabled,backgroundColor:t.palette.action.disabledBackground}}},"& .rdw-editor-main":{cursor:"text",padding:"0 1rem",minHeight:"10rem",color:t.palette.text.primary,..."rtl"===t.direction?{"& .public-DraftStyleDefault-block":{direction:"ltr !important",textAlign:"left !important"}}:{}}}}});(0,a.ZP)("div")(()=>({"& .rdw-editor-wrapper":{display:"flex",flexDirection:"column-reverse"}})),(0,a.ZP)("div")(()=>({"& .rdw-editor-wrapper, & .rdw-editor-toolbar":{border:"0 !important"}}))},15787:function(e,t,r){var a=r(85893),n=r(67294),o=r(87536),i=r(68573),d=r(51015),l=r(7879),s=r(73138),c=r(9041),m=r(1652),u=r(52293),p=r(74538),h=r(86501),g=r(34273);r(80135);var x=r(11163),b=r(60762),Z=r(34375),f=r(71919),w=r(56912),v=r(84166),j=r(96788),S=r(43374),y=r(28907),C=r(90642),k=r(76592),P=r(70360),E=r(46577),R=r(8863),_=r(19827),z=r(21038),M=r(52857),N=r(4952),T=r(75673),A=r(22120);let W={command_number:"",basis_en:"",basis_uz:"",basis_ru:"",comment_en:"",comment_uz:"",comment_ru:""};t.Z=()=>{let e=(0,x.useRouter)(),{t}=(0,A.$G)(),{id:r}=e.query,{user:B}=(0,g.a)(),[F,H]=(0,n.useState)("uz"),V=r?"edit":"create",D=r?parseInt(r,10):null,{control:I,handleSubmit:Q,reset:q,formState:{isSubmitting:L,errors:U}}=(0,o.cI)({defaultValues:W}),[G,K]=(0,n.useState)([]),[O,$]=(0,n.useState)([]),[J,X]=(0,n.useState)(!1),[Y,ee]=(0,n.useState)(c.EditorState.createEmpty()),[et,er]=(0,n.useState)(c.EditorState.createEmpty()),[ea,en]=(0,n.useState)(c.EditorState.createEmpty()),eo=(0,n.useCallback)(async()=>{if("edit"===V&&D)try{let e=(await u.Do.get(p.Z.commandById(D))).data;q(e),ee(c.EditorState.createWithContent(c.ContentState.createFromText(e.comment_en||""))),er(c.EditorState.createWithContent(c.ContentState.createFromText(e.comment_uz||""))),en(c.EditorState.createWithContent(c.ContentState.createFromText(e.comment_ru||"")));try{let e=(await u.Do.get(p.Z.downloads+"?command=".concat(D))).data,t=(null==e?void 0:e.results)||e||[];K(t.map(e=>{var t,r,a;return{id:Number(e.id),title:String(e.title||""),file:null!==(a=null!==(r=null!==(t=e.file)&&void 0!==t?t:e.file_url)&&void 0!==r?r:e.url)&&void 0!==a?a:null,created_time:e.created_time}}))}catch(e){K([])}$([])}catch(e){console.error("Failed to fetch command data:",e)}else q(W),ee(c.EditorState.createEmpty()),er(c.EditorState.createEmpty()),en(c.EditorState.createEmpty()),K([]),$([])},[D,V,q]);(0,n.useEffect)(()=>{eo()},[eo]);let ei=async a=>{try{let n={...a,company:(null==B?void 0:B.company_id)||0};if("create"===V){let t=await u.Do.post(p.Z.command,n);e.push("/commands/".concat(t.data.id))}else"edit"===V&&r&&await u.Do.put(p.Z.commandById(r),n);h.ZP.success(String(t("commands.toast.saved")))}catch(e){console.error("Failed to save command:",e)}},ed=e=>$(t=>t.filter((t,r)=>r!==e)),el=(e,t)=>$(r=>r.map((r,a)=>a===e?{...r,file:t}:r)),es=async e=>{try{if(e.file){window.open(String(e.file),"_blank","noopener,noreferrer");return}await u.Do.downloadFile(p.Z.downloadById(e.id),e.title||"command-file-".concat(e.id))}catch(e){console.error(e),h.ZP.error(String(t("commands.attachments.toast.downloadError",{defaultValue:"Failed to download file"})))}},ec=async()=>{if(!D)return;let e=O.filter(e=>e.file);if(!e.length)return h.ZP.error(String(t("commands.attachments.validation.fileRequired")));try{for(let t of(X(!0),e)){let e=new FormData;e.append("command",String(D)),e.append("title",""),t.file&&e.append("file",t.file),await u.Do.postForm(p.Z.downloads,e)}h.ZP.success(String(t("commands.attachments.toast.uploaded"))),$([]),eo()}catch(e){console.error(e),h.ZP.error(String(t("commands.attachments.toast.uploadError")))}finally{X(!1)}};return(0,a.jsxs)(b.Z,{children:[(0,a.jsx)(Z.Z,{title:"create"===V?String(t("commands.create.title")):String(t("commands.edit.title"))}),(0,a.jsxs)("form",{onSubmit:Q(ei),children:[(0,a.jsx)(f.Z,{children:(0,a.jsxs)(i.ZP,{container:!0,spacing:4,children:[(0,a.jsx)(i.ZP,{item:!0,xs:12,md:6,children:(0,a.jsx)(o.Qr,{name:"command_number",control:I,rules:{required:String(t("errors.required"))},render:e=>{var r;let{field:n}=e;return(0,a.jsx)(l.Z,{fullWidth:!0,label:String(t("commands.form.number")),...n,error:!!U.command_number,helperText:null===(r=U.command_number)||void 0===r?void 0:r.message})}})}),(0,a.jsxs)(i.ZP,{item:!0,xs:12,children:[(0,a.jsx)(w.Z,{sx:{my:1}}),(0,a.jsxs)(v.Z,{spacing:2,children:[(0,a.jsx)(j.Z,{variant:"subtitle1",children:String(t("commands.form.translations",{defaultValue:"Translations"}))}),(0,a.jsxs)(S.Z,{value:F,onChange:(e,t)=>H(t),variant:"scrollable",scrollButtons:"auto",sx:{minHeight:40},children:[(0,a.jsx)(y.Z,{value:"uz",label:String(t("language.uz",{defaultValue:"Uzbek"}))}),(0,a.jsx)(y.Z,{value:"ru",label:String(t("language.ru",{defaultValue:"Russian"}))}),(0,a.jsx)(y.Z,{value:"en",label:String(t("language.en",{defaultValue:"English"}))})]}),(0,a.jsxs)(C.Z,{children:["uz"===F?(0,a.jsxs)(i.ZP,{container:!0,spacing:3,children:[(0,a.jsx)(i.ZP,{item:!0,xs:12,children:(0,a.jsx)(o.Qr,{name:"basis_uz",control:I,render:e=>{let{field:r}=e;return(0,a.jsx)(l.Z,{fullWidth:!0,multiline:!0,minRows:3,label:String(t("commands.form.basisUz")),...r})}})}),(0,a.jsx)(i.ZP,{item:!0,xs:12,children:(0,a.jsx)(o.Qr,{name:"comment_uz",control:I,render:e=>{let{field:r}=e;return(0,a.jsxs)(m.cP,{children:[(0,a.jsx)("div",{style:{marginBottom:8,fontWeight:500},children:String(t("commands.form.commentUz"))}),(0,a.jsx)(s.Z,{editorState:et,onEditorStateChange:e=>{er(e),r.onChange(e.getCurrentContent().getPlainText())}})]})}})})]}):null,"ru"===F?(0,a.jsxs)(i.ZP,{container:!0,spacing:3,children:[(0,a.jsx)(i.ZP,{item:!0,xs:12,children:(0,a.jsx)(o.Qr,{name:"basis_ru",control:I,render:e=>{let{field:r}=e;return(0,a.jsx)(l.Z,{fullWidth:!0,multiline:!0,minRows:3,label:String(t("commands.form.basisRu")),...r})}})}),(0,a.jsx)(i.ZP,{item:!0,xs:12,children:(0,a.jsx)(o.Qr,{name:"comment_ru",control:I,render:e=>{let{field:r}=e;return(0,a.jsxs)(m.cP,{children:[(0,a.jsx)("div",{style:{marginBottom:8,fontWeight:500},children:String(t("commands.form.commentRu"))}),(0,a.jsx)(s.Z,{editorState:ea,onEditorStateChange:e=>{en(e),r.onChange(e.getCurrentContent().getPlainText())}})]})}})})]}):null,"en"===F?(0,a.jsxs)(i.ZP,{container:!0,spacing:3,children:[(0,a.jsx)(i.ZP,{item:!0,xs:12,children:(0,a.jsx)(o.Qr,{name:"basis_en",control:I,render:e=>{let{field:r}=e;return(0,a.jsx)(l.Z,{fullWidth:!0,multiline:!0,minRows:3,label:String(t("commands.form.basisEn")),...r})}})}),(0,a.jsx)(i.ZP,{item:!0,xs:12,children:(0,a.jsx)(o.Qr,{name:"comment_en",control:I,render:e=>{let{field:r}=e;return(0,a.jsxs)(m.cP,{children:[(0,a.jsx)("div",{style:{marginBottom:8,fontWeight:500},children:String(t("commands.form.commentEn"))}),(0,a.jsx)(s.Z,{editorState:Y,onEditorStateChange:e=>{ee(e),r.onChange(e.getCurrentContent().getPlainText())}})]})}})})]}):null]})]})]}),"edit"===V?(0,a.jsx)(i.ZP,{item:!0,xs:12,children:(0,a.jsxs)(b.Z,{variant:"outlined",children:[(0,a.jsx)(Z.Z,{title:String(t("commands.attachments.title")),subheader:String(t("commands.attachments.subtitle"))}),(0,a.jsx)(f.Z,{children:(0,a.jsxs)(v.Z,{spacing:3,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(j.Z,{variant:"subtitle2",sx:{mb:1},children:String(t("commands.attachments.existing",{defaultValue:"Attached files"}))}),G.length?(0,a.jsxs)(k.Z,{size:"small",children:[(0,a.jsx)(P.Z,{children:(0,a.jsxs)(E.Z,{children:[(0,a.jsx)(R.Z,{children:String(t("commands.attachments.table.file",{defaultValue:"File"}))}),(0,a.jsx)(R.Z,{align:"right",children:String(t("commands.attachments.table.actions",{defaultValue:"Actions"}))})]})}),(0,a.jsx)(_.Z,{children:G.map(e=>(0,a.jsxs)(E.Z,{children:[(0,a.jsx)(R.Z,{children:e.file?String(e.file).split("/").pop():"â€”"}),(0,a.jsx)(R.Z,{align:"right",children:(0,a.jsx)(z.Z,{title:String(t("commands.attachments.actions.download",{defaultValue:"Open / download"})),children:(0,a.jsx)(M.Z,{size:"small",onClick:()=>es(e),children:(0,a.jsx)(T.Z,{icon:"tabler:download"})})})})]},e.id))})]}):(0,a.jsx)(j.Z,{variant:"body2",color:"text.secondary",children:String(t("commands.attachments.empty",{defaultValue:"No attached files"}))})]}),(0,a.jsx)(w.Z,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)(j.Z,{variant:"subtitle2",sx:{mb:1},children:String(t("commands.attachments.addNew",{defaultValue:"Add new files"}))}),(0,a.jsxs)(v.Z,{spacing:2,children:[O.map((e,r)=>(0,a.jsx)(b.Z,{variant:"outlined",children:(0,a.jsx)(f.Z,{children:(0,a.jsxs)(i.ZP,{container:!0,spacing:3,alignItems:"end",children:[(0,a.jsx)(i.ZP,{item:!0,xs:12,md:10,children:(0,a.jsxs)(v.Z,{direction:"row",spacing:2,alignItems:"end",children:[(0,a.jsxs)(d.Z,{variant:"outlined",component:"label",startIcon:(0,a.jsx)(T.Z,{icon:"tabler:paperclip"}),children:[String(t("commands.attachments.form.attachFile")),(0,a.jsx)("input",{hidden:!0,type:"file",onChange:e=>{var t;return el(r,(null===(t=e.target.files)||void 0===t?void 0:t[0])||null)}})]}),(0,a.jsx)("span",{style:{color:"rgba(0,0,0,0.6)"},children:e.file?e.file.name:String(t("commands.attachments.form.noFileSelected"))})]})}),(0,a.jsx)(i.ZP,{item:!0,xs:12,md:2,sx:{textAlign:"right"},children:(0,a.jsx)(M.Z,{"aria-label":"remove",color:"error",onClick:()=>ed(r),children:(0,a.jsx)(T.Z,{icon:"tabler:trash"})})})]})})},r)),(0,a.jsxs)(v.Z,{direction:"row",spacing:2,children:[(0,a.jsx)(d.Z,{variant:"contained",color:"primary",onClick:()=>$(e=>[...e,{file:null}]),children:String(t("commands.attachments.addRow"))}),(0,a.jsx)(d.Z,{variant:"outlined",color:"success",onClick:ec,disabled:J,children:J?String(t("common.loading")):String(t("commands.attachments.upload"))})]})]})]})]})})]})}):null]})}),(0,a.jsx)(N.Z,{sx:{justifyContent:"flex-end"},children:(0,a.jsxs)(v.Z,{direction:"row",spacing:2,sx:{p:2},children:[(0,a.jsx)(d.Z,{type:"button",variant:"tonal",color:"secondary",onClick:()=>e.push("/commands"),disabled:L,children:String(t("common.cancel"))}),(0,a.jsx)(d.Z,{type:"submit",disabled:L,children:L?String(t("common.saving")):String(t("common.save"))})]})})]})]})}},73138:function(e,t,r){r.d(t,{Z:function(){return i}});var a=r(85893),n=r(5152);let o=r.n(n)()(()=>r.e(6925).then(r.t.bind(r,35108,23)).then(e=>e.Editor),{loadableGenerated:{webpack:()=>[35108]},ssr:!1});var i=e=>(0,a.jsx)(o,{editorState:e.editorState,onEditorStateChange:t=>e.onEditorStateChange(t)})}}]);